<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1512" id="srcline1512">1512</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1513" id="srcline1513">1513</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,1514" id="srcline1514">1514</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1515" id="srcline1515">1515</a></span><span class="line"><span class="comment">%%%         Rectosigmoidoscpy                         %%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1516" id="srcline1516">1516</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1517" id="srcline1517">1517</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1518" id="srcline1518">1518</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1519" id="srcline1519">1519</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S177T46U8727">Polyp</span>, <span class="var type1" id="S178T1U8728">PolypFlag</span>, <span class="var type1" id="S179T1U8729">AdvPolypFlag</span>, <span class="var type1" id="S180T1U8730">CancerFlag</span>, <span class="var type1" id="S181T10U8731">PaymentType</span>, <span class="var type1" id="S182T15U8732">Money</span>, <span class="var type1" id="S183T44U8733">Included</span>, <span class="var type1" id="S184T2U8734">DeathCause</span>, <span class="var type1" id="S185T2U8735">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1520" id="srcline1520">1520</a></span><span class="line">    = RectoSigmo(<span class="var type1" id="S186T1U8738">z</span>, <span class="var type1" id="S187T1U8739">y</span>, <span class="var type1" id="S177T46U8740">Polyp</span>, <span class="var type1" id="S188T48U8741">Ca</span>, <span class="var type1" id="S183T44U8742">Included</span>, <span class="var type1" id="S184T2U8743">DeathCause</span>, <span class="var type1" id="S185T2U8744">DeathYear</span>, <span class="var type1" id="S181T10U8745">PaymentType</span>, <span class="var type1" id="S182T15U8746">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1521" id="srcline1521">1521</a></span><span class="line">    <span class="var type1" id="S189T19U8747">StageVariables</span>, <span class="var type1" id="S190T23U8748">Cost</span>, <span class="var type1" id="S191T21U8749">Location</span>, <span class="var type1" id="S192T26U8750">risc</span>, <span class="var type1" id="S193T62U8751">RectoSigmoReachMatrix</span>, <span class="var type1" id="S194T27U8752">flag</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,1522" id="srcline1522">1522</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1523" id="srcline1523">1523</a></span><span class="line"><span class="comment">% in this function we do a rectosigmoidoscopy for the respective patient (number</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1524" id="srcline1524">1524</a></span><span class="line"><span class="comment">% z). We just note whether a polyp or a cancer was found and pass the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1525" id="srcline1525">1525</a></span><span class="line"><span class="comment">% information back to the calling function</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1526" id="srcline1526">1526</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1527" id="srcline1527">1527</a></span><span class="line"><span class="comment">% we determine the reach of this rectosigmoidoscopy (cecum = 1, rectum = 13))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1528" id="srcline1528">1528</a></span><span class="line"><span class="mxinfo " id="T1:U25"><span class="var type1" id="S195T1U8755">CurrentReach</span> = <span class="mxinfo " id="T1:U27"><span class="var type1" id="S193T62U8757">RectoSigmoReachMatrix</span>(<span class="mxinfo " id="T1:U29">round(<span class="mxinfo " id="T1:U30"><span class="mxinfo " id="T1:U31"><span class="mxinfo " id="T1:U32">rand</span>*<span class="mxinfo " id="T1:U33">999</span></span>+<span class="mxinfo " id="T1:U34">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1529" id="srcline1529">1529</a></span><span class="line"><span class="mxinfo " id="T22:U35"><span class="var type1" id="S198T22U8768">CurrentReachMatrix</span> = <span class="mxinfo " id="T22:U37">zeros(<span class="mxinfo " id="T1:U38">1</span>, <span class="mxinfo " id="T1:U39">13</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1530" id="srcline1530">1530</a></span><span class="line"><span class="mxinfo " id="T65:U40"><span class="mxinfo " id="T65:U41"><span class="var type1" id="S198T22U8776">CurrentReachMatrix</span>(<span class="mxinfo " id="T66:U43"><span class="var type1" id="S195T1U8778">CurrentReach</span>:<span class="mxinfo " id="T1:U45">13</span></span>)</span> = <span class="mxinfo " id="T1:U46">1</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,1531" id="srcline1531">1531</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1532" id="srcline1532">1532</a></span><span class="line"><span class="mxinfo " id="T1:U47"><span class="var type1" id="S200T1U8783">counter</span>  = <span class="mxinfo " id="T1:U49">0</span></span>; <span class="mxinfo " id="T1:U50"><span class="var type1" id="S178T1U8787">PolypFlag</span> = <span class="mxinfo " id="T1:U52">0</span></span>; <span class="mxinfo " id="T1:U53"><span class="var type1" id="S179T1U8791">AdvPolypFlag</span> = <span class="mxinfo " id="T1:U55">0</span></span>; <span class="mxinfo " id="T1:U56"><span class="var type1" id="S180T1U8795">CancerFlag</span> = <span class="mxinfo " id="T1:U58">0</span></span>; <span class="comment">%m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1533" id="srcline1533">1533</a></span><span class="line"><span class="mxinfo " id="T1:U59"><span class="var type1" id="S201T1U8799">PolypMax</span> = <span class="mxinfo " id="T1:U61">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1534" id="srcline1534">1534</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1535" id="srcline1535">1535</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T28:U62"><span class="var type1" id="S194T27U8804">flag</span>.Schoen</span> <span class="comment">% schoen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1536" id="srcline1536">1536</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S202T1U8808">f</span>=<span class="mxinfo " id="T1:U65">length(<span class="mxinfo " id="T96:U66">find(<span class="mxinfo " id="T85:U67"><span class="mxinfo " id="T45:U68"><span class="var type1" id="S177T46U8817">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U8819">z</span>, <span class="mxinfo " id="T86:U71">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U72">-1</span> : <span class="mxinfo " id="T1:U73">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1537" id="srcline1537">1537</a></span><span class="line">            <span class="mxinfo " id="T1:U74"><span class="var type1" id="S205T1U8826">Tumor</span> = <span class="mxinfo " id="T1:U76"><span class="mxinfo " id="T45:U77"><span class="var type1" id="S177T46U8829">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U8831">z</span>, <span class="var type1" id="S202T1U8832">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1538" id="srcline1538">1538</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U81">and(<span class="mxinfo " id="T28:U82"><span class="mxinfo " id="T1:U83">rand</span> &lt; <span class="mxinfo " id="T1:U84"><span class="mxinfo " id="T1:U85"><span class="mxinfo " id="T20:U86"><span class="var type1" id="S189T19U8843">StageVariables</span>.RectoSigmo_Detection</span>(<span class="var type1" id="S205T1U8845">Tumor</span>)</span> *<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of polyp stage</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1539" id="srcline1539">1539</a></span><span class="line">                    <span class="mxinfo " id="T1:U89"><span class="mxinfo " id="T22:U90"><span class="var type1" id="S191T21U8848">Location</span>.RectoSigmoDetection</span>(<span class="mxinfo " id="T1:U92"><span class="mxinfo " id="T45:U93"><span class="var type1" id="S177T46U8852">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U8854">z</span>, <span class="var type1" id="S202T1U8855">f</span>)</span>)</span></span></span>,<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of location on detection</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1540" id="srcline1540">1540</a></span><span class="line">                    <span class="mxinfo " id="T28:U97"><span class="mxinfo " id="T1:U98"><span class="var type1" id="S198T22U8858">CurrentReachMatrix</span>(<span class="mxinfo " id="T1:U100"><span class="mxinfo " id="T45:U101"><span class="var type1" id="S177T46U8861">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U8863">z</span>, <span class="var type1" id="S202T1U8864">f</span>)</span>)</span> == <span class="mxinfo " id="T1:U105">1</span></span>)</span>      <span class="comment">% has current current colonoscopy reached location of polyp?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1541" id="srcline1541">1541</a></span><span class="line">                <span class="comment">% we record the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1542" id="srcline1542">1542</a></span><span class="line">                <span class="comment">% in this scenario we only do follow up for larger polyps</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1543" id="srcline1543">1543</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U106"><span class="var type1" id="S205T1U8869">Tumor</span> &gt;<span class="mxinfo " id="T1:U108">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1544" id="srcline1544">1544</a></span><span class="line">                    <span class="mxinfo " id="T1:U109"><span class="var type1" id="S178T1U8873">PolypFlag</span> = <span class="mxinfo " id="T1:U111">1.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1545" id="srcline1545">1545</a></span><span class="line">                <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U112">isequal(<span class="var type1" id="S178T1U8878">PolypFlag</span>, <span class="mxinfo " id="T1:U114">1.5</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1546" id="srcline1546">1546</a></span><span class="line">                    <span class="mxinfo " id="T1:U115"><span class="var type1" id="S178T1U8882">PolypFlag</span> = <span class="mxinfo " id="T1:U117">1.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1547" id="srcline1547">1547</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1548" id="srcline1548">1548</a></span><span class="line">                    <span class="mxinfo " id="T1:U118"><span class="var type1" id="S178T1U8887">PolypFlag</span> = <span class="mxinfo " id="T1:U120">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1549" id="srcline1549">1549</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1550" id="srcline1550">1550</a></span><span class="line">                <span class="mxinfo " id="T1:U121"><span class="var type1" id="S200T1U8891">counter</span>  = <span class="mxinfo " id="T1:U123"><span class="var type1" id="S200T1U8893">counter</span> + <span class="mxinfo " id="T1:U125">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1551" id="srcline1551">1551</a></span><span class="line">                <span class="mxinfo " id="T1:U126"><span class="var type1" id="S201T1U8897">PolypMax</span> = <span class="mxinfo " id="T1:U128">max(<span class="var type1" id="S201T1U8900">PolypMax</span>, <span class="var type1" id="S205T1U8901">Tumor</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1552" id="srcline1552">1552</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1553" id="srcline1553">1553</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1554" id="srcline1554">1554</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T28:U131"><span class="var type1" id="S194T27U8904">flag</span>.Atkin</span> <span class="comment">% atkin</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1555" id="srcline1555">1555</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S202T1U8908">f</span>=<span class="mxinfo " id="T1:U134">length(<span class="mxinfo " id="T96:U135">find(<span class="mxinfo " id="T85:U136"><span class="mxinfo " id="T45:U137"><span class="var type1" id="S177T46U8917">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U8919">z</span>, <span class="mxinfo " id="T86:U140">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U141">-1</span> : <span class="mxinfo " id="T1:U142">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1556" id="srcline1556">1556</a></span><span class="line">            <span class="mxinfo " id="T1:U143"><span class="var type1" id="S205T1U8926">Tumor</span> = <span class="mxinfo " id="T1:U145"><span class="mxinfo " id="T45:U146"><span class="var type1" id="S177T46U8929">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U8931">z</span>, <span class="var type1" id="S202T1U8932">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1557" id="srcline1557">1557</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U150">and(<span class="mxinfo " id="T28:U151"><span class="mxinfo " id="T1:U152">rand</span> &lt; <span class="mxinfo " id="T1:U153"><span class="mxinfo " id="T1:U154"><span class="mxinfo " id="T20:U155"><span class="var type1" id="S189T19U8943">StageVariables</span>.RectoSigmo_Detection</span>(<span class="var type1" id="S205T1U8945">Tumor</span>)</span> *<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of polyp stage</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1558" id="srcline1558">1558</a></span><span class="line">                    <span class="mxinfo " id="T1:U158"><span class="mxinfo " id="T22:U159"><span class="var type1" id="S191T21U8948">Location</span>.RectoSigmoDetection</span>(<span class="mxinfo " id="T1:U161"><span class="mxinfo " id="T45:U162"><span class="var type1" id="S177T46U8952">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U8954">z</span>, <span class="var type1" id="S202T1U8955">f</span>)</span>)</span></span></span>,<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of location on detection</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1559" id="srcline1559">1559</a></span><span class="line">                    <span class="mxinfo " id="T28:U166"><span class="mxinfo " id="T1:U167"><span class="var type1" id="S198T22U8958">CurrentReachMatrix</span>(<span class="mxinfo " id="T1:U169"><span class="mxinfo " id="T45:U170"><span class="var type1" id="S177T46U8961">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U8963">z</span>, <span class="var type1" id="S202T1U8964">f</span>)</span>)</span> == <span class="mxinfo " id="T1:U174">1</span></span>)</span>      <span class="comment">% has current current colonoscopy reached location of polyp?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1560" id="srcline1560">1560</a></span><span class="line">                <span class="comment">% we record the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1561" id="srcline1561">1561</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U175"><span class="var type1" id="S205T1U8969">Tumor</span> &gt;<span class="mxinfo " id="T1:U177">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1562" id="srcline1562">1562</a></span><span class="line">                    <span class="mxinfo " id="T1:U178"><span class="var type1" id="S178T1U8973">PolypFlag</span> = <span class="mxinfo " id="T1:U180">1</span></span>;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,1563" id="srcline1563">1563</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1564" id="srcline1564">1564</a></span><span class="line">                <span class="mxinfo " id="T1:U181"><span class="var type1" id="S200T1U8977">counter</span> = <span class="mxinfo " id="T1:U183"><span class="var type1" id="S200T1U8979">counter</span> + <span class="mxinfo " id="T1:U185">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1565" id="srcline1565">1565</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1566" id="srcline1566">1566</a></span><span class="line">                <span class="comment">% we delete the current polyp only in the Atkins study. outside this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1567" id="srcline1567">1567</a></span><span class="line">                <span class="comment">% study we would remove the polyp during colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1568" id="srcline1568">1568</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U186"><span class="var type1" id="S205T1U8984">Tumor</span>&gt;<span class="mxinfo " id="T1:U188">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1569" id="srcline1569">1569</a></span><span class="line">                    <span class="mxinfo " id="T1:U189"><span class="var type1" id="S209T1U8988">l</span> = <span class="mxinfo " id="T96:U191">length(<span class="mxinfo " id="T96:U192">find(<span class="mxinfo " id="T85:U193"><span class="mxinfo " id="T45:U194"><span class="var type1" id="S177T46U8995">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U8997">z</span>, <span class="mxinfo " id="T86:U197">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1570" id="srcline1570">1570</a></span><span class="line">                    <span class="mxinfo " id="T96:U198"><span class="mxinfo " id="T96:U199"><span class="mxinfo " id="T45:U200"><span class="var type1" id="S177T46U9003">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9005">z</span>, <span class="mxinfo " id="T97:U203"><span class="var type1" id="S202T1U9007">f</span>:<span class="var type1" id="S209T1U9008">l</span></span>)</span>           = <span class="mxinfo " id="T96:U206"><span class="mxinfo " id="T45:U207"><span class="var type1" id="S177T46U9011">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9013">z</span>, <span class="mxinfo " id="T97:U210"><span class="mxinfo " id="T1:U211"><span class="var type1" id="S202T1U9016">f</span>+<span class="mxinfo " id="T1:U213">1</span></span>:<span class="mxinfo " id="T1:U214"><span class="var type1" id="S209T1U9019">l</span>+<span class="mxinfo " id="T1:U216">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1571" id="srcline1571">1571</a></span><span class="line">                    <span class="mxinfo " id="T96:U217"><span class="mxinfo " id="T96:U218"><span class="mxinfo " id="T45:U219"><span class="var type1" id="S177T46U9025">Polyp</span>.PolypYear</span>(<span class="var type1" id="S186T1U9027">z</span>, <span class="mxinfo " id="T97:U222"><span class="var type1" id="S202T1U9029">f</span>:<span class="var type1" id="S209T1U9030">l</span></span>)</span>        = <span class="mxinfo " id="T96:U225"><span class="mxinfo " id="T45:U226"><span class="var type1" id="S177T46U9033">Polyp</span>.PolypYear</span>(<span class="var type1" id="S186T1U9035">z</span>, <span class="mxinfo " id="T97:U229"><span class="mxinfo " id="T1:U230"><span class="var type1" id="S202T1U9038">f</span>+<span class="mxinfo " id="T1:U232">1</span></span>:<span class="mxinfo " id="T1:U233"><span class="var type1" id="S209T1U9041">l</span>+<span class="mxinfo " id="T1:U235">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1572" id="srcline1572">1572</a></span><span class="line">                    <span class="mxinfo " id="T96:U236"><span class="mxinfo " id="T96:U237"><span class="mxinfo " id="T45:U238"><span class="var type1" id="S177T46U9047">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9049">z</span>, <span class="mxinfo " id="T97:U241"><span class="var type1" id="S202T1U9051">f</span>:<span class="var type1" id="S209T1U9052">l</span></span>)</span>    = <span class="mxinfo " id="T96:U244"><span class="mxinfo " id="T45:U245"><span class="var type1" id="S177T46U9055">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9057">z</span>, <span class="mxinfo " id="T97:U248"><span class="mxinfo " id="T1:U249"><span class="var type1" id="S202T1U9060">f</span>+<span class="mxinfo " id="T1:U251">1</span></span>:<span class="mxinfo " id="T1:U252"><span class="var type1" id="S209T1U9063">l</span>+<span class="mxinfo " id="T1:U254">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1573" id="srcline1573">1573</a></span><span class="line">                    <span class="mxinfo " id="T96:U255"><span class="mxinfo " id="T96:U256"><span class="mxinfo " id="T45:U257"><span class="var type1" id="S177T46U9069">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S186T1U9071">z</span>, <span class="mxinfo " id="T97:U260"><span class="var type1" id="S202T1U9073">f</span>:<span class="var type1" id="S209T1U9074">l</span></span>)</span> = <span class="mxinfo " id="T96:U263"><span class="mxinfo " id="T45:U264"><span class="var type1" id="S177T46U9077">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S186T1U9079">z</span>, <span class="mxinfo " id="T97:U267"><span class="mxinfo " id="T1:U268"><span class="var type1" id="S202T1U9082">f</span>+<span class="mxinfo " id="T1:U270">1</span></span>:<span class="mxinfo " id="T1:U271"><span class="var type1" id="S209T1U9085">l</span>+<span class="mxinfo " id="T1:U273">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1574" id="srcline1574">1574</a></span><span class="line">                    <span class="mxinfo " id="T96:U274"><span class="mxinfo " id="T96:U275"><span class="mxinfo " id="T45:U276"><span class="var type1" id="S177T46U9091">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S186T1U9093">z</span>, <span class="mxinfo " id="T97:U279"><span class="var type1" id="S202T1U9095">f</span>:<span class="var type1" id="S209T1U9096">l</span></span>)</span>   = <span class="mxinfo " id="T96:U282"><span class="mxinfo " id="T45:U283"><span class="var type1" id="S177T46U9099">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S186T1U9101">z</span>, <span class="mxinfo " id="T97:U286"><span class="mxinfo " id="T1:U287"><span class="var type1" id="S202T1U9104">f</span>+<span class="mxinfo " id="T1:U289">1</span></span>:<span class="mxinfo " id="T1:U290"><span class="var type1" id="S209T1U9107">l</span>+<span class="mxinfo " id="T1:U292">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1575" id="srcline1575">1575</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1576" id="srcline1576">1576</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1577" id="srcline1577">1577</a></span><span class="line">                <span class="mxinfo " id="T1:U293"><span class="var type1" id="S201T1U9111">PolypMax</span> = <span class="mxinfo " id="T1:U295">max(<span class="var type1" id="S201T1U9114">PolypMax</span>, <span class="var type1" id="S205T1U9115">Tumor</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1578" id="srcline1578">1578</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1579" id="srcline1579">1579</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1580" id="srcline1580">1580</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1581" id="srcline1581">1581</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T28:U298"><span class="var type1" id="S194T27U9118">flag</span>.Segnan</span> <span class="comment">% italian/ Segnan study</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1582" id="srcline1582">1582</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S202T1U9122">f</span>=<span class="mxinfo " id="T1:U301">length(<span class="mxinfo " id="T96:U302">find(<span class="mxinfo " id="T85:U303"><span class="mxinfo " id="T45:U304"><span class="var type1" id="S177T46U9131">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9133">z</span>, <span class="mxinfo " id="T86:U307">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U308">-1</span> : <span class="mxinfo " id="T1:U309">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1583" id="srcline1583">1583</a></span><span class="line">            <span class="mxinfo " id="T1:U310"><span class="var type1" id="S205T1U9140">Tumor</span> = <span class="mxinfo " id="T1:U312"><span class="mxinfo " id="T45:U313"><span class="var type1" id="S177T46U9143">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9145">z</span>, <span class="var type1" id="S202T1U9146">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1584" id="srcline1584">1584</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U317">and(<span class="mxinfo " id="T28:U318"><span class="mxinfo " id="T1:U319">rand</span> &lt; <span class="mxinfo " id="T1:U320"><span class="mxinfo " id="T1:U321"><span class="mxinfo " id="T20:U322"><span class="var type1" id="S189T19U9157">StageVariables</span>.RectoSigmo_Detection</span>(<span class="var type1" id="S205T1U9159">Tumor</span>)</span> *<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of polyp stage</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1585" id="srcline1585">1585</a></span><span class="line">                    <span class="mxinfo " id="T1:U325"><span class="mxinfo " id="T22:U326"><span class="var type1" id="S191T21U9162">Location</span>.RectoSigmoDetection</span>(<span class="mxinfo " id="T1:U328"><span class="mxinfo " id="T45:U329"><span class="var type1" id="S177T46U9166">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9168">z</span>, <span class="var type1" id="S202T1U9169">f</span>)</span>)</span></span></span>,<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of location on detection</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1586" id="srcline1586">1586</a></span><span class="line">                    <span class="mxinfo " id="T28:U333"><span class="mxinfo " id="T1:U334"><span class="var type1" id="S198T22U9172">CurrentReachMatrix</span>(<span class="mxinfo " id="T1:U336"><span class="mxinfo " id="T45:U337"><span class="var type1" id="S177T46U9175">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9177">z</span>, <span class="var type1" id="S202T1U9178">f</span>)</span>)</span> == <span class="mxinfo " id="T1:U341">1</span></span>)</span>      <span class="comment">% has current current colonoscopy reached location of polyp?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1587" id="srcline1587">1587</a></span><span class="line">                <span class="comment">% we record the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1588" id="srcline1588">1588</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U342"><span class="var type1" id="S205T1U9183">Tumor</span> &gt;<span class="mxinfo " id="T1:U344">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1589" id="srcline1589">1589</a></span><span class="line">                    <span class="mxinfo " id="T1:U345"><span class="var type1" id="S178T1U9187">PolypFlag</span> = <span class="mxinfo " id="T1:U347">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1590" id="srcline1590">1590</a></span><span class="line">                    <span class="mxinfo " id="T1:U348"><span class="var type1" id="S201T1U9191">PolypMax</span> = <span class="mxinfo " id="T1:U350">max(<span class="var type1" id="S201T1U9194">PolypMax</span>, <span class="var type1" id="S205T1U9195">Tumor</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1591" id="srcline1591">1591</a></span><span class="line">                    <span class="mxinfo " id="T1:U353"><span class="var type1" id="S200T1U9198">counter</span> = <span class="mxinfo " id="T1:U355"><span class="var type1" id="S200T1U9200">counter</span> + <span class="mxinfo " id="T1:U357">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1592" id="srcline1592">1592</a></span><span class="line">                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1593" id="srcline1593">1593</a></span><span class="line">                    <span class="comment">% in this study we only delete small polyps; larger polyps are referred to colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1594" id="srcline1594">1594</a></span><span class="line">                    <span class="mxinfo " id="T1:U358"><span class="var type1" id="S209T1U9205">l</span> = <span class="mxinfo " id="T96:U360">length(<span class="mxinfo " id="T96:U361">find(<span class="mxinfo " id="T85:U362"><span class="mxinfo " id="T45:U363"><span class="var type1" id="S177T46U9212">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9214">z</span>, <span class="mxinfo " id="T86:U366">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1595" id="srcline1595">1595</a></span><span class="line">                    <span class="mxinfo " id="T96:U367"><span class="mxinfo " id="T96:U368"><span class="mxinfo " id="T45:U369"><span class="var type1" id="S177T46U9220">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9222">z</span>, <span class="mxinfo " id="T97:U372"><span class="var type1" id="S202T1U9224">f</span>:<span class="var type1" id="S209T1U9225">l</span></span>)</span>           = <span class="mxinfo " id="T96:U375"><span class="mxinfo " id="T45:U376"><span class="var type1" id="S177T46U9228">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9230">z</span>, <span class="mxinfo " id="T97:U379"><span class="mxinfo " id="T1:U380"><span class="var type1" id="S202T1U9233">f</span>+<span class="mxinfo " id="T1:U382">1</span></span>:<span class="mxinfo " id="T1:U383"><span class="var type1" id="S209T1U9236">l</span>+<span class="mxinfo " id="T1:U385">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1596" id="srcline1596">1596</a></span><span class="line">                    <span class="mxinfo " id="T96:U386"><span class="mxinfo " id="T96:U387"><span class="mxinfo " id="T45:U388"><span class="var type1" id="S177T46U9242">Polyp</span>.PolypYear</span>(<span class="var type1" id="S186T1U9244">z</span>, <span class="mxinfo " id="T97:U391"><span class="var type1" id="S202T1U9246">f</span>:<span class="var type1" id="S209T1U9247">l</span></span>)</span>        = <span class="mxinfo " id="T96:U394"><span class="mxinfo " id="T45:U395"><span class="var type1" id="S177T46U9250">Polyp</span>.PolypYear</span>(<span class="var type1" id="S186T1U9252">z</span>, <span class="mxinfo " id="T97:U398"><span class="mxinfo " id="T1:U399"><span class="var type1" id="S202T1U9255">f</span>+<span class="mxinfo " id="T1:U401">1</span></span>:<span class="mxinfo " id="T1:U402"><span class="var type1" id="S209T1U9258">l</span>+<span class="mxinfo " id="T1:U404">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1597" id="srcline1597">1597</a></span><span class="line">                    <span class="mxinfo " id="T96:U405"><span class="mxinfo " id="T96:U406"><span class="mxinfo " id="T45:U407"><span class="var type1" id="S177T46U9264">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9266">z</span>, <span class="mxinfo " id="T97:U410"><span class="var type1" id="S202T1U9268">f</span>:<span class="var type1" id="S209T1U9269">l</span></span>)</span>    = <span class="mxinfo " id="T96:U413"><span class="mxinfo " id="T45:U414"><span class="var type1" id="S177T46U9272">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9274">z</span>, <span class="mxinfo " id="T97:U417"><span class="mxinfo " id="T1:U418"><span class="var type1" id="S202T1U9277">f</span>+<span class="mxinfo " id="T1:U420">1</span></span>:<span class="mxinfo " id="T1:U421"><span class="var type1" id="S209T1U9280">l</span>+<span class="mxinfo " id="T1:U423">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1598" id="srcline1598">1598</a></span><span class="line">                    <span class="mxinfo " id="T96:U424"><span class="mxinfo " id="T96:U425"><span class="mxinfo " id="T45:U426"><span class="var type1" id="S177T46U9286">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S186T1U9288">z</span>, <span class="mxinfo " id="T97:U429"><span class="var type1" id="S202T1U9290">f</span>:<span class="var type1" id="S209T1U9291">l</span></span>)</span> = <span class="mxinfo " id="T96:U432"><span class="mxinfo " id="T45:U433"><span class="var type1" id="S177T46U9294">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S186T1U9296">z</span>, <span class="mxinfo " id="T97:U436"><span class="mxinfo " id="T1:U437"><span class="var type1" id="S202T1U9299">f</span>+<span class="mxinfo " id="T1:U439">1</span></span>:<span class="mxinfo " id="T1:U440"><span class="var type1" id="S209T1U9302">l</span>+<span class="mxinfo " id="T1:U442">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1599" id="srcline1599">1599</a></span><span class="line">                    <span class="mxinfo " id="T96:U443"><span class="mxinfo " id="T96:U444"><span class="mxinfo " id="T45:U445"><span class="var type1" id="S177T46U9308">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S186T1U9310">z</span>, <span class="mxinfo " id="T97:U448"><span class="var type1" id="S202T1U9312">f</span>:<span class="var type1" id="S209T1U9313">l</span></span>)</span>   = <span class="mxinfo " id="T96:U451"><span class="mxinfo " id="T45:U452"><span class="var type1" id="S177T46U9316">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S186T1U9318">z</span>, <span class="mxinfo " id="T97:U455"><span class="mxinfo " id="T1:U456"><span class="var type1" id="S202T1U9321">f</span>+<span class="mxinfo " id="T1:U458">1</span></span>:<span class="mxinfo " id="T1:U459"><span class="var type1" id="S209T1U9324">l</span>+<span class="mxinfo " id="T1:U461">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1600" id="srcline1600">1600</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1601" id="srcline1601">1601</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1602" id="srcline1602">1602</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1603" id="srcline1603">1603</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1604" id="srcline1604">1604</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S202T1U9329">f</span>=<span class="mxinfo " id="T1:U463">length(<span class="mxinfo " id="T96:U464">find(<span class="mxinfo " id="T85:U465"><span class="mxinfo " id="T45:U466"><span class="var type1" id="S177T46U9338">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9340">z</span>, <span class="mxinfo " id="T86:U469">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U470">-1</span> : <span class="mxinfo " id="T1:U471">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1605" id="srcline1605">1605</a></span><span class="line">            <span class="mxinfo " id="T1:U472"><span class="var type1" id="S205T1U9347">Tumor</span> = <span class="mxinfo " id="T1:U474"><span class="mxinfo " id="T45:U475"><span class="var type1" id="S177T46U9350">Polyp</span>.Polyps</span>(<span class="var type1" id="S186T1U9352">z</span>, <span class="var type1" id="S202T1U9353">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1606" id="srcline1606">1606</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U479">and(<span class="mxinfo " id="T28:U480"><span class="mxinfo " id="T1:U481">rand</span> &lt; <span class="mxinfo " id="T1:U482"><span class="mxinfo " id="T1:U483"><span class="mxinfo " id="T20:U484"><span class="var type1" id="S189T19U9364">StageVariables</span>.RectoSigmo_Detection</span>(<span class="var type1" id="S205T1U9366">Tumor</span>)</span> *<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of polyp stage</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1607" id="srcline1607">1607</a></span><span class="line">                    <span class="mxinfo " id="T1:U487"><span class="mxinfo " id="T22:U488"><span class="var type1" id="S191T21U9369">Location</span>.RectoSigmoDetection</span>(<span class="mxinfo " id="T1:U490"><span class="mxinfo " id="T45:U491"><span class="var type1" id="S177T46U9373">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9375">z</span>, <span class="var type1" id="S202T1U9376">f</span>)</span>)</span></span></span>,<span class="keyword">...</span><span class="comment">    <span class="comment">% influence of location on detection</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1608" id="srcline1608">1608</a></span><span class="line">                    <span class="mxinfo " id="T28:U495"><span class="mxinfo " id="T1:U496"><span class="var type1" id="S198T22U9379">CurrentReachMatrix</span>(<span class="mxinfo " id="T1:U498"><span class="mxinfo " id="T45:U499"><span class="var type1" id="S177T46U9382">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S186T1U9384">z</span>, <span class="var type1" id="S202T1U9385">f</span>)</span>)</span> == <span class="mxinfo " id="T1:U503">1</span></span>)</span>      <span class="comment">% has current current colonoscopy reached location of polyp?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1609" id="srcline1609">1609</a></span><span class="line">                <span class="comment">% we record the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1610" id="srcline1610">1610</a></span><span class="line">                <span class="mxinfo " id="T1:U504"><span class="var type1" id="S178T1U9389">PolypFlag</span> = <span class="mxinfo " id="T1:U506">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1611" id="srcline1611">1611</a></span><span class="line">                <span class="mxinfo " id="T1:U507"><span class="var type1" id="S200T1U9393">counter</span> = <span class="mxinfo " id="T1:U509"><span class="var type1" id="S200T1U9395">counter</span> + <span class="mxinfo " id="T1:U511">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1612" id="srcline1612">1612</a></span><span class="line">            <span class="mxinfo " id="T1:U512"><span class="var type1" id="S201T1U9399">PolypMax</span> = <span class="mxinfo " id="T1:U514">max(<span class="var type1" id="S201T1U9402">PolypMax</span>, <span class="var type1" id="S205T1U9403">Tumor</span>)</span></span>;       </span></span>
<span class="srcline"><span class="lineno"><a href="1,1613" id="srcline1613">1613</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1614" id="srcline1614">1614</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1615" id="srcline1615">1615</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1616" id="srcline1616">1616</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1617" id="srcline1617">1617</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T28:U517">or(<span class="mxinfo " id="T28:U518"><span class="var type1" id="S201T1U9409">PolypMax</span>&gt;<span class="mxinfo " id="T1:U520">4</span></span>, <span class="mxinfo " id="T28:U521"><span class="var type1" id="S200T1U9412">counter</span>&gt;<span class="mxinfo " id="T1:U523">2</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1618" id="srcline1618">1618</a></span><span class="line">    <span class="mxinfo " id="T1:U524"><span class="var type1" id="S179T1U9416">AdvPolypFlag</span> = <span class="mxinfo " id="T1:U526">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1619" id="srcline1619">1619</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1620" id="srcline1620">1620</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1621" id="srcline1621">1621</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S202T1U9420">f</span>=<span class="mxinfo " id="T1:U528">length(<span class="mxinfo " id="T87:U529">find(<span class="mxinfo " id="T73:U530"><span class="mxinfo " id="T47:U531"><span class="var type1" id="S188T48U9429">Ca</span>.Cancer</span>(<span class="var type1" id="S186T1U9431">z</span>, <span class="mxinfo " id="T76:U534">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U535">-1</span> : <span class="mxinfo " id="T1:U536">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1622" id="srcline1622">1622</a></span><span class="line">    <span class="mxinfo " id="T1:U537"><span class="var type1" id="S205T1U9438">Tumor</span> = <span class="mxinfo " id="T1:U539"><span class="mxinfo " id="T47:U540"><span class="var type1" id="S188T48U9441">Ca</span>.Cancer</span>(<span class="var type1" id="S186T1U9443">z</span>, <span class="var type1" id="S202T1U9444">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1623" id="srcline1623">1623</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T28:U544">and(<span class="mxinfo " id="T28:U545"><span class="mxinfo " id="T1:U546">rand</span> &lt; <span class="mxinfo " id="T1:U547"><span class="mxinfo " id="T20:U548"><span class="var type1" id="S189T19U9454">StageVariables</span>.RectoSigmo_Detection</span>(<span class="var type1" id="S205T1U9456">Tumor</span>)</span></span>,<span class="keyword">...</span><span class="comment">           <span class="comment">% influence of cancer stage on detection</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1624" id="srcline1624">1624</a></span><span class="line">            <span class="mxinfo " id="T28:U551"><span class="mxinfo " id="T1:U552"><span class="var type1" id="S198T22U9459">CurrentReachMatrix</span>(<span class="mxinfo " id="T1:U554"><span class="mxinfo " id="T47:U555"><span class="var type1" id="S188T48U9462">Ca</span>.CancerLocation</span>(<span class="var type1" id="S186T1U9464">z</span>, <span class="var type1" id="S202T1U9465">f</span>)</span>)</span> == <span class="mxinfo " id="T1:U559">1</span></span>)</span>        <span class="comment">% has current current colonoscopy reached location of polyp?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1625" id="srcline1625">1625</a></span><span class="line">        <span class="mxinfo " id="T1:U560"><span class="var type1" id="S200T1U9469">counter</span> = <span class="mxinfo " id="T1:U562"><span class="var type1" id="S200T1U9471">counter</span> + <span class="mxinfo " id="T1:U564">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1626" id="srcline1626">1626</a></span><span class="line">        <span class="mxinfo " id="T1:U565"><span class="var type1" id="S180T1U9475">CancerFlag</span> = <span class="mxinfo " id="T1:U567">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1627" id="srcline1627">1627</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1628" id="srcline1628">1628</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1629" id="srcline1629">1629</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1630" id="srcline1630">1630</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T28:U568">isequal(<span class="var type1" id="S200T1U9481">counter</span>, <span class="mxinfo " id="T1:U570">0</span>)</span> <span class="comment">% in this case no tumor or polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1631" id="srcline1631">1631</a></span><span class="line">    <span class="mxinfo " id="T1:U571"><span class="mxinfo " id="T1:U572"><span class="mxinfo " id="T16:U573"><span class="var type1" id="S182T15U9487">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9489">y</span>)</span> = <span class="mxinfo " id="T1:U576"><span class="mxinfo " id="T1:U577"><span class="mxinfo " id="T16:U578"><span class="var type1" id="S182T15U9493">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9495">y</span>)</span> + <span class="mxinfo " id="T1:U581"><span class="var type1" id="S190T23U9497">Cost</span>.Sigmoidoscopy</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1632" id="srcline1632">1632</a></span><span class="line">    <span class="mxinfo " id="T1:U583"><span class="mxinfo " id="T1:U584"><span class="mxinfo " id="T5:U585"><span class="var type1" id="S181T10U9503">PaymentType</span>.RS</span>(<span class="mxinfo " id="T1:U587">1</span>,<span class="var type1" id="S187T1U9506">y</span>)</span>= <span class="mxinfo " id="T1:U589"><span class="mxinfo " id="T1:U590"><span class="mxinfo " id="T5:U591"><span class="var type1" id="S181T10U9510">PaymentType</span>.RS</span>(<span class="mxinfo " id="T1:U593">1</span>,<span class="var type1" id="S187T1U9513">y</span>)</span>+<span class="mxinfo " id="T1:U595">1</span></span></span>;  <span class="comment">%m2 assumption. RS is only done for screening. not for followup or treatment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1633" id="srcline1633">1633</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1634" id="srcline1634">1634</a></span><span class="line">    <span class="mxinfo " id="T1:U596"><span class="mxinfo " id="T1:U597"><span class="mxinfo " id="T16:U598"><span class="var type1" id="S182T15U9520">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9522">y</span>)</span> = <span class="mxinfo " id="T1:U601"><span class="mxinfo " id="T1:U602"><span class="mxinfo " id="T16:U603"><span class="var type1" id="S182T15U9526">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9528">y</span>)</span> + <span class="mxinfo " id="T1:U606"><span class="var type1" id="S190T23U9530">Cost</span>.Sigmoidoscopy_Polyp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1635" id="srcline1635">1635</a></span><span class="line">    <span class="mxinfo " id="T1:U608"><span class="mxinfo " id="T1:U609"><span class="mxinfo " id="T5:U610"><span class="var type1" id="S181T10U9536">PaymentType</span>.RSPolyp</span>(<span class="mxinfo " id="T1:U612">1</span>,<span class="var type1" id="S187T1U9539">y</span>)</span>= <span class="mxinfo " id="T1:U614"><span class="mxinfo " id="T1:U615"><span class="mxinfo " id="T5:U616"><span class="var type1" id="S181T10U9543">PaymentType</span>.RSPolyp</span>(<span class="mxinfo " id="T1:U618">1</span>,<span class="var type1" id="S187T1U9546">y</span>)</span>+<span class="mxinfo " id="T1:U620">1</span></span></span>; <span class="comment">%m2 assumption. RS is only done for screening. not for followup or treatment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1636" id="srcline1636">1636</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1637" id="srcline1637">1637</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1638" id="srcline1638">1638</a></span><span class="line"><span class="comment">%%%% Complications</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1639" id="srcline1639">1639</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T28:U621"><span class="mxinfo " id="T1:U622">rand</span> &lt; <span class="mxinfo " id="T1:U623"><span class="var type1" id="S192T26U9554">risc</span>.Rectosigmo_Perforation</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1640" id="srcline1640">1640</a></span><span class="line">    <span class="comment">% a perforation happend</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1641" id="srcline1641">1641</a></span><span class="line">    <span class="mxinfo " id="T1:U625"><span class="mxinfo " id="T1:U626"><span class="mxinfo " id="T16:U627"><span class="var type1" id="S182T15U9560">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9562">y</span>)</span> = <span class="mxinfo " id="T1:U630"><span class="mxinfo " id="T1:U631"><span class="mxinfo " id="T16:U632"><span class="var type1" id="S182T15U9566">Money</span>.Screening</span>(<span class="var type1" id="S187T1U9568">y</span>)</span> + <span class="mxinfo " id="T1:U635"><span class="var type1" id="S190T23U9570">Cost</span>.Colonoscopy_Perforation</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1642" id="srcline1642">1642</a></span><span class="line">    <span class="mxinfo " id="T1:U637"><span class="mxinfo " id="T1:U638"><span class="mxinfo " id="T11:U639"><span class="var type1" id="S181T10U9576">PaymentType</span>.Perforation</span>(<span class="mxinfo " id="T1:U641">1</span>,<span class="var type1" id="S187T1U9579">y</span>)</span>= <span class="mxinfo " id="T1:U643"><span class="mxinfo " id="T1:U644"><span class="mxinfo " id="T11:U645"><span class="var type1" id="S181T10U9583">PaymentType</span>.Perforation</span>(<span class="mxinfo " id="T1:U647">1</span>,<span class="var type1" id="S187T1U9586">y</span>)</span> + <span class="mxinfo " id="T1:U649">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1643" id="srcline1643">1643</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T28:U650"><span class="mxinfo " id="T1:U651">rand</span> &lt; <span class="mxinfo " id="T1:U652"><span class="var type1" id="S192T26U9594">risc</span>.DeathPerforation</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1644" id="srcline1644">1644</a></span><span class="line">        <span class="comment">% patient died during colonoscopy from a perforation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1645" id="srcline1645">1645</a></span><span class="line">        <span class="mxinfo " id="T28:U654"><span class="mxinfo " id="T28:U655"><span class="var type1" id="S183T44U9599">Included</span>(<span class="var type1" id="S186T1U9600">z</span>)</span>  = <span class="mxinfo " id="T28:U658">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1646" id="srcline1646">1646</a></span><span class="line">        <span class="mxinfo " id="T1:U659"><span class="mxinfo " id="T1:U660"><span class="var type1" id="S184T2U9606">DeathCause</span>(<span class="var type1" id="S186T1U9607">z</span>)</span>= <span class="mxinfo " id="T1:U663">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1647" id="srcline1647">1647</a></span><span class="line">        <span class="mxinfo " id="T1:U664"><span class="mxinfo " id="T1:U665"><span class="var type1" id="S185T2U9612">DeathYear</span>(<span class="var type1" id="S186T1U9613">z</span>)</span> = <span class="var type1" id="S187T1U9614">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1648" id="srcline1648">1648</a></span><span class="line">        <span class="comment">% we set these flags to zero to prevent colonoscopy on a deceased</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1649" id="srcline1649">1649</a></span><span class="line">        <span class="comment">% patienta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1650" id="srcline1650">1650</a></span><span class="line">        <span class="mxinfo " id="T1:U669"><span class="var type1" id="S180T1U9617">CancerFlag</span> = <span class="mxinfo " id="T1:U671">0</span></span>; <span class="mxinfo " id="T1:U672"><span class="var type1" id="S178T1U9621">PolypFlag</span> = <span class="mxinfo " id="T1:U674">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1651" id="srcline1651">1651</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1652" id="srcline1652">1652</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1653" id="srcline1653">1653</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1654" id="srcline1654">1654</a></span><span class="line"></span></span>
</pre>
