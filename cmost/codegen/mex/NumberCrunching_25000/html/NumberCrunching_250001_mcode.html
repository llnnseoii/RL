<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">   1</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">   2</a></span><span class="line"><span class="comment">%     </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">   3</a></span><span class="line"><span class="comment">%     CMOST: Colon Modeling with Open Source Tool</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">   4</a></span><span class="line"><span class="comment">%     created by Meher Prakash and Benjamin Misselwitz 2012 - 2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">   5</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">   6</a></span><span class="line"><span class="comment">%     This program is part of free software package CMOST for colo-rectal  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">   7</a></span><span class="line"><span class="comment">%     cancer simulations: You can redistribute it and/or modify </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">   8</a></span><span class="line"><span class="comment">%     it under the terms of the GNU General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">   9</a></span><span class="line"><span class="comment">%     the Free Software Foundation, either version 3 of the License, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">  10</a></span><span class="line"><span class="comment">%     (at your option) any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">  11</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">  12</a></span><span class="line"><span class="comment">%       </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">  13</a></span><span class="line"><span class="comment">%     This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">  14</a></span><span class="line"><span class="comment">%     but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">  15</a></span><span class="line"><span class="comment">%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">  16</a></span><span class="line"><span class="comment">%     GNU General Public License for more details.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">  17</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">  18</a></span><span class="line"><span class="comment">%     You should have received a copy of the GNU General Public License</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">  19</a></span><span class="line"><span class="comment">%     along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">  20</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">  21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">  22</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">y</span>, <span class="var type1" id="S3T2U4">Gender</span>, <span class="var type1" id="S4T2U5">DeathCause</span>, <span class="var type1" id="S5T3U6">Last</span>, <span class="var type1" id="S6T2U7">DeathYear</span>, <span class="var type1" id="S7T2U8">NaturalDeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">  23</a></span><span class="line">    <span class="var type1" id="S8T4U9">DirectCancer</span>, <span class="var type1" id="S9T5U10">DirectCancerR</span>, <span class="var type1" id="S10T5U11">DirectCancer2</span>, <span class="var type1" id="S11T5U12">DirectCancer2R</span>, <span class="var type1" id="S12T5U13">ProgressedCancer</span>, <span class="var type1" id="S13T5U14">ProgressedCancerR</span>, <span class="var type1" id="S14T6U15">TumorRecord</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">  24</a></span><span class="line">    <span class="var type1" id="S15T7U16">DwellTimeProgression</span>, <span class="var type1" id="S16T7U17">DwellTimeFastCancer</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">  25</a></span><span class="line">    <span class="var type1" id="S17T8U18">HasCancer</span>, <span class="var type1" id="S18T8U19">NumPolyps</span>, <span class="var type1" id="S19T8U20">MaxPolyps</span>, <span class="var type1" id="S20T9U21">AllPolyps</span>, <span class="var type1" id="S21T8U22">NumCancer</span>, <span class="var type1" id="S22T8U23">MaxCancer</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">  26</a></span><span class="line">    <span class="var type1" id="S23T10U24">PaymentType</span>, <span class="var type1" id="S24T15U25">Money</span>, <span class="var type1" id="S25T17U26">Number</span>, <span class="var type1" id="S26T5U27">EarlyPolypsRemoved</span>, <span class="var type1" id="S27T8U28">DiagnosedCancer</span>, <span class="var type1" id="S28T5U29">AdvancedPolypsRemoved</span>, <span class="var type1" id="S29T18U30">YearIncluded</span>, <span class="var type1" id="S30T18U31">YearAlive</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">  27</a></span><span class="line">    = NumberCrunching_25000(<span class="var type1" id="S31T1U34">p</span>, <span class="var type1" id="S32T19U35">StageVariables</span>, <span class="var type1" id="S33T21U36">Location</span>, <span class="var type1" id="S34T23U37">Cost</span>, <span class="var type1" id="S35T24U38">CostStage</span>, <span class="var type1" id="S36T26U39">risc</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">  28</a></span><span class="line">    <span class="var type1" id="S37T27U40">flag</span>, <span class="var type1" id="S38T29U41">SpecialText</span>, <span class="var type1" id="S39T30U42">female</span>, <span class="var type1" id="S40T31U43">Sensitivity</span>, <span class="var type1" id="S41T32U44">ScreeningTest</span>, <span class="var type1" id="S42T2U45">ScreeningPreference</span>, <span class="var type1" id="S43T33U46">AgeProgression</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">  29</a></span><span class="line">    <span class="var type1" id="S44T34U47">NewPolyp</span>, <span class="var type1" id="S45T34U48">ColonoscopyLikelyhood</span>, <span class="var type1" id="S46T2U49">IndividualRisk</span>, <span class="var type1" id="S47T35U50">RiskDistribution</span>, <span class="var type1" id="S3T2U51">Gender</span>, <span class="var type1" id="S48T37U52">LifeTable</span>, <span class="var type1" id="S49T38U53">MortalityMatrix</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">  30</a></span><span class="line">    <span class="var type1" id="S50T39U54">LocationMatrix</span>, <span class="var type1" id="S51T40U55">StageDuration</span>, <span class="var type1" id="S52T41U56">tx1</span>, <span class="var type1" id="S53T42U57">DirectCancerRate</span>, <span class="var type1" id="S54T1U58">DirectCancerSpeed</span>, <span class="var type1" id="S55T43U59">DwellSpeed</span>) <span class="comment">%#codegen </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">  31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">  32</a></span><span class="line">coder.extrinsic(<span class="string">'sprintf'</span>, <span class="string">'display'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">  33</a></span><span class="line"><span class="comment">% to do:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">  34</a></span><span class="line"><span class="comment">% write subfunction for adjustment of costs if patient died, to be included</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">  35</a></span><span class="line"><span class="comment">% for colonoscopy and rectosigmoidoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">  36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">  37</a></span><span class="line"><span class="comment">% INITIALIZE</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">  38</a></span><span class="line"><span class="mxinfo " id="T1:U56"><span class="var type1" id="S57T1U69">n</span> = <span class="mxinfo " id="T1:U58">25000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">  39</a></span><span class="line"><span class="mxinfo " id="T44:U59"><span class="var type1" id="S58T44U73">Included</span>         = <span class="mxinfo " id="T44:U61"><span class="mxinfo " id="T28:U62">true</span>(<span class="mxinfo " id="T1:U63">1</span>, <span class="mxinfo " id="T1:U64">25000</span>)</span></span>; <span class="comment">% initially all patients are included</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">  40</a></span><span class="line"><span class="mxinfo " id="T44:U65"><span class="var type1" id="S60T44U80">Alive</span>            = <span class="mxinfo " id="T44:U67"><span class="mxinfo " id="T28:U68">true</span>(<span class="mxinfo " id="T1:U69">1</span>, <span class="mxinfo " id="T1:U70">25000</span>)</span></span>; <span class="comment">% initially all patients are alive</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">  41</a></span><span class="line"><span class="mxinfo " id="T2:U71"><span class="var type1" id="S4T2U87">DeathCause</span>       = <span class="mxinfo " id="T2:U73">zeros(<span class="mxinfo " id="T1:U74">1</span>, <span class="mxinfo " id="T1:U75">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">  42</a></span><span class="line"><span class="mxinfo " id="T2:U76"><span class="var type1" id="S6T2U94">DeathYear</span>        = <span class="mxinfo " id="T2:U78">zeros(<span class="mxinfo " id="T1:U79">1</span>, <span class="mxinfo " id="T1:U80">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">  43</a></span><span class="line"><span class="mxinfo " id="T2:U81"><span class="var type1" id="S7T2U101">NaturalDeathYear</span> = <span class="mxinfo " id="T2:U83">zeros(<span class="mxinfo " id="T1:U84">1</span>, <span class="mxinfo " id="T1:U85">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">  44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">  45</a></span><span class="line"><span class="mxinfo " id="T4:U86"><span class="var type1" id="S8T4U108">DirectCancer</span>      = <span class="mxinfo " id="T4:U88">zeros(<span class="mxinfo " id="T1:U89">5</span>, <span class="mxinfo " id="T1:U90">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">  46</a></span><span class="line"><span class="mxinfo " id="T5:U91"><span class="var type1" id="S9T5U115">DirectCancerR</span>     = <span class="mxinfo " id="T5:U93">zeros(<span class="mxinfo " id="T1:U94">1</span>, <span class="mxinfo " id="T1:U95">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">  47</a></span><span class="line"><span class="mxinfo " id="T5:U96"><span class="var type1" id="S10T5U122">DirectCancer2</span>     = <span class="mxinfo " id="T5:U98">zeros(<span class="mxinfo " id="T1:U99">1</span>, <span class="mxinfo " id="T1:U100">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">  48</a></span><span class="line"><span class="mxinfo " id="T5:U101"><span class="var type1" id="S11T5U129">DirectCancer2R</span>    = <span class="mxinfo " id="T5:U103">zeros(<span class="mxinfo " id="T1:U104">1</span>, <span class="mxinfo " id="T1:U105">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">  49</a></span><span class="line"><span class="mxinfo " id="T5:U106"><span class="var type1" id="S12T5U136">ProgressedCancer</span>  = <span class="mxinfo " id="T5:U108">zeros(<span class="mxinfo " id="T1:U109">1</span>, <span class="mxinfo " id="T1:U110">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">  50</a></span><span class="line"><span class="mxinfo " id="T5:U111"><span class="var type1" id="S13T5U143">ProgressedCancerR</span> = <span class="mxinfo " id="T5:U113">zeros(<span class="mxinfo " id="T1:U114">1</span>, <span class="mxinfo " id="T1:U115">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">  51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">  52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">  53</a></span><span class="line"><span class="mxinfo " id="T7:U116"><span class="mxinfo " id="T7:U117"><span class="var type1" id="S14T6U151">TumorRecord</span>.Stage</span>         = <span class="mxinfo " id="T7:U119">zeros(<span class="mxinfo " id="T1:U120">100</span>, <span class="mxinfo " id="T1:U121">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">  54</a></span><span class="line"><span class="mxinfo " id="T7:U122"><span class="mxinfo " id="T7:U123"><span class="var type1" id="S14T6U164">TumorRecord</span>.Location</span>      = <span class="mxinfo " id="T7:U125">zeros(<span class="mxinfo " id="T1:U126">100</span>, <span class="mxinfo " id="T1:U127">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">  55</a></span><span class="line"><span class="mxinfo " id="T7:U128"><span class="mxinfo " id="T7:U129"><span class="var type1" id="S14T6U177">TumorRecord</span>.Sojourn</span>       = <span class="mxinfo " id="T7:U131">zeros(<span class="mxinfo " id="T1:U132">100</span>, <span class="mxinfo " id="T1:U133">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">  56</a></span><span class="line"><span class="mxinfo " id="T7:U134"><span class="mxinfo " id="T7:U135"><span class="var type1" id="S14T6U190">TumorRecord</span>.DwellTime</span>     = <span class="mxinfo " id="T7:U137">zeros(<span class="mxinfo " id="T1:U138">100</span>, <span class="mxinfo " id="T1:U139">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">  57</a></span><span class="line"><span class="mxinfo " id="T7:U140"><span class="mxinfo " id="T7:U141"><span class="var type1" id="S14T6U203">TumorRecord</span>.Gender</span>        = <span class="mxinfo " id="T7:U143">zeros(<span class="mxinfo " id="T1:U144">100</span>, <span class="mxinfo " id="T1:U145">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">  58</a></span><span class="line"><span class="mxinfo " id="T7:U146"><span class="mxinfo " id="T7:U147"><span class="var type1" id="S14T6U216">TumorRecord</span>.Detection</span>     = <span class="mxinfo " id="T7:U149">zeros(<span class="mxinfo " id="T1:U150">100</span>, <span class="mxinfo " id="T1:U151">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">  59</a></span><span class="line"><span class="mxinfo " id="T7:U152"><span class="mxinfo " id="T7:U153"><span class="var type1" id="S14T6U229">TumorRecord</span>.PatientNumber</span> = <span class="mxinfo " id="T7:U155">zeros(<span class="mxinfo " id="T1:U156">100</span>, <span class="mxinfo " id="T1:U157">round(25000/10)</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">  60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">  61</a></span><span class="line"><span class="comment">% these we won't summarize in the same variable since they are recorded</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">  62</a></span><span class="line"><span class="comment">% while the tumor progresses, the TumorRecord variable while detected.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">  63</a></span><span class="line"><span class="mxinfo " id="T7:U158"><span class="var type1" id="S15T7U241">DwellTimeProgression</span>   = <span class="mxinfo " id="T7:U160">zeros(<span class="mxinfo " id="T1:U161">100</span>, <span class="mxinfo " id="T1:U162">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">  64</a></span><span class="line"><span class="mxinfo " id="T7:U163"><span class="var type1" id="S16T7U252">DwellTimeFastCancer</span>    = <span class="mxinfo " id="T7:U165">zeros(<span class="mxinfo " id="T1:U166">100</span>, <span class="mxinfo " id="T1:U167">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">  65</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">  66</a></span><span class="line"><span class="mxinfo " id="T2:U168"><span class="mxinfo " id="T2:U169"><span class="var type1" id="S5T3U264">Last</span>.Colonoscopy</span>  = <span class="mxinfo " id="T2:U171">zeros(<span class="mxinfo " id="T1:U172">1</span>, <span class="mxinfo " id="T1:U173">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">  67</a></span><span class="line"><span class="mxinfo " id="T2:U174"><span class="mxinfo " id="T2:U175"><span class="var type1" id="S5T3U273">Last</span>.Polyp</span>        = <span class="mxinfo " id="T2:U177"><span class="mxinfo " id="T2:U178">ones(1, 25000)</span> *<span class="mxinfo " id="T1:U179">-100</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">  68</a></span><span class="line"><span class="mxinfo " id="T2:U180"><span class="mxinfo " id="T2:U181"><span class="var type1" id="S5T3U285">Last</span>.AdvPolyp</span>     = <span class="mxinfo " id="T2:U183"><span class="mxinfo " id="T2:U184">ones(1, 25000)</span> *<span class="mxinfo " id="T1:U185">-100</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">  69</a></span><span class="line"><span class="mxinfo " id="T2:U186"><span class="mxinfo " id="T2:U187"><span class="var type1" id="S5T3U297">Last</span>.Cancer</span>       = <span class="mxinfo " id="T2:U189"><span class="mxinfo " id="T2:U190">ones(1, 25000)</span> *<span class="mxinfo " id="T1:U191">-100</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">  70</a></span><span class="line"><span class="mxinfo " id="T2:U192"><span class="mxinfo " id="T2:U193"><span class="var type1" id="S5T3U309">Last</span>.ScreenTest</span>   = <span class="mxinfo " id="T2:U195">zeros(<span class="mxinfo " id="T1:U196">1</span>,<span class="mxinfo " id="T1:U197">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">  71</a></span><span class="line"><span class="mxinfo " id="T2:U198"><span class="mxinfo " id="T2:U199"><span class="var type1" id="S5T3U318">Last</span>.Included</span>     = <span class="mxinfo " id="T2:U201">zeros(<span class="mxinfo " id="T1:U202">1</span>,<span class="mxinfo " id="T1:U203">25000</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">  72</a></span><span class="line"><span class="mxinfo " id="T2:U204"><span class="mxinfo " id="T2:U205"><span class="var type1" id="S5T3U327">Last</span>.TestDone</span>     = <span class="mxinfo " id="T2:U207">zeros(<span class="mxinfo " id="T1:U208">1</span>,<span class="mxinfo " id="T1:U209">25000</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">  73</a></span><span class="line"><span class="mxinfo " id="T2:U210"><span class="mxinfo " id="T2:U211"><span class="var type1" id="S5T3U336">Last</span>.TestYear</span>     = <span class="mxinfo " id="T2:U213">zeros(<span class="mxinfo " id="T1:U214">1</span>,<span class="mxinfo " id="T1:U215">25000</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">  74</a></span><span class="line"><span class="mxinfo " id="T2:U216"><span class="mxinfo " id="T2:U217"><span class="var type1" id="S5T3U345">Last</span>.TestYear2</span>    = <span class="mxinfo " id="T2:U219">zeros(<span class="mxinfo " id="T1:U220">1</span>,<span class="mxinfo " id="T1:U221">25000</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">  75</a></span><span class="line"><span class="mxinfo " id="T1:U222"><span class="var type1" id="S64T1U353">AusschlussPolyp</span> = <span class="mxinfo " id="T1:U224">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">  76</a></span><span class="line"><span class="mxinfo " id="T1:U225"><span class="var type1" id="S65T1U357">AusschlussCa</span>    = <span class="mxinfo " id="T1:U227">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">  77</a></span><span class="line"><span class="mxinfo " id="T1:U228"><span class="var type1" id="S66T1U361">AusschlussKolo</span>  = <span class="mxinfo " id="T1:U230">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">  78</a></span><span class="line"><span class="mxinfo " id="T1:U231"><span class="var type1" id="S67T1U365">PosPolyp</span>        = <span class="mxinfo " id="T1:U233">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">  79</a></span><span class="line"><span class="mxinfo " id="T1:U234"><span class="var type1" id="S68T1U369">PosCa</span>           = <span class="mxinfo " id="T1:U236">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">  80</a></span><span class="line"><span class="mxinfo " id="T1:U237"><span class="var type1" id="S69T1U373">PosPolypCa</span>      = <span class="mxinfo " id="T1:U239">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">  81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82">  82</a></span><span class="line"><span class="mxinfo " id="T45:U240"><span class="mxinfo " id="T45:U241"><span class="var type1" id="S70T46U378">Polyp</span>.Polyps</span>            = <span class="mxinfo " id="T45:U243">zeros(<span class="mxinfo " id="T1:U244">25000</span>, <span class="mxinfo " id="T1:U245">51</span>)</span></span>;   <span class="comment">% we initialize the polyps cells</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83">  83</a></span><span class="line"><span class="mxinfo " id="T45:U246"><span class="mxinfo " id="T45:U247"><span class="var type1" id="S70T46U387">Polyp</span>.PolypYear</span>         = <span class="mxinfo " id="T45:U249">zeros(<span class="mxinfo " id="T1:U250">25000</span>, <span class="mxinfo " id="T1:U251">51</span>)</span></span>;   <span class="comment">% we initialize the field for keeping track of years</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84">  84</a></span><span class="line"><span class="mxinfo " id="T45:U252"><span class="mxinfo " id="T45:U253"><span class="var type1" id="S70T46U396">Polyp</span>.PolypLocation</span>     = <span class="mxinfo " id="T45:U255">zeros(<span class="mxinfo " id="T1:U256">25000</span>, <span class="mxinfo " id="T1:U257">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85">  85</a></span><span class="line"><span class="mxinfo " id="T45:U258"><span class="mxinfo " id="T45:U259"><span class="var type1" id="S70T46U405">Polyp</span>.AdvProgression</span>    = <span class="mxinfo " id="T45:U261">zeros(<span class="mxinfo " id="T1:U262">25000</span>, <span class="mxinfo " id="T1:U263">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86">  86</a></span><span class="line"><span class="mxinfo " id="T45:U264"><span class="mxinfo " id="T45:U265"><span class="var type1" id="S70T46U414">Polyp</span>.EarlyProgression</span>  = <span class="mxinfo " id="T45:U267">zeros(<span class="mxinfo " id="T1:U268">25000</span>, <span class="mxinfo " id="T1:U269">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87">  87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88">  88</a></span><span class="line"><span class="mxinfo " id="T47:U270"><span class="mxinfo " id="T47:U271"><span class="var type1" id="S71T48U423">Ca</span>.Cancer</span>               = <span class="mxinfo " id="T47:U273">zeros(<span class="mxinfo " id="T1:U274">25000</span>, <span class="mxinfo " id="T1:U275">25</span>)</span></span>;    <span class="comment">% we initialize the cancer cells</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89">  89</a></span><span class="line"><span class="mxinfo " id="T47:U276"><span class="mxinfo " id="T47:U277"><span class="var type1" id="S71T48U432">Ca</span>.CancerYear</span>           = <span class="mxinfo " id="T47:U279">zeros(<span class="mxinfo " id="T1:U280">25000</span>, <span class="mxinfo " id="T1:U281">25</span>)</span></span>;    <span class="comment">% we initialize the field for keeping track of years</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90">  90</a></span><span class="line"><span class="mxinfo " id="T47:U282"><span class="mxinfo " id="T47:U283"><span class="var type1" id="S71T48U441">Ca</span>.CancerLocation</span>       = <span class="mxinfo " id="T47:U285">zeros(<span class="mxinfo " id="T1:U286">25000</span>, <span class="mxinfo " id="T1:U287">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91">  91</a></span><span class="line"><span class="mxinfo " id="T47:U288"><span class="mxinfo " id="T47:U289"><span class="var type1" id="S71T48U450">Ca</span>.TimeStage_I</span>          = <span class="mxinfo " id="T47:U291">zeros(<span class="mxinfo " id="T1:U292">25000</span>, <span class="mxinfo " id="T1:U293">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92">  92</a></span><span class="line"><span class="mxinfo " id="T47:U294"><span class="mxinfo " id="T47:U295"><span class="var type1" id="S71T48U459">Ca</span>.TimeStage_II</span>         = <span class="mxinfo " id="T47:U297">zeros(<span class="mxinfo " id="T1:U298">25000</span>, <span class="mxinfo " id="T1:U299">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93">  93</a></span><span class="line"><span class="mxinfo " id="T47:U300"><span class="mxinfo " id="T47:U301"><span class="var type1" id="S71T48U468">Ca</span>.TimeStage_III</span>        = <span class="mxinfo " id="T47:U303">zeros(<span class="mxinfo " id="T1:U304">25000</span>, <span class="mxinfo " id="T1:U305">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94">  94</a></span><span class="line"><span class="mxinfo " id="T47:U306"><span class="mxinfo " id="T47:U307"><span class="var type1" id="S71T48U477">Ca</span>.SympTime</span>             = <span class="mxinfo " id="T47:U309">zeros(<span class="mxinfo " id="T1:U310">25000</span>, <span class="mxinfo " id="T1:U311">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95">  95</a></span><span class="line"><span class="mxinfo " id="T47:U312"><span class="mxinfo " id="T47:U313"><span class="var type1" id="S71T48U486">Ca</span>.SympStage</span>            = <span class="mxinfo " id="T47:U315">zeros(<span class="mxinfo " id="T1:U316">25000</span>, <span class="mxinfo " id="T1:U317">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96">  96</a></span><span class="line"><span class="mxinfo " id="T47:U318"><span class="mxinfo " id="T47:U319"><span class="var type1" id="S71T48U495">Ca</span>.DwellTime</span>      = <span class="mxinfo " id="T47:U321">zeros(<span class="mxinfo " id="T1:U322">25000</span>, <span class="mxinfo " id="T1:U323">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97">  97</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98">  98</a></span><span class="line"><span class="comment">% consider increasing this to </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99">  99</a></span><span class="line"><span class="mxinfo " id="T49:U324"><span class="mxinfo " id="T49:U325"><span class="var type1" id="S72T50U504">Detected</span>.Cancer</span>         = <span class="mxinfo " id="T49:U327">zeros(<span class="mxinfo " id="T1:U328">25000</span>, <span class="mxinfo " id="T1:U329">50</span>)</span></span>;    <span class="comment">% this cancers are detected, patient might die</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100"> 100</a></span><span class="line"><span class="mxinfo " id="T49:U330"><span class="mxinfo " id="T49:U331"><span class="var type1" id="S72T50U513">Detected</span>.CancerYear</span>     = <span class="mxinfo " id="T49:U333">zeros(<span class="mxinfo " id="T1:U334">25000</span>, <span class="mxinfo " id="T1:U335">50</span>)</span></span>;    <span class="comment">% year this cancer had beed diagnosed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101"> 101</a></span><span class="line"><span class="mxinfo " id="T49:U336"><span class="mxinfo " id="T49:U337"><span class="var type1" id="S72T50U522">Detected</span>.CancerLocation</span> = <span class="mxinfo " id="T49:U339">zeros(<span class="mxinfo " id="T1:U340">25000</span>, <span class="mxinfo " id="T1:U341">50</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102"> 102</a></span><span class="line"><span class="mxinfo " id="T49:U342"><span class="mxinfo " id="T49:U343"><span class="var type1" id="S72T50U531">Detected</span>.MortTime</span>       = <span class="mxinfo " id="T49:U345">zeros(<span class="mxinfo " id="T1:U346">25000</span>, <span class="mxinfo " id="T1:U347">50</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103"> 103</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104"> 104</a></span><span class="line"><span class="mxinfo " id="T8:U348"><span class="var type1" id="S17T8U539">HasCancer</span> = <span class="mxinfo " id="T8:U350">zeros(<span class="mxinfo " id="T1:U351">100</span>, <span class="mxinfo " id="T1:U352">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105"> 105</a></span><span class="line"><span class="mxinfo " id="T8:U353"><span class="var type1" id="S18T8U546">NumPolyps</span> = <span class="mxinfo " id="T8:U355">zeros(<span class="mxinfo " id="T1:U356">100</span>, <span class="mxinfo " id="T1:U357">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106"> 106</a></span><span class="line"><span class="mxinfo " id="T8:U358"><span class="var type1" id="S19T8U553">MaxPolyps</span> = <span class="mxinfo " id="T8:U360">zeros(<span class="mxinfo " id="T1:U361">100</span>, <span class="mxinfo " id="T1:U362">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107"> 107</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108"> 108</a></span><span class="line"><span class="comment">% MaxPolypsRight  = zeros(100, 25000);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109"> 109</a></span><span class="line"><span class="comment">% MaxPolypsRectum = zeros(100, 25000);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110"> 110</a></span><span class="line"><span class="comment">% MaxPolypsRest   = zeros(100, 25000);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111"> 111</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112"> 112</a></span><span class="line"><span class="mxinfo " id="T9:U363"><span class="var type1" id="S20T9U560">AllPolyps</span>       = <span class="mxinfo " id="T9:U365">zeros(<span class="mxinfo " id="T1:U366">6</span>, <span class="mxinfo " id="T1:U367">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113"> 113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114"> 114</a></span><span class="line"><span class="mxinfo " id="T8:U368"><span class="var type1" id="S27T8U567">DiagnosedCancer</span>    = <span class="mxinfo " id="T8:U370">zeros(<span class="mxinfo " id="T1:U371">100</span>, <span class="mxinfo " id="T1:U372">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115"> 115</a></span><span class="line"><span class="mxinfo " id="T8:U373"><span class="var type1" id="S21T8U574">NumCancer</span>          = <span class="mxinfo " id="T8:U375">zeros(<span class="mxinfo " id="T1:U376">100</span>, <span class="mxinfo " id="T1:U377">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116"> 116</a></span><span class="line"><span class="mxinfo " id="T8:U378"><span class="var type1" id="S22T8U581">MaxCancer</span>          = <span class="mxinfo " id="T8:U380">zeros(<span class="mxinfo " id="T1:U381">100</span>, <span class="mxinfo " id="T1:U382">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117"> 117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118"> 118</a></span><span class="line"><span class="mxinfo " id="T16:U383"><span class="mxinfo " id="T16:U384"><span class="var type1" id="S24T15U589">Money</span>.AllCost</span>         = <span class="mxinfo " id="T16:U386">zeros(<span class="mxinfo " id="T1:U387">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119"> 119</a></span><span class="line"><span class="mxinfo " id="T16:U388"><span class="mxinfo " id="T16:U389"><span class="var type1" id="S24T15U598">Money</span>.AllCostFuture</span>   = <span class="mxinfo " id="T16:U391">zeros(<span class="mxinfo " id="T1:U392">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120"> 120</a></span><span class="line"><span class="mxinfo " id="T16:U393"><span class="mxinfo " id="T16:U394"><span class="var type1" id="S24T15U607">Money</span>.Treatment</span>       = <span class="mxinfo " id="T16:U396">zeros(<span class="mxinfo " id="T1:U397">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121"> 121</a></span><span class="line"><span class="mxinfo " id="T16:U398"><span class="mxinfo " id="T16:U399"><span class="var type1" id="S24T15U616">Money</span>.FutureTreatment</span> = <span class="mxinfo " id="T16:U401">zeros(<span class="mxinfo " id="T1:U402">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122"> 122</a></span><span class="line"><span class="mxinfo " id="T16:U403"><span class="mxinfo " id="T16:U404"><span class="var type1" id="S24T15U625">Money</span>.Screening</span>       = <span class="mxinfo " id="T16:U406">zeros(<span class="mxinfo " id="T1:U407">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123"> 123</a></span><span class="line"><span class="mxinfo " id="T16:U408"><span class="mxinfo " id="T16:U409"><span class="var type1" id="S24T15U634">Money</span>.FollowUp</span>        = <span class="mxinfo " id="T16:U411">zeros(<span class="mxinfo " id="T1:U412">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124"> 124</a></span><span class="line"><span class="mxinfo " id="T16:U413"><span class="mxinfo " id="T16:U414"><span class="var type1" id="S24T15U643">Money</span>.Other</span>           = <span class="mxinfo " id="T16:U416">zeros(<span class="mxinfo " id="T1:U417">100</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125"> 125</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126"> 126</a></span><span class="line"><span class="mxinfo " id="T5:U418"><span class="mxinfo " id="T5:U419"><span class="var type1" id="S25T17U652">Number</span>.Screening_Colonoscopy</span> = <span class="mxinfo " id="T5:U421">zeros(<span class="mxinfo " id="T1:U422">1</span>, <span class="mxinfo " id="T1:U423">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127"> 127</a></span><span class="line"><span class="mxinfo " id="T5:U424"><span class="mxinfo " id="T5:U425"><span class="var type1" id="S25T17U661">Number</span>.Symptoms_Colonoscopy</span>  = <span class="mxinfo " id="T5:U427">zeros(<span class="mxinfo " id="T1:U428">1</span>, <span class="mxinfo " id="T1:U429">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128"> 128</a></span><span class="line"><span class="mxinfo " id="T5:U430"><span class="mxinfo " id="T5:U431"><span class="var type1" id="S25T17U670">Number</span>.Follow_Up_Colonoscopy</span> = <span class="mxinfo " id="T5:U433">zeros(<span class="mxinfo " id="T1:U434">1</span>, <span class="mxinfo " id="T1:U435">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129"> 129</a></span><span class="line"><span class="mxinfo " id="T5:U436"><span class="mxinfo " id="T5:U437"><span class="var type1" id="S25T17U679">Number</span>.Baseline_Colonoscopy</span>  = <span class="mxinfo " id="T5:U439">zeros(<span class="mxinfo " id="T1:U440">1</span>, <span class="mxinfo " id="T1:U441">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130"> 130</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131"> 131</a></span><span class="line"><span class="mxinfo " id="T5:U442"><span class="mxinfo " id="T5:U443"><span class="var type1" id="S25T17U688">Number</span>.RectoSigmo</span>            = <span class="mxinfo " id="T5:U445">zeros(<span class="mxinfo " id="T1:U446">1</span>, <span class="mxinfo " id="T1:U447">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132"> 132</a></span><span class="line"><span class="mxinfo " id="T5:U448"><span class="mxinfo " id="T5:U449"><span class="var type1" id="S25T17U697">Number</span>.FOBT</span>                  = <span class="mxinfo " id="T5:U451">zeros(<span class="mxinfo " id="T1:U452">1</span>, <span class="mxinfo " id="T1:U453">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133"> 133</a></span><span class="line"><span class="mxinfo " id="T5:U454"><span class="mxinfo " id="T5:U455"><span class="var type1" id="S25T17U706">Number</span>.I_FOBT</span>                = <span class="mxinfo " id="T5:U457">zeros(<span class="mxinfo " id="T1:U458">1</span>, <span class="mxinfo " id="T1:U459">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134"> 134</a></span><span class="line"><span class="mxinfo " id="T5:U460"><span class="mxinfo " id="T5:U461"><span class="var type1" id="S25T17U715">Number</span>.Sept9</span>                 = <span class="mxinfo " id="T5:U463">zeros(<span class="mxinfo " id="T1:U464">1</span>, <span class="mxinfo " id="T1:U465">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135"> 135</a></span><span class="line"><span class="mxinfo " id="T5:U466"><span class="mxinfo " id="T5:U467"><span class="var type1" id="S25T17U724">Number</span>.other</span>                 = <span class="mxinfo " id="T5:U469">zeros(<span class="mxinfo " id="T1:U470">1</span>, <span class="mxinfo " id="T1:U471">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136"> 136</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137"> 137</a></span><span class="line"><span class="mxinfo " id="T5:U472"><span class="var type1" id="S26T5U732">EarlyPolypsRemoved</span>           = <span class="mxinfo " id="T5:U474">zeros(<span class="mxinfo " id="T1:U475">1</span>, <span class="mxinfo " id="T1:U476">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138"> 138</a></span><span class="line"><span class="mxinfo " id="T5:U477"><span class="var type1" id="S28T5U739">AdvancedPolypsRemoved</span>        = <span class="mxinfo " id="T5:U479">zeros(<span class="mxinfo " id="T1:U480">1</span>, <span class="mxinfo " id="T1:U481">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139"> 139</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140"> 140</a></span><span class="line"><span class="mxinfo " id="T18:U482"><span class="var type1" id="S29T18U746">YearIncluded</span> = <span class="mxinfo " id="T18:U484"><span class="mxinfo " id="T28:U485">false</span>(<span class="mxinfo " id="T1:U486">100</span>, <span class="mxinfo " id="T1:U487">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141"> 141</a></span><span class="line"><span class="mxinfo " id="T18:U488"><span class="var type1" id="S30T18U753">YearAlive</span>    = <span class="mxinfo " id="T18:U490"><span class="mxinfo " id="T28:U491">false</span>(<span class="mxinfo " id="T1:U492">100</span>, <span class="mxinfo " id="T1:U493">25000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142"> 142</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143"> 143</a></span><span class="line"><span class="comment">% Colo_Detection_bckup = StageVariables.Colo_Detection;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144"> 144</a></span><span class="line"><span class="comment">%m2 </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145"> 145</a></span><span class="line"><span class="comment">%m2 Number for each cost type</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146"> 146</a></span><span class="line"><span class="comment">% 4 types, Type 1: For screening, Type 2: treatment; Type 3: Followup; Type</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147"> 147</a></span><span class="line"><span class="comment">% 4: Other</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148"> 148</a></span><span class="line"><span class="comment">%m2 Purely screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149"> 149</a></span><span class="line"><span class="mxinfo " id="T5:U494"><span class="mxinfo " id="T5:U495"><span class="var type1" id="S23T10U761">PaymentType</span>.FOBT</span>             = <span class="mxinfo " id="T5:U497">zeros(<span class="mxinfo " id="T1:U498">1</span>, <span class="mxinfo " id="T1:U499">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150"> 150</a></span><span class="line"><span class="mxinfo " id="T5:U500"><span class="mxinfo " id="T5:U501"><span class="var type1" id="S23T10U770">PaymentType</span>.I_FOBT</span>           = <span class="mxinfo " id="T5:U503">zeros(<span class="mxinfo " id="T1:U504">1</span>, <span class="mxinfo " id="T1:U505">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151"> 151</a></span><span class="line"><span class="mxinfo " id="T5:U506"><span class="mxinfo " id="T5:U507"><span class="var type1" id="S23T10U779">PaymentType</span>.Sept9_HighSens</span>   = <span class="mxinfo " id="T5:U509">zeros(<span class="mxinfo " id="T1:U510">1</span>, <span class="mxinfo " id="T1:U511">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152"> 152</a></span><span class="line"><span class="mxinfo " id="T5:U512"><span class="mxinfo " id="T5:U513"><span class="var type1" id="S23T10U788">PaymentType</span>.Sept9_HighSpec</span>   = <span class="mxinfo " id="T5:U515">zeros(<span class="mxinfo " id="T1:U516">1</span>, <span class="mxinfo " id="T1:U517">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153"> 153</a></span><span class="line"><span class="mxinfo " id="T5:U518"><span class="mxinfo " id="T5:U519"><span class="var type1" id="S23T10U797">PaymentType</span>.RS</span>               = <span class="mxinfo " id="T5:U521">zeros(<span class="mxinfo " id="T1:U522">1</span>, <span class="mxinfo " id="T1:U523">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154"> 154</a></span><span class="line"><span class="mxinfo " id="T5:U524"><span class="mxinfo " id="T5:U525"><span class="var type1" id="S23T10U806">PaymentType</span>.RSPolyp</span>          = <span class="mxinfo " id="T5:U527">zeros(<span class="mxinfo " id="T1:U528">1</span>, <span class="mxinfo " id="T1:U529">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155"> 155</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156"> 156</a></span><span class="line"><span class="comment">%m2 Colonoscopy can be for screening, treatment, followup,  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157"> 157</a></span><span class="line"><span class="mxinfo " id="T11:U530"><span class="mxinfo " id="T11:U531"><span class="var type1" id="S23T10U815">PaymentType</span>.Colonoscopy</span>      = <span class="mxinfo " id="T11:U533">zeros(<span class="mxinfo " id="T1:U534">4</span>,<span class="mxinfo " id="T1:U535">100</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158"> 158</a></span><span class="line"><span class="mxinfo " id="T11:U536"><span class="mxinfo " id="T11:U537"><span class="var type1" id="S23T10U824">PaymentType</span>.ColonoscopyPolyp</span> = <span class="mxinfo " id="T11:U539">zeros(<span class="mxinfo " id="T1:U540">4</span>,<span class="mxinfo " id="T1:U541">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159"> 159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160"> 160</a></span><span class="line"><span class="comment">%m2 Complications at anytime screening, treatment or followup</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161"> 161</a></span><span class="line"><span class="mxinfo " id="T11:U542"><span class="mxinfo " id="T11:U543"><span class="var type1" id="S23T10U833">PaymentType</span>.Colonoscopy_Cancer</span>= <span class="mxinfo " id="T11:U545">zeros(<span class="mxinfo " id="T1:U546">4</span>, <span class="mxinfo " id="T1:U547">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162"> 162</a></span><span class="line"><span class="mxinfo " id="T11:U548"><span class="mxinfo " id="T11:U549"><span class="var type1" id="S23T10U842">PaymentType</span>.Perforation</span>      = <span class="mxinfo " id="T11:U551">zeros(<span class="mxinfo " id="T1:U552">4</span>, <span class="mxinfo " id="T1:U553">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163"> 163</a></span><span class="line"><span class="mxinfo " id="T11:U554"><span class="mxinfo " id="T11:U555"><span class="var type1" id="S23T10U851">PaymentType</span>.Serosa</span>           = <span class="mxinfo " id="T11:U557">zeros(<span class="mxinfo " id="T1:U558">4</span>, <span class="mxinfo " id="T1:U559">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164"> 164</a></span><span class="line"><span class="mxinfo " id="T11:U560"><span class="mxinfo " id="T11:U561"><span class="var type1" id="S23T10U860">PaymentType</span>.Bleeding</span>         = <span class="mxinfo " id="T11:U563">zeros(<span class="mxinfo " id="T1:U564">4</span>, <span class="mxinfo " id="T1:U565">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165"> 165</a></span><span class="line"><span class="mxinfo " id="T11:U566"><span class="mxinfo " id="T11:U567"><span class="var type1" id="S23T10U869">PaymentType</span>.BleedingTransf</span>   = <span class="mxinfo " id="T11:U569">zeros(<span class="mxinfo " id="T1:U570">4</span>, <span class="mxinfo " id="T1:U571">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166"> 166</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167"> 167</a></span><span class="line"><span class="comment">%m2 cancer treatment costs index is for stage</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168"> 168</a></span><span class="line"><span class="mxinfo " id="T12:U572"><span class="mxinfo " id="T12:U573"><span class="var type1" id="S23T10U878">PaymentType</span>.Cancer_ini</span>      = <span class="mxinfo " id="T12:U575">zeros(<span class="mxinfo " id="T1:U576">4</span>, <span class="mxinfo " id="T1:U577">101</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169"> 169</a></span><span class="line"><span class="mxinfo " id="T12:U578"><span class="mxinfo " id="T12:U579"><span class="var type1" id="S23T10U887">PaymentType</span>.Cancer_con</span>      = <span class="mxinfo " id="T12:U581">zeros(<span class="mxinfo " id="T1:U582">4</span>, <span class="mxinfo " id="T1:U583">101</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170"> 170</a></span><span class="line"><span class="mxinfo " id="T12:U584"><span class="mxinfo " id="T12:U585"><span class="var type1" id="S23T10U896">PaymentType</span>.Cancer_fin</span>      = <span class="mxinfo " id="T12:U587">zeros(<span class="mxinfo " id="T1:U588">4</span>, <span class="mxinfo " id="T1:U589">101</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171"> 171</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172"> 172</a></span><span class="line"><span class="comment">%m2 cancer treatment costs index is for stage, noted by quarters</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173"> 173</a></span><span class="line"><span class="mxinfo " id="T13:U590"><span class="mxinfo " id="T13:U591"><span class="var type1" id="S23T10U905">PaymentType</span>.QCancer_ini</span>      = <span class="mxinfo " id="T13:U593">zeros(<span class="mxinfo " id="T1:U594">4</span>, <span class="mxinfo " id="T1:U595">101</span>,<span class="mxinfo " id="T1:U596">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174"> 174</a></span><span class="line"><span class="mxinfo " id="T14:U597"><span class="mxinfo " id="T14:U598"><span class="var type1" id="S23T10U915">PaymentType</span>.QCancer_con</span>      = <span class="mxinfo " id="T14:U600">zeros(<span class="mxinfo " id="T1:U601">4</span>, <span class="mxinfo " id="T1:U602">101</span>,<span class="mxinfo " id="T1:U603">20</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175"> 175</a></span><span class="line"><span class="mxinfo " id="T13:U604"><span class="mxinfo " id="T13:U605"><span class="var type1" id="S23T10U925">PaymentType</span>.QCancer_fin</span>      = <span class="mxinfo " id="T13:U607">zeros(<span class="mxinfo " id="T1:U608">4</span>, <span class="mxinfo " id="T1:U609">101</span>,<span class="mxinfo " id="T1:U610">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176"> 176</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177"> 177</a></span><span class="line"><span class="mxinfo " id="T5:U611"><span class="mxinfo " id="T5:U612"><span class="var type1" id="S23T10U935">PaymentType</span>.Other</span>            = <span class="mxinfo " id="T5:U614">zeros(<span class="mxinfo " id="T1:U615">1</span>, <span class="mxinfo " id="T1:U616">100</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178"> 178</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179"> 179</a></span><span class="line"><span class="comment">% matrix for fast indexing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180"> 180</a></span><span class="line"><span class="mxinfo " id="T51:U617"><span class="var type1" id="S74T51U943">GenderProgression</span> = <span class="mxinfo " id="T51:U619">ones(<span class="mxinfo " id="T1:U620">10</span>, <span class="mxinfo " id="T1:U621">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181"> 181</a></span><span class="line"><span class="mxinfo " id="T52:U622"><span class="mxinfo " id="T52:U623"><span class="var type1" id="S74T51U951">GenderProgression</span>(<span class="mxinfo " id="T53:U625">1:4</span>, <span class="mxinfo " id="T54:U626">2</span>)</span> = <span class="mxinfo " id="T1:U627"><span class="var type1" id="S39T30U957">female</span>.early_progression_female</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182"> 182</a></span><span class="line"><span class="mxinfo " id="T55:U629"><span class="mxinfo " id="T55:U630"><span class="var type1" id="S74T51U962">GenderProgression</span>(<span class="mxinfo " id="T56:U632">5:6</span>, <span class="mxinfo " id="T54:U633">2</span>)</span> = <span class="mxinfo " id="T1:U634"><span class="var type1" id="S39T30U968">female</span>.advanced_progression_female</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183"> 183</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184"> 184</a></span><span class="line"><span class="comment">% matrix for fast indexing</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185"> 185</a></span><span class="line"><span class="mxinfo " id="T57:U636"><span class="var type1" id="S75T57U972">LocationProgression</span> = <span class="mxinfo " id="T57:U638">zeros(<span class="mxinfo " id="T1:U639">10</span>, <span class="mxinfo " id="T1:U640">13</span>)</span></span>; <span class="comment">% 10 polyps x 13 locations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186"> 186</a></span><span class="line"><span class="mxinfo " id="T22:U641"><span class="mxinfo " id="T22:U642"><span class="var type1" id="S75T57U980">LocationProgression</span>(<span class="mxinfo " id="T1:U644">1</span>, <span class="mxinfo " id="T58:U645">:</span>)</span> = <span class="mxinfo " id="T22:U646"><span class="var type1" id="S33T21U984">Location</span>.EarlyProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187"> 187</a></span><span class="line"><span class="mxinfo " id="T22:U648"><span class="mxinfo " id="T22:U649"><span class="var type1" id="S75T57U989">LocationProgression</span>(<span class="mxinfo " id="T1:U651">2</span>, <span class="mxinfo " id="T58:U652">:</span>)</span> = <span class="mxinfo " id="T22:U653"><span class="var type1" id="S33T21U993">Location</span>.EarlyProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188"> 188</a></span><span class="line"><span class="mxinfo " id="T22:U655"><span class="mxinfo " id="T22:U656"><span class="var type1" id="S75T57U998">LocationProgression</span>(<span class="mxinfo " id="T1:U658">3</span>, <span class="mxinfo " id="T58:U659">:</span>)</span> = <span class="mxinfo " id="T22:U660"><span class="var type1" id="S33T21U1002">Location</span>.EarlyProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189"> 189</a></span><span class="line"><span class="mxinfo " id="T22:U662"><span class="mxinfo " id="T22:U663"><span class="var type1" id="S75T57U1007">LocationProgression</span>(<span class="mxinfo " id="T1:U665">4</span>, <span class="mxinfo " id="T58:U666">:</span>)</span> = <span class="mxinfo " id="T22:U667"><span class="var type1" id="S33T21U1011">Location</span>.EarlyProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190"> 190</a></span><span class="line"><span class="mxinfo " id="T22:U669"><span class="mxinfo " id="T22:U670"><span class="var type1" id="S75T57U1016">LocationProgression</span>(<span class="mxinfo " id="T1:U672">5</span>, <span class="mxinfo " id="T58:U673">:</span>)</span> = <span class="mxinfo " id="T22:U674"><span class="var type1" id="S33T21U1020">Location</span>.EarlyProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191"> 191</a></span><span class="line"><span class="comment">%LocationProgression(5, :)= Location.AdvancedProgression;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192"> 192</a></span><span class="line"><span class="mxinfo " id="T22:U676"><span class="mxinfo " id="T22:U677"><span class="var type1" id="S75T57U1025">LocationProgression</span>(<span class="mxinfo " id="T1:U679">6</span>, <span class="mxinfo " id="T58:U680">:</span>)</span> = <span class="mxinfo " id="T22:U681"><span class="var type1" id="S33T21U1029">Location</span>.AdvancedProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193"> 193</a></span><span class="line"><span class="mxinfo " id="T22:U683"><span class="mxinfo " id="T22:U684"><span class="var type1" id="S75T57U1034">LocationProgression</span>(<span class="mxinfo " id="T1:U686">7</span>, <span class="mxinfo " id="T58:U687">:</span>)</span> = <span class="mxinfo " id="T22:U688"><span class="var type1" id="S33T21U1038">Location</span>.CancerProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194"> 194</a></span><span class="line"><span class="mxinfo " id="T22:U690"><span class="mxinfo " id="T22:U691"><span class="var type1" id="S75T57U1043">LocationProgression</span>(<span class="mxinfo " id="T1:U693">8</span>, <span class="mxinfo " id="T58:U694">:</span>)</span> = <span class="mxinfo " id="T22:U695"><span class="var type1" id="S33T21U1047">Location</span>.CancerProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195"> 195</a></span><span class="line"><span class="mxinfo " id="T22:U697"><span class="mxinfo " id="T22:U698"><span class="var type1" id="S75T57U1052">LocationProgression</span>(<span class="mxinfo " id="T1:U700">9</span>, <span class="mxinfo " id="T58:U701">:</span>)</span> = <span class="mxinfo " id="T22:U702"><span class="var type1" id="S33T21U1056">Location</span>.CancerProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196"> 196</a></span><span class="line"><span class="mxinfo " id="T22:U704"><span class="mxinfo " id="T22:U705"><span class="var type1" id="S75T57U1061">LocationProgression</span>(<span class="mxinfo " id="T1:U707">10</span>, <span class="mxinfo " id="T58:U708">:</span>)</span> = <span class="mxinfo " id="T22:U709"><span class="var type1" id="S33T21U1065">Location</span>.CancerProgression</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197"> 197</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198"> 198</a></span><span class="line"><span class="comment">% reach of rectosigmoidoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199"> 199</a></span><span class="line"><span class="mxinfo " id="T59:U711"><span class="var type1" id="S76T59U1069">TmpLoc</span> = <span class="mxinfo " id="T59:U713">zeros(<span class="mxinfo " id="T1:U714">13</span>,<span class="mxinfo " id="T1:U715">1000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200"> 200</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1076">f</span> = <span class="mxinfo " id="T1:U717">1</span>:13</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201"> 201</a></span><span class="line">    <span class="mxinfo " id="T60:U718"><span class="mxinfo " id="T60:U719"><span class="var type1" id="S76T59U1083">TmpLoc</span>(<span class="var type1" id="S77T1U1084">f</span>, <span class="mxinfo " id="T61:U722"><span class="mxinfo " id="T1:U723">1</span>:<span class="mxinfo " id="T1:U724">round(<span class="mxinfo " id="T1:U725"><span class="mxinfo " id="T1:U726">1000</span>*<span class="mxinfo " id="T1:U727"><span class="mxinfo " id="T22:U728"><span class="var type1" id="S33T21U1093">Location</span>.RectoSigmoReach</span>(<span class="var type1" id="S77T1U1095">f</span>)</span></span>)</span></span>)</span> = <span class="mxinfo " id="T1:U731">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202"> 202</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203"> 203</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1099">f</span> = <span class="mxinfo " id="T1:U733">1</span>:12</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204"> 204</a></span><span class="line">    <span class="mxinfo " id="T62:U734"><span class="mxinfo " id="T62:U735"><span class="var type1" id="S76T59U1106">TmpLoc</span>(<span class="mxinfo " id="T1:U737"><span class="var type1" id="S77T1U1108">f</span>+<span class="mxinfo " id="T1:U739">1</span></span>, <span class="mxinfo " id="T63:U740">:</span>)</span> = <span class="mxinfo " id="T64:U741">or(<span class="mxinfo " id="T62:U742"><span class="var type1" id="S76T59U1114">TmpLoc</span>(<span class="mxinfo " id="T1:U744"><span class="var type1" id="S77T1U1116">f</span>+<span class="mxinfo " id="T1:U746">1</span></span>, <span class="mxinfo " id="T63:U747">:</span>)</span>, <span class="mxinfo " id="T62:U748"><span class="var type1" id="S76T59U1120">TmpLoc</span>(<span class="var type1" id="S77T1U1121">f</span>, <span class="mxinfo " id="T63:U751">:</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205"> 205</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206"> 206</a></span><span class="line"><span class="mxinfo " id="T62:U752"><span class="var type1" id="S79T62U1125">RectoSigmoReachMatrix</span> = <span class="mxinfo " id="T62:U754"><span class="mxinfo " id="T62:U755">-<span class="mxinfo " id="T62:U756">sum(<span class="var type1" id="S76T59U1130">TmpLoc</span>, 1)</span></span>+<span class="mxinfo " id="T1:U758">14</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207"> 207</a></span><span class="line"><span class="comment">% reach of colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208"> 208</a></span><span class="line"><span class="mxinfo " id="T59:U759"><span class="var type1" id="S76T59U1135">TmpLoc</span> = <span class="mxinfo " id="T59:U761">zeros(<span class="mxinfo " id="T1:U762">13</span>,<span class="mxinfo " id="T1:U763">1000</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209"> 209</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1142">f</span> = <span class="mxinfo " id="T1:U765">1</span>:13</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210"> 210</a></span><span class="line">    <span class="mxinfo " id="T60:U766"><span class="mxinfo " id="T60:U767"><span class="var type1" id="S76T59U1149">TmpLoc</span>(<span class="var type1" id="S77T1U1150">f</span>, <span class="mxinfo " id="T61:U770"><span class="mxinfo " id="T1:U771">1</span>:<span class="mxinfo " id="T1:U772">round(<span class="mxinfo " id="T1:U773"><span class="mxinfo " id="T1:U774">1000</span>*<span class="mxinfo " id="T1:U775"><span class="mxinfo " id="T22:U776"><span class="var type1" id="S33T21U1159">Location</span>.ColoReach</span>(<span class="var type1" id="S77T1U1161">f</span>)</span></span>)</span></span>)</span> = <span class="mxinfo " id="T1:U779">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211"> 211</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212"> 212</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1165">f</span> = <span class="mxinfo " id="T1:U781">1</span>:12</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213"> 213</a></span><span class="line">    <span class="mxinfo " id="T62:U782"><span class="mxinfo " id="T62:U783"><span class="var type1" id="S76T59U1172">TmpLoc</span>(<span class="mxinfo " id="T1:U785"><span class="var type1" id="S77T1U1174">f</span>+<span class="mxinfo " id="T1:U787">1</span></span>, <span class="mxinfo " id="T63:U788">:</span>)</span> = <span class="mxinfo " id="T64:U789">or(<span class="mxinfo " id="T62:U790"><span class="var type1" id="S76T59U1180">TmpLoc</span>(<span class="mxinfo " id="T1:U792"><span class="var type1" id="S77T1U1182">f</span>+<span class="mxinfo " id="T1:U794">1</span></span>, <span class="mxinfo " id="T63:U795">:</span>)</span>, <span class="mxinfo " id="T62:U796"><span class="var type1" id="S76T59U1186">TmpLoc</span>(<span class="var type1" id="S77T1U1187">f</span>, <span class="mxinfo " id="T63:U799">:</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214"> 214</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215"> 215</a></span><span class="line"><span class="mxinfo " id="T62:U800"><span class="var type1" id="S81T62U1191">ColoReachMatrix</span> = <span class="mxinfo " id="T62:U802"><span class="mxinfo " id="T62:U803">-<span class="mxinfo " id="T62:U804">sum(<span class="var type1" id="S76T59U1196">TmpLoc</span>, 1)</span></span>+<span class="mxinfo " id="T1:U806">14</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216"> 216</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217"> 217</a></span><span class="line"><span class="mxinfo " id="T1:U807"><span class="var type1" id="S82T1U1201">Counter</span> = <span class="mxinfo " id="T1:U809">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218"> 218</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1205">f</span> = <span class="mxinfo " id="T1:U811">1</span> : 13</span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219"> 219</a></span><span class="line">    <span class="mxinfo " id="T1:U812"><span class="var type1" id="S83T1U1211">Ende</span> = <span class="mxinfo " id="T1:U814">round(<span class="mxinfo " id="T1:U815"><span class="mxinfo " id="T1:U816"><span class="mxinfo " id="T1:U817">sum(<span class="mxinfo " id="T65:U818"><span class="mxinfo " id="T22:U819"><span class="var type1" id="S33T21U1220">Location</span>.NewPolyp</span>(<span class="mxinfo " id="T66:U821"><span class="mxinfo " id="T1:U822">1</span>:<span class="var type1" id="S77T1U1224">f</span></span>)</span>)</span>/<span class="mxinfo " id="T1:U824">sum(<span class="mxinfo " id="T22:U825"><span class="var type1" id="S33T21U1228">Location</span>.NewPolyp</span>)</span></span>*<span class="mxinfo " id="T1:U827">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220"> 220</a></span><span class="line">    <span class="mxinfo " id="T67:U828"><span class="mxinfo " id="T67:U829"><span class="var type1" id="S50T39U1234">LocationMatrix</span>(<span class="mxinfo " id="T68:U831"><span class="var type1" id="S82T1U1236">Counter</span>:<span class="var type1" id="S83T1U1237">Ende</span></span>)</span> = <span class="var type1" id="S77T1U1238">f</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221"> 221</a></span><span class="line">    <span class="mxinfo " id="T1:U835"><span class="var type1" id="S82T1U1241">Counter</span> = <span class="var type1" id="S83T1U1242">Ende</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222"> 222</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223"> 223</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224"> 224</a></span><span class="line"><span class="comment">% Cancer progression</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225"> 225</a></span><span class="line"><span class="comment">% Stage 1: 5%, Stage 2: 35%, Stage 3: 40%, Stage 4: 20%.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226"> 226</a></span><span class="line"><span class="mxinfo " id="T69:U838"><span class="var type1" id="S84T69U1245">StageMatrix</span> = <span class="mxinfo " id="T69:U840">zeros(<span class="mxinfo " id="T1:U841">1000</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227"> 227</a></span><span class="line"><span class="mxinfo " id="T34:U842"><span class="mxinfo " id="T34:U843"><span class="var type1" id="S84T69U1253">StageMatrix</span>(1:150)</span>    = <span class="mxinfo " id="T1:U845">7</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228"> 228</a></span><span class="line"><span class="mxinfo " id="T70:U846"><span class="mxinfo " id="T70:U847"><span class="var type1" id="S84T69U1261">StageMatrix</span>(151:506)</span>   = <span class="mxinfo " id="T1:U849">8</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229"> 229</a></span><span class="line"><span class="mxinfo " id="T71:U850"><span class="mxinfo " id="T71:U851"><span class="var type1" id="S84T69U1269">StageMatrix</span>(507:785)</span>  = <span class="mxinfo " id="T1:U853">9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230"> 230</a></span><span class="line"><span class="mxinfo " id="T72:U854"><span class="mxinfo " id="T72:U855"><span class="var type1" id="S84T69U1277">StageMatrix</span>(786:1000)</span> = <span class="mxinfo " id="T1:U857">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231"> 231</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232"> 232</a></span><span class="line"><span class="mxinfo " id="T73:U858"><span class="var type1" id="S85T73U1284">tx2</span> = <span class="mxinfo " id="T73:U860">0.25 : 0.25 : 6.25</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233"> 233</a></span><span class="line"><span class="mxinfo " id="T74:U861"><span class="var type1" id="S86T74U1292">SojournMatrix</span> = <span class="mxinfo " id="T74:U863">zeros(<span class="mxinfo " id="T1:U864">1000</span>, <span class="mxinfo " id="T1:U865">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,234" id="srcline234"> 234</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U1299">f</span>=<span class="mxinfo " id="T1:U867">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,235" id="srcline235"> 235</a></span><span class="line">    <span class="mxinfo " id="T75:U868"><span class="var type1" id="S87T75U1305">tx3</span> = <span class="mxinfo " id="T75:U870"><span class="var type1" id="S52T41U1307">tx1</span>(<span class="mxinfo " id="T76:U872">:</span>, <span class="var type1" id="S77T1U1309">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,236" id="srcline236"> 236</a></span><span class="line">    <span class="mxinfo " id="T75:U874"><span class="var type1" id="S87T75U1312">tx3</span> = <span class="mxinfo " id="T75:U876">round(<span class="mxinfo " id="T75:U877"><span class="mxinfo " id="T75:U878"><span class="mxinfo " id="T75:U879"><span class="var type1" id="S87T75U1318">tx3</span>/<span class="mxinfo " id="T1:U881">sum(<span class="var type1" id="S87T75U1321">tx3</span>)</span></span>*<span class="mxinfo " id="T1:U883">10</span></span>*<span class="mxinfo " id="T1:U884">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,237" id="srcline237"> 237</a></span><span class="line">    <span class="mxinfo " id="T1:U885"><span class="var type1" id="S82T1U1326">Counter</span> = <span class="mxinfo " id="T1:U887">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,238" id="srcline238"> 238</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S88T1U1330">f2</span>=<span class="mxinfo " id="T1:U889">1</span>:25</span></span>
<span class="srcline"><span class="lineno"><a href="1,239" id="srcline239"> 239</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T28:U890">~<span class="mxinfo " id="T28:U891">isequal(<span class="mxinfo " id="T1:U892">round(<span class="mxinfo " id="T1:U893"><span class="mxinfo " id="T1:U894"><span class="var type1" id="S87T75U1343">tx3</span>(<span class="var type1" id="S88T1U1344">f2</span>)</span>/<span class="mxinfo " id="T1:U897">10</span></span>)</span>, <span class="mxinfo " id="T1:U898">0</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,240" id="srcline240"> 240</a></span><span class="line">            <span class="mxinfo " id="T77:U899"><span class="mxinfo " id="T77:U900"><span class="var type1" id="S86T74U1350">SojournMatrix</span>(<span class="mxinfo " id="T61:U902"><span class="var type1" id="S82T1U1352">Counter</span> : <span class="mxinfo " id="T1:U904">round(<span class="mxinfo " id="T1:U905"><span class="mxinfo " id="T1:U906">sum(<span class="mxinfo " id="T78:U907"><span class="var type1" id="S87T75U1359">tx3</span>(<span class="mxinfo " id="T79:U909"><span class="mxinfo " id="T1:U910">1</span>:<span class="var type1" id="S88T1U1362">f2</span></span>)</span>)</span>/<span class="mxinfo " id="T1:U912">10</span></span>)</span></span>, <span class="var type1" id="S77T1U1364">f</span>)</span> = <span class="mxinfo " id="T1:U914"><span class="var type1" id="S85T73U1366">tx2</span>(<span class="var type1" id="S88T1U1367">f2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,241" id="srcline241"> 241</a></span><span class="line">            <span class="mxinfo " id="T1:U917"><span class="var type1" id="S82T1U1370">Counter</span> = <span class="mxinfo " id="T1:U919">round(<span class="mxinfo " id="T1:U920"><span class="mxinfo " id="T1:U921">sum(<span class="mxinfo " id="T78:U922"><span class="var type1" id="S87T75U1377">tx3</span>(<span class="mxinfo " id="T79:U924"><span class="mxinfo " id="T1:U925">1</span>:<span class="var type1" id="S88T1U1380">f2</span></span>)</span>)</span>/<span class="mxinfo " id="T1:U927">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,242" id="srcline242"> 242</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U928">and(<span class="mxinfo " id="T28:U929">isequal(<span class="var type1" id="S88T1U1388">f2</span>, <span class="mxinfo " id="T1:U931">25</span>)</span>, <span class="mxinfo " id="T28:U932">~<span class="mxinfo " id="T28:U933">isequal(<span class="var type1" id="S82T1U1393">Counter</span>, <span class="mxinfo " id="T1:U935">1000</span>)</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,243" id="srcline243"> 243</a></span><span class="line">                <span class="mxinfo " id="T77:U936"><span class="mxinfo " id="T77:U937"><span class="var type1" id="S86T74U1398">SojournMatrix</span>(<span class="mxinfo " id="T61:U939"><span class="var type1" id="S82T1U1400">Counter</span>:<span class="mxinfo " id="T1:U941">1000</span></span>, <span class="var type1" id="S77T1U1402">f</span>)</span> = <span class="mxinfo " id="T1:U943"><span class="var type1" id="S85T73U1404">tx2</span>(<span class="var type1" id="S88T1U1405">f2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,244" id="srcline244"> 244</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,245" id="srcline245"> 245</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,246" id="srcline246"> 246</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,247" id="srcline247"> 247</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,248" id="srcline248"> 248</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,249" id="srcline249"> 249</a></span><span class="line"><span class="mxinfo " id="T25:U946"><span class="var type1" id="S91T25U1408">CaSurv</span>  = <span class="mxinfo " id="T25:U948">zeros(<span class="mxinfo " id="T1:U949">1</span>,<span class="mxinfo " id="T1:U950">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,250" id="srcline250"> 250</a></span><span class="line"><span class="mxinfo " id="T25:U951"><span class="var type1" id="S92T25U1415">CaDeath</span> = <span class="mxinfo " id="T25:U953">zeros(<span class="mxinfo " id="T1:U954">1</span>,<span class="mxinfo " id="T1:U955">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,251" id="srcline251"> 251</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,252" id="srcline252"> 252</a></span><span class="line"><span class="mxinfo " id="T1:U956"><span class="var type1" id="S2T1U1422">y</span>=<span class="mxinfo " id="T1:U958">0</span></span>; <span class="comment">% year</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,253" id="srcline253"> 253</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo " id="T28:U959">and((<span class="mxinfo " id="T28:U960"><span class="mxinfo " id="T1:U961">sum(<span class="var type1" id="S58T44U1431">Included</span>)</span> &gt; <span class="mxinfo " id="T1:U963">0</span></span>), <span class="mxinfo " id="T28:U964"><span class="var type1" id="S2T1U1434">y</span>&lt;<span class="mxinfo " id="T1:U966">100</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,254" id="srcline254"> 254</a></span><span class="line">    <span class="mxinfo " id="T1:U967"><span class="var type1" id="S2T1U1438">y</span>=<span class="mxinfo " id="T1:U969"><span class="var type1" id="S2T1U1440">y</span>+<span class="mxinfo " id="T1:U971">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,255" id="srcline255"> 255</a></span><span class="line"><span class="comment">%     if y==2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,256" id="srcline256"> 256</a></span><span class="line"><span class="comment">%          save variables_3_10_2013.mat</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,257" id="srcline257"> 257</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,258" id="srcline258"> 258</a></span><span class="line">    <span class="comment">% for speed we make this calculation in advance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,259" id="srcline259"> 259</a></span><span class="line">    <span class="comment">% we need to check, whether this works</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,260" id="srcline260"> 260</a></span><span class="line">    <span class="mxinfo " id="T2:U972"><span class="var type1" id="S93T2U1444">PolypRate</span> = <span class="mxinfo " id="T2:U974">ones(1, 25000)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,261" id="srcline261"> 261</a></span><span class="line">    <span class="comment">% the individual risc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,262" id="srcline262"> 262</a></span><span class="line">    <span class="mxinfo " id="T2:U975"><span class="var type1" id="S93T2U1451">PolypRate</span> = <span class="mxinfo " id="T2:U977"><span class="var type1" id="S93T2U1453">PolypRate</span> .* <span class="var type1" id="S46T2U1454">IndividualRisk</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,263" id="srcline263"> 263</a></span><span class="line">    <span class="comment">% the age specific risc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,264" id="srcline264"> 264</a></span><span class="line">    <span class="mxinfo " id="T2:U980"><span class="var type1" id="S93T2U1457">PolypRate</span> = <span class="mxinfo " id="T2:U982"><span class="var type1" id="S93T2U1459">PolypRate</span> .* <span class="mxinfo " id="T1:U984"><span class="var type1" id="S44T34U1461">NewPolyp</span>(<span class="var type1" id="S2T1U1462">y</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,265" id="srcline265"> 265</a></span><span class="line">    <span class="comment">% the gender specific risc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,266" id="srcline266"> 266</a></span><span class="line">    <span class="mxinfo " id="T80:U987"><span class="mxinfo " id="T80:U988"><span class="var type1" id="S93T2U1466">PolypRate</span>(<span class="mxinfo " id="T44:U990"><span class="var type1" id="S3T2U1468">Gender</span> == <span class="mxinfo " id="T1:U992">2</span></span>)</span> = <span class="mxinfo " id="T80:U993"><span class="mxinfo " id="T80:U994"><span class="var type1" id="S93T2U1472">PolypRate</span>(<span class="mxinfo " id="T44:U996"><span class="var type1" id="S3T2U1474">Gender</span> == <span class="mxinfo " id="T1:U998">2</span></span>)</span> * <span class="mxinfo " id="T1:U999"><span class="var type1" id="S39T30U1477">female</span>.new_polyp_female</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,267" id="srcline267"> 267</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,268" id="srcline268"> 268</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S94T1U1481">z</span>=<span class="mxinfo " id="T1:U1002">1</span>:<span class="var type1" id="S57T1U1484">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,269" id="srcline269"> 269</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,270" id="srcline270"> 270</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S95T1U1487">q</span> = <span class="mxinfo " id="T1:U1005">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,271" id="srcline271"> 271</a></span><span class="line">            <span class="mxinfo " id="T1:U1006"><span class="var type1" id="S96T1U1493">time</span> = <span class="mxinfo " id="T1:U1008"><span class="var type1" id="S2T1U1495">y</span> + <span class="mxinfo " id="T1:U1010">(<span class="mxinfo " id="T1:U1011"><span class="var type1" id="S95T1U1499">q</span>-<span class="mxinfo " id="T1:U1013">1</span></span>)/<span class="mxinfo " id="T1:U1014">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,272" id="srcline272"> 272</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,273" id="srcline273"> 273</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,274" id="srcline274"> 274</a></span><span class="line">            <span class="comment">%  people die of natural causes     %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,275" id="srcline275"> 275</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,276" id="srcline276"> 276</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,277" id="srcline277"> 277</a></span><span class="line">            <span class="comment">%     try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,278" id="srcline278"> 278</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1015"><span class="var type1" id="S60T44U1505">Alive</span>(<span class="var type1" id="S94T1U1506">z</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,279" id="srcline279"> 279</a></span><span class="line">                <span class="comment">% divided by 4 since this is a quarterly calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,280" id="srcline280"> 280</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U1018"><span class="mxinfo " id="T1:U1019">rand</span> &lt; (<span class="mxinfo " id="T1:U1020"><span class="mxinfo " id="T1:U1021"><span class="var type1" id="S48T37U1515">LifeTable</span>(<span class="var type1" id="S2T1U1516">y</span>, <span class="mxinfo " id="T1:U1024"><span class="var type1" id="S3T2U1518">Gender</span>(<span class="var type1" id="S94T1U1519">z</span>)</span>)</span>/<span class="mxinfo " id="T1:U1027">4</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,281" id="srcline281"> 281</a></span><span class="line">                    <span class="mxinfo " id="T28:U1028"><span class="mxinfo " id="T28:U1029"><span class="var type1" id="S60T44U1524">Alive</span>(<span class="var type1" id="S94T1U1525">z</span>)</span>            = <span class="mxinfo " id="T28:U1032">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,282" id="srcline282"> 282</a></span><span class="line">                    <span class="mxinfo " id="T1:U1033"><span class="mxinfo " id="T1:U1034"><span class="var type1" id="S7T2U1531">NaturalDeathYear</span>(<span class="var type1" id="S94T1U1532">z</span>)</span> = <span class="var type1" id="S96T1U1533">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,283" id="srcline283"> 283</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,284" id="srcline284"> 284</a></span><span class="line">                    <span class="comment">% in these cases the patient was really alive</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,285" id="srcline285"> 285</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U1038"><span class="var type1" id="S58T44U1537">Included</span>(<span class="var type1" id="S94T1U1538">z</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,286" id="srcline286"> 286</a></span><span class="line">                        <span class="mxinfo " id="T28:U1041"><span class="mxinfo " id="T28:U1042"><span class="var type1" id="S58T44U1542">Included</span>(<span class="var type1" id="S94T1U1543">z</span>)</span>   = <span class="mxinfo " id="T28:U1045">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,287" id="srcline287"> 287</a></span><span class="line">                        <span class="mxinfo " id="T1:U1046"><span class="mxinfo " id="T1:U1047"><span class="var type1" id="S4T2U1549">DeathCause</span>(<span class="var type1" id="S94T1U1550">z</span>)</span> = <span class="mxinfo " id="T1:U1050">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,288" id="srcline288"> 288</a></span><span class="line">                        <span class="mxinfo " id="T1:U1051"><span class="mxinfo " id="T1:U1052"><span class="var type1" id="S6T2U1555">DeathYear</span>(<span class="var type1" id="S94T1U1556">z</span>)</span>  = <span class="var type1" id="S96T1U1557">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,289" id="srcline289"> 289</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,290" id="srcline290"> 290</a></span><span class="line">                        <span class="comment">% we need to calculate the costs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,291" id="srcline291"> 291</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1056"><span class="mxinfo " id="T1:U1057">sum(<span class="mxinfo " id="T81:U1058"><span class="mxinfo " id="T49:U1059"><span class="var type1" id="S72T50U1565">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1567">z</span>, <span class="mxinfo " id="T82:U1062">:</span>)</span>)</span> &gt; <span class="mxinfo " id="T1:U1063">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,292" id="srcline292"> 292</a></span><span class="line">                            [<span class="var type1" id="S24T15U1573">Money</span>, <span class="var type1" id="S23T10U1574">PaymentType</span>] = <span class="fcn" id="F259N3:B1576">AddCosts</span>(<span class="var type1" id="S72T50U1577">Detected</span>, <span class="var type1" id="S35T24U1578">CostStage</span>, <span class="var type1" id="S23T10U1579">PaymentType</span>, <span class="var type1" id="S24T15U1580">Money</span>, <span class="var type1" id="S96T1U1581">time</span>, <span class="var type1" id="S94T1U1582">z</span>, <span class="string">'oc'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,293" id="srcline293"> 293</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,294" id="srcline294"> 294</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,295" id="srcline295"> 295</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,296" id="srcline296"> 296</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,297" id="srcline297"> 297</a></span><span class="line">            <span class="comment">%             catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,298" id="srcline298"> 298</a></span><span class="line">            <span class="comment">%                 rethrow (exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,299" id="srcline299"> 299</a></span><span class="line">            <span class="comment">%             end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,300" id="srcline300"> 300</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,301" id="srcline301"> 301</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,302" id="srcline302"> 302</a></span><span class="line">            <span class="comment">%    people die of cancer           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,303" id="srcline303"> 303</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,304" id="srcline304"> 304</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,305" id="srcline305"> 305</a></span><span class="line">            <span class="comment">%         try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,306" id="srcline306"> 306</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1072"><span class="var type1" id="S58T44U1587">Included</span>(<span class="var type1" id="S94T1U1588">z</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,307" id="srcline307"> 307</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U1075">~<span class="mxinfo " id="T28:U1076">isempty(<span class="mxinfo " id="T83:U1077">find(<span class="mxinfo " id="T81:U1078"><span class="mxinfo " id="T49:U1079"><span class="var type1" id="S72T50U1598">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1600">z</span>, <span class="mxinfo " id="T82:U1082">:</span>)</span>, 1, <span class="string">'first'</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,308" id="srcline308"> 308</a></span><span class="line">                    <span class="mxinfo " id="T1:U1083"><span class="var type1" id="S101T1U1606">l</span> = <span class="mxinfo " id="T84:U1085">length(<span class="mxinfo " id="T84:U1086">find(<span class="mxinfo " id="T81:U1087"><span class="mxinfo " id="T49:U1088"><span class="var type1" id="S72T50U1613">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1615">z</span>, <span class="mxinfo " id="T82:U1091">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,309" id="srcline309"> 309</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S77T1U1619">f</span> = <span class="mxinfo " id="T1:U1093">1</span>:<span class="var type1" id="S101T1U1622">l</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,310" id="srcline310"> 310</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1095"><span class="mxinfo " id="T1:U1096"><span class="mxinfo " id="T49:U1097"><span class="var type1" id="S72T50U1628">Detected</span>.MortTime</span>(<span class="var type1" id="S94T1U1630">z</span>, <span class="var type1" id="S77T1U1631">f</span>)</span> &lt; <span class="mxinfo " id="T1:U1101">21</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,311" id="srcline311"> 311</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1102">(<span class="mxinfo " id="T1:U1103"><span class="var type1" id="S96T1U1638">time</span> - <span class="mxinfo " id="T1:U1105"><span class="mxinfo " id="T49:U1106"><span class="var type1" id="S72T50U1641">Detected</span>.CancerYear</span>(<span class="var type1" id="S94T1U1643">z</span>, <span class="var type1" id="S77T1U1644">f</span>)</span></span>) &gt;= <span class="mxinfo " id="T1:U1110"><span class="mxinfo " id="T1:U1111"><span class="mxinfo " id="T49:U1112"><span class="var type1" id="S72T50U1648">Detected</span>.MortTime</span>(<span class="var type1" id="S94T1U1650">z</span>, <span class="var type1" id="S77T1U1651">f</span>)</span>/<span class="mxinfo " id="T1:U1116">4</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,312" id="srcline312"> 312</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,313" id="srcline313"> 313</a></span><span class="line">                                <span class="comment">% patient died of cancer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,314" id="srcline314"> 314</a></span><span class="line">                                <span class="mxinfo " id="T28:U1117"><span class="mxinfo " id="T28:U1118"><span class="var type1" id="S58T44U1656">Included</span>(<span class="var type1" id="S94T1U1657">z</span>)</span>  = <span class="mxinfo " id="T28:U1121">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,315" id="srcline315"> 315</a></span><span class="line">                                <span class="mxinfo " id="T1:U1122"><span class="mxinfo " id="T1:U1123"><span class="var type1" id="S4T2U1663">DeathCause</span>(<span class="var type1" id="S94T1U1664">z</span>)</span>= <span class="mxinfo " id="T1:U1126">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,316" id="srcline316"> 316</a></span><span class="line">                                <span class="mxinfo " id="T1:U1127"><span class="mxinfo " id="T1:U1128"><span class="var type1" id="S6T2U1669">DeathYear</span>(<span class="var type1" id="S94T1U1670">z</span>)</span> = <span class="var type1" id="S96T1U1671">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,317" id="srcline317"> 317</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,318" id="srcline318"> 318</a></span><span class="line">                                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,319" id="srcline319"> 319</a></span><span class="line">                                <span class="comment">% we need to calculate the costs  %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,320" id="srcline320"> 320</a></span><span class="line">                                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,321" id="srcline321"> 321</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,322" id="srcline322"> 322</a></span><span class="line">                                [<span class="var type1" id="S24T15U1675">Money</span>, <span class="var type1" id="S23T10U1676">PaymentType</span>] = <span class="fcn" id="F363N3:B1678">AddCosts</span>(<span class="var type1" id="S72T50U1679">Detected</span>, <span class="var type1" id="S35T24U1680">CostStage</span>, <span class="var type1" id="S23T10U1681">PaymentType</span>, <span class="var type1" id="S24T15U1682">Money</span>, <span class="var type1" id="S96T1U1683">time</span>, <span class="var type1" id="S94T1U1684">z</span>, <span class="string">'tu'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,323" id="srcline323"> 323</a></span><span class="line">                                <span class="mxinfo " id="T1:U1140"><span class="mxinfo " id="T1:U1141"><span class="var type1" id="S92T25U1689">CaDeath</span>(<span class="mxinfo " id="T1:U1143"><span class="mxinfo " id="T1:U1144"><span class="mxinfo " id="T49:U1145"><span class="var type1" id="S72T50U1693">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1695">z</span>,<span class="var type1" id="S77T1U1696">f</span>)</span>-<span class="mxinfo " id="T1:U1149">6</span></span>)</span> = <span class="mxinfo " id="T1:U1150"><span class="mxinfo " id="T1:U1151"><span class="var type1" id="S92T25U1700">CaDeath</span>(<span class="mxinfo " id="T1:U1153"><span class="mxinfo " id="T1:U1154"><span class="mxinfo " id="T49:U1155"><span class="var type1" id="S72T50U1704">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1706">z</span>,<span class="var type1" id="S77T1U1707">f</span>)</span>-<span class="mxinfo " id="T1:U1159">6</span></span>)</span> + <span class="mxinfo " id="T1:U1160">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,324" id="srcline324"> 324</a></span><span class="line">                                <span class="comment">% we leave the loop</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,325" id="srcline325"> 325</a></span><span class="line">                                <span class="keyword">break</span>      </span></span>
<span class="srcline"><span class="lineno"><a href="1,326" id="srcline326"> 326</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,327" id="srcline327"> 327</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U1161">(<span class="mxinfo " id="T1:U1162"><span class="var type1" id="S96T1U1715">time</span> - <span class="mxinfo " id="T1:U1164"><span class="mxinfo " id="T49:U1165"><span class="var type1" id="S72T50U1718">Detected</span>.CancerYear</span>(<span class="var type1" id="S94T1U1720">z</span>, <span class="var type1" id="S77T1U1721">f</span>)</span></span>) == <span class="mxinfo " id="T1:U1169"><span class="mxinfo " id="T1:U1170">21</span>/<span class="mxinfo " id="T1:U1171">4</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,328" id="srcline328"> 328</a></span><span class="line">                            <span class="mxinfo " id="T1:U1172"><span class="mxinfo " id="T1:U1173"><span class="var type1" id="S91T25U1728">CaSurv</span>(<span class="mxinfo " id="T1:U1175"><span class="mxinfo " id="T1:U1176"><span class="mxinfo " id="T49:U1177"><span class="var type1" id="S72T50U1732">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1734">z</span>,<span class="var type1" id="S77T1U1735">f</span>)</span>-<span class="mxinfo " id="T1:U1181">6</span></span>)</span> = <span class="mxinfo " id="T1:U1182"><span class="mxinfo " id="T1:U1183"><span class="var type1" id="S91T25U1739">CaSurv</span>(<span class="mxinfo " id="T1:U1185"><span class="mxinfo " id="T1:U1186"><span class="mxinfo " id="T49:U1187"><span class="var type1" id="S72T50U1743">Detected</span>.Cancer</span>(<span class="var type1" id="S94T1U1745">z</span>,<span class="var type1" id="S77T1U1746">f</span>)</span>-<span class="mxinfo " id="T1:U1191">6</span></span>)</span> + <span class="mxinfo " id="T1:U1192">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,329" id="srcline329"> 329</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,330" id="srcline330"> 330</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,331" id="srcline331"> 331</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,332" id="srcline332"> 332</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,333" id="srcline333"> 333</a></span><span class="line">            <span class="comment">%             catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,334" id="srcline334"> 334</a></span><span class="line">            <span class="comment">%                 rethrow (exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,335" id="srcline335"> 335</a></span><span class="line">            <span class="comment">%             end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,336" id="srcline336"> 336</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,337" id="srcline337"> 337</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,338" id="srcline338"> 338</a></span><span class="line">            <span class="comment">% a NEW POLYP appears               %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,339" id="srcline339"> 339</a></span><span class="line">            <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,340" id="srcline340"> 340</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,341" id="srcline341"> 341</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1193"><span class="var type1" id="S58T44U1752">Included</span>(<span class="var type1" id="S94T1U1753">z</span>)</span> <span class="comment">% only in the first quarter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,342" id="srcline342"> 342</a></span><span class="line">                <span class="comment">%    try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,343" id="srcline343"> 343</a></span><span class="line">                <span class="comment">% a new polyp appears</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,344" id="srcline344"> 344</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U1196"><span class="mxinfo " id="T1:U1197">rand</span> &lt; <span class="mxinfo " id="T1:U1198"><span class="var type1" id="S93T2U1760">PolypRate</span>(<span class="var type1" id="S94T1U1761">z</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,345" id="srcline345"> 345</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U1201"><span class="mxinfo " id="T1:U1202"><span class="mxinfo " id="T45:U1203"><span class="var type1" id="S70T46U1767">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U1769">z</span>, <span class="mxinfo " id="T54:U1206">1</span>)</span> &gt; <span class="mxinfo " id="T1:U1207">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,346" id="srcline346"> 346</a></span><span class="line">                        <span class="mxinfo " id="T83:U1208"><span class="var type1" id="S103T83U1774">pos</span> = <span class="mxinfo " id="T83:U1210"><span class="mxinfo " id="T83:U1211">find(<span class="mxinfo " id="T85:U1212"><span class="mxinfo " id="T45:U1213"><span class="var type1" id="S70T46U1780">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U1782">z</span>, <span class="mxinfo " id="T86:U1216">:</span>)</span>, 1, <span class="string">'last'</span> )</span>+<span class="mxinfo " id="T1:U1217">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,347" id="srcline347"> 347</a></span><span class="line">                    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,348" id="srcline348"> 348</a></span><span class="line">                        <span class="mxinfo " id="T83:U1218"><span class="var type1" id="S103T83U1790">pos</span> = <span class="mxinfo " id="T1:U1220">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,349" id="srcline349"> 349</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,350" id="srcline350"> 350</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U1221"><span class="mxinfo " id="T1:U1222">max(<span class="var type1" id="S103T83U1797">pos</span>)</span>&lt;<span class="mxinfo " id="T1:U1224">50</span></span> <span class="comment">% number polyps limited to 50</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,351" id="srcline351"> 351</a></span><span class="line">                        <span class="mxinfo " id="T83:U1225"><span class="mxinfo " id="T83:U1226"><span class="mxinfo " id="T45:U1227"><span class="var type1" id="S70T46U1803">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U1805">z</span>, <span class="var type1" id="S103T83U1806">pos</span>)</span>           = <span class="mxinfo " id="T1:U1231">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,352" id="srcline352"> 352</a></span><span class="line">                        <span class="mxinfo " id="T83:U1232"><span class="mxinfo " id="T83:U1233"><span class="mxinfo " id="T45:U1234"><span class="var type1" id="S70T46U1812">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U1814">z</span>, <span class="var type1" id="S103T83U1815">pos</span>)</span>        = <span class="var type1" id="S96T1U1816">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,353" id="srcline353"> 353</a></span><span class="line">                        <span class="mxinfo " id="T83:U1239"><span class="mxinfo " id="T83:U1240"><span class="mxinfo " id="T45:U1241"><span class="var type1" id="S70T46U1821">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U1823">z</span>, <span class="var type1" id="S103T83U1824">pos</span>)</span>    = <span class="mxinfo " id="T1:U1245"><span class="var type1" id="S50T39U1826">LocationMatrix</span>(<span class="mxinfo " id="T1:U1247">1</span>, <span class="mxinfo " id="T1:U1248"><span class="mxinfo " id="T1:U1249">round(<span class="mxinfo " id="T1:U1250"><span class="mxinfo " id="T1:U1251">rand</span>*<span class="mxinfo " id="T1:U1252">999</span></span>)</span>+<span class="mxinfo " id="T1:U1253">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,354" id="srcline354"> 354</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,355" id="srcline355"> 355</a></span><span class="line">                        <span class="comment">% we just save the percentile of the risk, not the</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,356" id="srcline356"> 356</a></span><span class="line">                        <span class="comment">% absolute risk</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,357" id="srcline357"> 357</a></span><span class="line">                        <span class="mxinfo " id="T83:U1254"><span class="mxinfo " id="T83:U1255"><span class="mxinfo " id="T45:U1256"><span class="var type1" id="S70T46U1840">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U1842">z</span>, <span class="var type1" id="S103T83U1843">pos</span>)</span> = <span class="mxinfo " id="T1:U1260"><span class="mxinfo " id="T1:U1261">round(<span class="mxinfo " id="T1:U1262"><span class="mxinfo " id="T1:U1263">rand</span>*<span class="mxinfo " id="T1:U1264">499</span></span>)</span>+<span class="mxinfo " id="T1:U1265">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,358" id="srcline358"> 358</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,359" id="srcline359"> 359</a></span><span class="line">                        <span class="comment">% if correlation applies, both percentiles are</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,360" id="srcline360"> 360</a></span><span class="line">                        <span class="comment">% identical</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,361" id="srcline361"> 361</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1266"><span class="var type1" id="S37T27U1855">flag</span>.Correlation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,362" id="srcline362"> 362</a></span><span class="line">                            <span class="mxinfo " id="T83:U1268"><span class="mxinfo " id="T83:U1269"><span class="mxinfo " id="T45:U1270"><span class="var type1" id="S70T46U1861">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U1863">z</span>, <span class="var type1" id="S103T83U1864">pos</span>)</span> = <span class="mxinfo " id="T83:U1274"><span class="mxinfo " id="T45:U1275"><span class="var type1" id="S70T46U1867">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U1869">z</span>, <span class="var type1" id="S103T83U1870">pos</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,363" id="srcline363"> 363</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,364" id="srcline364"> 364</a></span><span class="line">                            <span class="mxinfo " id="T83:U1279"><span class="mxinfo " id="T83:U1280"><span class="mxinfo " id="T45:U1281"><span class="var type1" id="S70T46U1876">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U1878">z</span>, <span class="var type1" id="S103T83U1879">pos</span>)</span> = <span class="mxinfo " id="T1:U1285"><span class="mxinfo " id="T1:U1286">round(<span class="mxinfo " id="T1:U1287"><span class="mxinfo " id="T1:U1288">rand</span>*<span class="mxinfo " id="T1:U1289">499</span></span>)</span>+<span class="mxinfo " id="T1:U1290">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,365" id="srcline365"> 365</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,366" id="srcline366"> 366</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,367" id="srcline367"> 367</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,368" id="srcline368"> 368</a></span><span class="line">                <span class="comment">%                 catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,369" id="srcline369"> 369</a></span><span class="line">                <span class="comment">%                     rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,370" id="srcline370"> 370</a></span><span class="line">                <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,371" id="srcline371"> 371</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,372" id="srcline372"> 372</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,373" id="srcline373"> 373</a></span><span class="line">                <span class="comment">% a NEW Cancer appears DIRECTLY     %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,374" id="srcline374"> 374</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,375" id="srcline375"> 375</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,376" id="srcline376"> 376</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U1291"><span class="mxinfo " id="T1:U1292">rand</span> &lt; <span class="mxinfo " id="T1:U1293"><span class="mxinfo " id="T1:U1294"><span class="var type1" id="S53T42U1895">DirectCancerRate</span>(<span class="mxinfo " id="T1:U1296"><span class="var type1" id="S3T2U1897">Gender</span>(<span class="var type1" id="S94T1U1898">z</span>)</span>, <span class="var type1" id="S2T1U1899">y</span>)</span> * <span class="var type1" id="S54T1U1900">DirectCancerSpeed</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,377" id="srcline377"> 377</a></span><span class="line">                    <span class="comment">% this is cancer now. we need to write</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,378" id="srcline378"> 378</a></span><span class="line">                    <span class="comment">% everything into the cancer variable</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,379" id="srcline379"> 379</a></span><span class="line">                    <span class="mxinfo " id="T1:U1301"><span class="var type1" id="S105T1U1903">l2</span> = <span class="mxinfo " id="T1:U1303"><span class="mxinfo " id="T87:U1304">length(<span class="mxinfo " id="T87:U1305">find(<span class="mxinfo " id="T73:U1306"><span class="mxinfo " id="T47:U1307"><span class="var type1" id="S71T48U1911">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U1913">z</span>, <span class="mxinfo " id="T76:U1310">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U1311">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,380" id="srcline380"> 380</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U1312"><span class="var type1" id="S105T1U1919">l2</span>&lt;<span class="mxinfo " id="T1:U1314">25</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,381" id="srcline381"> 381</a></span><span class="line">                        <span class="mxinfo " id="T1:U1315"><span class="mxinfo " id="T1:U1316"><span class="mxinfo " id="T47:U1317"><span class="var type1" id="S71T48U1925">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U1927">z</span>, <span class="var type1" id="S105T1U1928">l2</span>)</span>         = <span class="mxinfo " id="T1:U1321">7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,382" id="srcline382"> 382</a></span><span class="line">                        <span class="mxinfo " id="T1:U1322"><span class="mxinfo " id="T1:U1323"><span class="mxinfo " id="T47:U1324"><span class="var type1" id="S71T48U1934">Ca</span>.CancerYear</span>(<span class="var type1" id="S94T1U1936">z</span>, <span class="var type1" id="S105T1U1937">l2</span>)</span>     = <span class="var type1" id="S96T1U1938">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,383" id="srcline383"> 383</a></span><span class="line">                        <span class="mxinfo " id="T1:U1329"><span class="mxinfo " id="T1:U1330"><span class="mxinfo " id="T47:U1331"><span class="var type1" id="S71T48U1943">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U1945">z</span>, <span class="var type1" id="S105T1U1946">l2</span>)</span> = <span class="mxinfo " id="T1:U1335"><span class="var type1" id="S50T39U1948">LocationMatrix</span>(<span class="mxinfo " id="T1:U1337">2</span>, <span class="mxinfo " id="T1:U1338"><span class="mxinfo " id="T1:U1339">round(<span class="mxinfo " id="T1:U1340"><span class="mxinfo " id="T1:U1341">rand</span>*<span class="mxinfo " id="T1:U1342">999</span></span>)</span>+<span class="mxinfo " id="T1:U1343">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,384" id="srcline384"> 384</a></span><span class="line">                        <span class="mxinfo " id="T1:U1344"><span class="mxinfo " id="T1:U1345"><span class="mxinfo " id="T47:U1346"><span class="var type1" id="S71T48U1962">Ca</span>.DwellTime</span>(<span class="var type1" id="S94T1U1964">z</span>,<span class="var type1" id="S105T1U1965">l2</span>)</span>       = <span class="mxinfo " id="T1:U1350">0</span></span>; <span class="comment">% POSSIBLY DELETE LATER</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,385" id="srcline385"> 385</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,386" id="srcline386"> 386</a></span><span class="line">                        <span class="comment">% a random number for stage and sojourn time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,387" id="srcline387"> 387</a></span><span class="line">                        <span class="mxinfo " id="T1:U1351"><span class="var type1" id="S106T1U1969">tmp1</span> = <span class="mxinfo " id="T1:U1353"><span class="var type1" id="S84T69U1971">StageMatrix</span>(<span class="mxinfo " id="T1:U1355">round(<span class="mxinfo " id="T1:U1356"><span class="mxinfo " id="T1:U1357"><span class="mxinfo " id="T1:U1358">rand</span>*<span class="mxinfo " id="T1:U1359">999</span></span>+<span class="mxinfo " id="T1:U1360">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,388" id="srcline388"> 388</a></span><span class="line">                        <span class="mxinfo " id="T1:U1361"><span class="var type1" id="S107T1U1982">tmp2</span> = <span class="mxinfo " id="T1:U1363"><span class="var type1" id="S86T74U1984">SojournMatrix</span>(<span class="mxinfo " id="T1:U1365">round(<span class="mxinfo " id="T1:U1366"><span class="mxinfo " id="T1:U1367"><span class="mxinfo " id="T1:U1368">rand</span>*<span class="mxinfo " id="T1:U1369">999</span></span>+<span class="mxinfo " id="T1:U1370">1</span></span>)</span>, <span class="mxinfo " id="T1:U1371"><span class="var type1" id="S106T1U1994">tmp1</span>-<span class="mxinfo " id="T1:U1373">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,389" id="srcline389"> 389</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,390" id="srcline390"> 390</a></span><span class="line">                        <span class="mxinfo " id="T1:U1374"><span class="mxinfo " id="T1:U1375"><span class="mxinfo " id="T47:U1376"><span class="var type1" id="S71T48U2000">Ca</span>.SympTime</span>(<span class="var type1" id="S94T1U2002">z</span>, <span class="var type1" id="S105T1U2003">l2</span>)</span>       = <span class="mxinfo " id="T1:U1380"><span class="var type1" id="S96T1U2005">time</span>+<span class="var type1" id="S107T1U2006">tmp2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,391" id="srcline391"> 391</a></span><span class="line">                        <span class="mxinfo " id="T1:U1383"><span class="mxinfo " id="T1:U1384"><span class="mxinfo " id="T47:U1385"><span class="var type1" id="S71T48U2011">Ca</span>.SympStage</span>(<span class="var type1" id="S94T1U2013">z</span>, <span class="var type1" id="S105T1U2014">l2</span>)</span>      = <span class="var type1" id="S106T1U2015">tmp1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,392" id="srcline392"> 392</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1390"><span class="var type1" id="S106T1U2019">tmp1</span> &gt; <span class="mxinfo " id="T1:U1392">7</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,393" id="srcline393"> 393</a></span><span class="line">                            <span class="mxinfo " id="T1:U1393"><span class="mxinfo " id="T1:U1394"><span class="mxinfo " id="T47:U1395"><span class="var type1" id="S71T48U2025">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U2027">z</span>, <span class="var type1" id="S105T1U2028">l2</span>)</span>    = <span class="mxinfo " id="T1:U1399"><span class="var type1" id="S96T1U2030">time</span> + <span class="mxinfo " id="T1:U1401"><span class="mxinfo " id="T1:U1402">round(<span class="mxinfo " id="T1:U1403"><span class="mxinfo " id="T1:U1404"><span class="var type1" id="S107T1U2036">tmp2</span>*<span class="mxinfo " id="T1:U1406"><span class="var type1" id="S51T40U2038">StageDuration</span>(<span class="mxinfo " id="T1:U1408"><span class="var type1" id="S106T1U2040">tmp1</span>-<span class="mxinfo " id="T1:U1410">6</span></span>, <span class="mxinfo " id="T1:U1411">1</span>)</span></span>*<span class="mxinfo " id="T1:U1412">4</span></span>)</span>/<span class="mxinfo " id="T1:U1413">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,394" id="srcline394"> 394</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,395" id="srcline395"> 395</a></span><span class="line">                            <span class="mxinfo " id="T1:U1414"><span class="mxinfo " id="T1:U1415"><span class="mxinfo " id="T47:U1416"><span class="var type1" id="S71T48U2050">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U2052">z</span>, <span class="var type1" id="S105T1U2053">l2</span>)</span>    = <span class="mxinfo " id="T1:U1420">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,396" id="srcline396"> 396</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,397" id="srcline397"> 397</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1421"><span class="var type1" id="S106T1U2058">tmp1</span> &gt; <span class="mxinfo " id="T1:U1423">8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,398" id="srcline398"> 398</a></span><span class="line">                            <span class="mxinfo " id="T1:U1424"><span class="mxinfo " id="T1:U1425"><span class="mxinfo " id="T47:U1426"><span class="var type1" id="S71T48U2064">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U2066">z</span>, <span class="var type1" id="S105T1U2067">l2</span>)</span>   = <span class="mxinfo " id="T1:U1430"><span class="var type1" id="S96T1U2069">time</span> + <span class="mxinfo " id="T1:U1432"><span class="mxinfo " id="T1:U1433">round(<span class="mxinfo " id="T1:U1434"><span class="mxinfo " id="T1:U1435"><span class="var type1" id="S107T1U2075">tmp2</span>*<span class="mxinfo " id="T1:U1437">sum(<span class="mxinfo " id="T88:U1438"><span class="var type1" id="S51T40U2079">StageDuration</span>(<span class="mxinfo " id="T1:U1440"><span class="var type1" id="S106T1U2081">tmp1</span>-<span class="mxinfo " id="T1:U1442">6</span></span>, <span class="mxinfo " id="T56:U1443">1:2</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U1444">4</span></span>)</span>/<span class="mxinfo " id="T1:U1445">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,399" id="srcline399"> 399</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,400" id="srcline400"> 400</a></span><span class="line">                            <span class="mxinfo " id="T1:U1446"><span class="mxinfo " id="T1:U1447"><span class="mxinfo " id="T47:U1448"><span class="var type1" id="S71T48U2093">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U2095">z</span>, <span class="var type1" id="S105T1U2096">l2</span>)</span>   = <span class="mxinfo " id="T1:U1452">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,401" id="srcline401"> 401</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,402" id="srcline402"> 402</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1453"><span class="var type1" id="S106T1U2101">tmp1</span> &gt; <span class="mxinfo " id="T1:U1455">9</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,403" id="srcline403"> 403</a></span><span class="line">                            <span class="mxinfo " id="T1:U1456"><span class="mxinfo " id="T1:U1457"><span class="mxinfo " id="T47:U1458"><span class="var type1" id="S71T48U2107">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U2109">z</span>, <span class="var type1" id="S105T1U2110">l2</span>)</span>  = <span class="mxinfo " id="T1:U1462"><span class="var type1" id="S96T1U2112">time</span> + <span class="mxinfo " id="T1:U1464"><span class="mxinfo " id="T1:U1465">round(<span class="mxinfo " id="T1:U1466"><span class="mxinfo " id="T1:U1467"><span class="var type1" id="S107T1U2118">tmp2</span>*<span class="mxinfo " id="T1:U1469">sum(<span class="mxinfo " id="T89:U1470"><span class="var type1" id="S51T40U2122">StageDuration</span>(<span class="mxinfo " id="T1:U1472"><span class="var type1" id="S106T1U2124">tmp1</span>-<span class="mxinfo " id="T1:U1474">6</span></span>, <span class="mxinfo " id="T90:U1475">1:3</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U1476">4</span></span>)</span>/<span class="mxinfo " id="T1:U1477">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,404" id="srcline404"> 404</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,405" id="srcline405"> 405</a></span><span class="line">                            <span class="mxinfo " id="T1:U1478"><span class="mxinfo " id="T1:U1479"><span class="mxinfo " id="T47:U1480"><span class="var type1" id="S71T48U2136">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U2138">z</span>, <span class="var type1" id="S105T1U2139">l2</span>)</span>  = <span class="mxinfo " id="T1:U1484">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,406" id="srcline406"> 406</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,407" id="srcline407"> 407</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,408" id="srcline408"> 408</a></span><span class="line">                        <span class="comment">% we keep track</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,409" id="srcline409"> 409</a></span><span class="line">                        <span class="mxinfo " id="T1:U1485"><span class="mxinfo " id="T1:U1486"><span class="var type1" id="S15T7U2144">DwellTimeProgression</span>(<span class="var type1" id="S2T1U2145">y</span>, <span class="mxinfo " id="T1:U1489"><span class="mxinfo " id="T91:U1490">length(<span class="mxinfo " id="T91:U1491">find(<span class="mxinfo " id="T92:U1492"><span class="var type1" id="S15T7U2152">DwellTimeProgression</span>(<span class="var type1" id="S2T1U2153">y</span>, <span class="mxinfo " id="T93:U1495">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U1496">1</span></span>)</span> = <span class="mxinfo " id="T1:U1497">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,410" id="srcline410"> 410</a></span><span class="line">                        <span class="mxinfo " id="T94:U1498"><span class="mxinfo " id="T94:U1499"><span class="var type1" id="S17T8U2160">HasCancer</span>(<span class="mxinfo " id="T95:U1501"><span class="var type1" id="S2T1U2162">y</span>:<span class="mxinfo " id="T1:U1503">100</span></span>, <span class="var type1" id="S94T1U2164">z</span>)</span> = <span class="mxinfo " id="T1:U1505">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,411" id="srcline411"> 411</a></span><span class="line">                        <span class="mxinfo " id="T1:U1506"><span class="mxinfo " id="T1:U1507"><span class="var type1" id="S10T5U2169">DirectCancer2</span>(<span class="var type1" id="S2T1U2170">y</span>)</span>  = <span class="mxinfo " id="T1:U1510"><span class="mxinfo " id="T1:U1511"><span class="var type1" id="S10T5U2173">DirectCancer2</span>(<span class="var type1" id="S2T1U2174">y</span>)</span> + <span class="mxinfo " id="T1:U1514">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,412" id="srcline412"> 412</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1515"><span class="mxinfo " id="T1:U1516"><span class="mxinfo " id="T47:U1517"><span class="var type1" id="S71T48U2181">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U2183">z</span>, <span class="var type1" id="S105T1U2184">l2</span>)</span> &lt; <span class="mxinfo " id="T1:U1521">4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,413" id="srcline413"> 413</a></span><span class="line">                            <span class="mxinfo " id="T1:U1522"><span class="mxinfo " id="T1:U1523"><span class="var type1" id="S11T5U2189">DirectCancer2R</span>(<span class="var type1" id="S2T1U2190">y</span>)</span> = <span class="mxinfo " id="T1:U1526"><span class="mxinfo " id="T1:U1527"><span class="var type1" id="S11T5U2193">DirectCancer2R</span>(<span class="var type1" id="S2T1U2194">y</span>)</span> +<span class="mxinfo " id="T1:U1530">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,414" id="srcline414"> 414</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,415" id="srcline415"> 415</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,416" id="srcline416"> 416</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,417" id="srcline417"> 417</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,418" id="srcline418"> 418</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,419" id="srcline419"> 419</a></span><span class="line">                <span class="comment">%      a polyp progresses           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,420" id="srcline420"> 420</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,421" id="srcline421"> 421</a></span><span class="line">                <span class="comment">%      try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,422" id="srcline422"> 422</a></span><span class="line">                <span class="mxinfo " id="T1:U1531"><span class="var type1" id="S101T1U2198">l</span> = <span class="mxinfo " id="T96:U1533">length(<span class="mxinfo " id="T96:U1534">find(<span class="mxinfo " id="T85:U1535"><span class="mxinfo " id="T45:U1536"><span class="var type1" id="S70T46U2205">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2207">z</span>, <span class="mxinfo " id="T86:U1539">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,423" id="srcline423"> 423</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S77T1U2211">f</span>=<span class="var type1" id="S101T1U2214">l</span>:<span class="mxinfo " id="T1:U1542">-1</span>:<span class="mxinfo " id="T1:U1543">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,424" id="srcline424"> 424</a></span><span class="line">                    <span class="mxinfo " id="T1:U1544"><span class="var type1" id="S108T1U2220">tmp</span> = <span class="mxinfo " id="T1:U1546"><span class="mxinfo " id="T1:U1547"><span class="mxinfo " id="T1:U1548"><span class="mxinfo " id="T1:U1549"><span class="var type1" id="S43T33U2225">AgeProgression</span>(<span class="mxinfo " id="T1:U1551"><span class="mxinfo " id="T45:U1552"><span class="var type1" id="S70T46U2228">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2230">z</span>, <span class="var type1" id="S77T1U2231">f</span>)</span>, <span class="var type1" id="S2T1U2232">y</span>)</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,425" id="srcline425"> 425</a></span><span class="line">                        * <span class="mxinfo " id="T1:U1557"><span class="var type1" id="S75T57U2234">LocationProgression</span>(<span class="mxinfo " id="T1:U1559"><span class="mxinfo " id="T45:U1560"><span class="var type1" id="S70T46U2237">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2239">z</span>,<span class="var type1" id="S77T1U2240">f</span>)</span>, <span class="mxinfo " id="T1:U1564"><span class="mxinfo " id="T45:U1565"><span class="var type1" id="S70T46U2243">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2245">z</span>, <span class="var type1" id="S77T1U2246">f</span>)</span>)</span></span><span class="keyword">...</span><span class="comment"> <span class="comment">% location influence</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,426" id="srcline426"> 426</a></span><span class="line">                        * <span class="mxinfo " id="T1:U1569"><span class="var type1" id="S74T51U2248">GenderProgression</span>(<span class="mxinfo " id="T1:U1571"><span class="mxinfo " id="T45:U1572"><span class="var type1" id="S70T46U2251">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2253">z</span>, <span class="var type1" id="S77T1U2254">f</span>)</span>, <span class="mxinfo " id="T1:U1576"><span class="var type1" id="S3T2U2256">Gender</span>(<span class="var type1" id="S94T1U2257">z</span>)</span>)</span></span><span class="keyword">...</span><span class="comment"> <span class="comment">% gender influence</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,427" id="srcline427"> 427</a></span><span class="line">                        * (<span class="mxinfo " id="T1:U1579"><span class="mxinfo " id="T1:U1580">(<span class="mxinfo " id="T28:U1581"><span class="mxinfo " id="T1:U1582"><span class="mxinfo " id="T45:U1583"><span class="var type1" id="S70T46U2265">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2267">z</span>, <span class="var type1" id="S77T1U2268">f</span>)</span>&lt;<span class="mxinfo " id="T1:U1587">5</span></span>) * <span class="mxinfo " id="T1:U1588"><span class="mxinfo " id="T36:U1589"><span class="var type1" id="S47T35U2272">RiskDistribution</span>.EarlyRisk</span>(<span class="mxinfo " id="T1:U1591"><span class="mxinfo " id="T45:U1592"><span class="var type1" id="S70T46U2276">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U2278">z</span>, <span class="var type1" id="S77T1U2279">f</span>)</span>)</span></span> +<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,428" id="srcline428"> 428</a></span><span class="line">                        <span class="mxinfo " id="T1:U1596">( <span class="mxinfo " id="T28:U1597"><span class="mxinfo " id="T1:U1598"><span class="mxinfo " id="T45:U1599"><span class="var type1" id="S70T46U2285">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2287">z</span>, <span class="var type1" id="S77T1U2288">f</span>)</span>&gt;<span class="mxinfo " id="T1:U1603">4</span></span>) * <span class="mxinfo " id="T1:U1604"><span class="mxinfo " id="T36:U1605"><span class="var type1" id="S47T35U2292">RiskDistribution</span>.AdvancedRisk</span>(<span class="mxinfo " id="T1:U1607"><span class="mxinfo " id="T45:U1608"><span class="var type1" id="S70T46U2296">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U2298">z</span>, <span class="var type1" id="S77T1U2299">f</span>)</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,429" id="srcline429"> 429</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,430" id="srcline430"> 430</a></span><span class="line"><span class="comment">%                     switch DwellSpeed  %m2 moved the switch statement up. otherwise without cancer m remains 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,431" id="srcline431"> 431</a></span><span class="line"><span class="comment">%                         case 'Slow'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,432" id="srcline432"> 432</a></span><span class="line"><span class="comment">%                             tmp2 = StageVariables.FastCancer(Polyp.Polyps(z, f))<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,433" id="srcline433"> 433</a></span><span class="line"><span class="comment">%                                 * AgeProgression(6, y)<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,434" id="srcline434"> 434</a></span><span class="line"><span class="comment">%                                 * LocationProgression(6, Polyp.PolypLocation(z, f))<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,435" id="srcline435"> 435</a></span><span class="line"><span class="comment">%                                 * GenderProgression(6, Gender(z));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,436" id="srcline436"> 436</a></span><span class="line"><span class="comment">%                         case 'Fast'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,437" id="srcline437"> 437</a></span><span class="line"><span class="comment">%                             tmp2 = StageVariables.FastCancer(Polyp.Polyps(z, f))<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,438" id="srcline438"> 438</a></span><span class="line"><span class="comment">%                                 * AgeProgression(6, y)<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,439" id="srcline439"> 439</a></span><span class="line"><span class="comment">%                                 * LocationProgression(6, Polyp.PolypLocation(z, f))<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,440" id="srcline440"> 440</a></span><span class="line"><span class="comment">%                                 * GenderProgression(6, Gender(z));       </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,441" id="srcline441"> 441</a></span><span class="line"><span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,442" id="srcline442"> 442</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,443" id="srcline443"> 443</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U1612"><span class="mxinfo " id="T1:U1613">rand</span> &lt; <span class="var type1" id="S108T1U2305">tmp</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,444" id="srcline444"> 444</a></span><span class="line">                        <span class="mxinfo " id="T1:U1615"><span class="mxinfo " id="T1:U1616"><span class="mxinfo " id="T45:U1617"><span class="var type1" id="S70T46U2310">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2312">z</span>, <span class="var type1" id="S77T1U2313">f</span>)</span> = <span class="mxinfo " id="T1:U1621"><span class="mxinfo " id="T1:U1622"><span class="mxinfo " id="T45:U1623"><span class="var type1" id="S70T46U2317">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2319">z</span>, <span class="var type1" id="S77T1U2320">f</span>)</span>+<span class="mxinfo " id="T1:U1627">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,445" id="srcline445"> 445</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U1628"><span class="mxinfo " id="T1:U1629"><span class="mxinfo " id="T45:U1630"><span class="var type1" id="S70T46U2327">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2329">z</span>, <span class="var type1" id="S77T1U2330">f</span>)</span> &gt; <span class="mxinfo " id="T1:U1634">6</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,446" id="srcline446"> 446</a></span><span class="line">                            <span class="comment">% this is cancer now. we need to write</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,447" id="srcline447"> 447</a></span><span class="line">                            <span class="comment">% everything into the cancer variable</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,448" id="srcline448"> 448</a></span><span class="line">                            <span class="mxinfo " id="T1:U1635"><span class="var type1" id="S105T1U2334">l2</span> = <span class="mxinfo " id="T1:U1637"><span class="mxinfo " id="T87:U1638">length(<span class="mxinfo " id="T87:U1639">find(<span class="mxinfo " id="T73:U1640"><span class="mxinfo " id="T47:U1641"><span class="var type1" id="S71T48U2342">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U2344">z</span>, <span class="mxinfo " id="T76:U1644">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U1645">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,449" id="srcline449"> 449</a></span><span class="line">                            <span class="mxinfo " id="T1:U1646"><span class="mxinfo " id="T1:U1647"><span class="mxinfo " id="T47:U1648"><span class="var type1" id="S71T48U2351">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U2353">z</span>, <span class="var type1" id="S105T1U2354">l2</span>)</span>         = <span class="mxinfo " id="T1:U1652">7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,450" id="srcline450"> 450</a></span><span class="line">                            <span class="mxinfo " id="T1:U1653"><span class="mxinfo " id="T1:U1654"><span class="mxinfo " id="T47:U1655"><span class="var type1" id="S71T48U2360">Ca</span>.CancerYear</span>(<span class="var type1" id="S94T1U2362">z</span>, <span class="var type1" id="S105T1U2363">l2</span>)</span>     = <span class="var type1" id="S96T1U2364">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,451" id="srcline451"> 451</a></span><span class="line">                            <span class="mxinfo " id="T1:U1660"><span class="mxinfo " id="T1:U1661"><span class="mxinfo " id="T47:U1662"><span class="var type1" id="S71T48U2369">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U2371">z</span>, <span class="var type1" id="S105T1U2372">l2</span>)</span> = <span class="mxinfo " id="T1:U1666"><span class="mxinfo " id="T45:U1667"><span class="var type1" id="S70T46U2375">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2377">z</span>, <span class="var type1" id="S77T1U2378">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,452" id="srcline452"> 452</a></span><span class="line">                            <span class="mxinfo " id="T1:U1671"><span class="mxinfo " id="T1:U1672"><span class="mxinfo " id="T47:U1673"><span class="var type1" id="S71T48U2383">Ca</span>.DwellTime</span>(<span class="var type1" id="S94T1U2385">z</span>,<span class="var type1" id="S105T1U2386">l2</span>)</span> = <span class="mxinfo " id="T1:U1677"><span class="var type1" id="S96T1U2388">time</span> - <span class="mxinfo " id="T1:U1679"><span class="mxinfo " id="T45:U1680"><span class="var type1" id="S70T46U2391">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U2393">z</span>, <span class="var type1" id="S77T1U2394">f</span>)</span></span></span>; <span class="comment">% POSSIBLY DELETE LATER</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,453" id="srcline453"> 453</a></span><span class="line">                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,454" id="srcline454"> 454</a></span><span class="line">                            <span class="comment">% a random number for stage and sojourn time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,455" id="srcline455"> 455</a></span><span class="line">                            <span class="mxinfo " id="T1:U1684"><span class="var type1" id="S106T1U2397">tmp1</span> = <span class="mxinfo " id="T1:U1686"><span class="var type1" id="S84T69U2399">StageMatrix</span>(<span class="mxinfo " id="T1:U1688">round(<span class="mxinfo " id="T1:U1689"><span class="mxinfo " id="T1:U1690"><span class="mxinfo " id="T1:U1691">rand</span>*<span class="mxinfo " id="T1:U1692">999</span></span>+<span class="mxinfo " id="T1:U1693">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,456" id="srcline456"> 456</a></span><span class="line">                            <span class="mxinfo " id="T1:U1694"><span class="var type1" id="S107T1U2410">tmp2</span> = <span class="mxinfo " id="T1:U1696"><span class="var type1" id="S86T74U2412">SojournMatrix</span>(<span class="mxinfo " id="T1:U1698">round(<span class="mxinfo " id="T1:U1699"><span class="mxinfo " id="T1:U1700"><span class="mxinfo " id="T1:U1701">rand</span>*<span class="mxinfo " id="T1:U1702">999</span></span>+<span class="mxinfo " id="T1:U1703">1</span></span>)</span>, <span class="mxinfo " id="T1:U1704"><span class="var type1" id="S106T1U2422">tmp1</span>-<span class="mxinfo " id="T1:U1706">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,457" id="srcline457"> 457</a></span><span class="line">                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,458" id="srcline458"> 458</a></span><span class="line">                            <span class="mxinfo " id="T1:U1707"><span class="mxinfo " id="T1:U1708"><span class="mxinfo " id="T47:U1709"><span class="var type1" id="S71T48U2428">Ca</span>.SympTime</span>(<span class="var type1" id="S94T1U2430">z</span>, <span class="var type1" id="S105T1U2431">l2</span>)</span>       = <span class="mxinfo " id="T1:U1713"><span class="var type1" id="S96T1U2433">time</span>+<span class="var type1" id="S107T1U2434">tmp2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,459" id="srcline459"> 459</a></span><span class="line">                            <span class="mxinfo " id="T1:U1716"><span class="mxinfo " id="T1:U1717"><span class="mxinfo " id="T47:U1718"><span class="var type1" id="S71T48U2439">Ca</span>.SympStage</span>(<span class="var type1" id="S94T1U2441">z</span>, <span class="var type1" id="S105T1U2442">l2</span>)</span>      = <span class="var type1" id="S106T1U2443">tmp1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,460" id="srcline460"> 460</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1723"><span class="var type1" id="S106T1U2447">tmp1</span> &gt; <span class="mxinfo " id="T1:U1725">7</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,461" id="srcline461"> 461</a></span><span class="line">                                <span class="mxinfo " id="T1:U1726"><span class="mxinfo " id="T1:U1727"><span class="mxinfo " id="T47:U1728"><span class="var type1" id="S71T48U2453">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U2455">z</span>, <span class="var type1" id="S105T1U2456">l2</span>)</span>    = <span class="mxinfo " id="T1:U1732"><span class="var type1" id="S96T1U2458">time</span> + <span class="mxinfo " id="T1:U1734"><span class="mxinfo " id="T1:U1735">round(<span class="mxinfo " id="T1:U1736"><span class="mxinfo " id="T1:U1737"><span class="var type1" id="S107T1U2464">tmp2</span>*<span class="mxinfo " id="T1:U1739"><span class="var type1" id="S51T40U2466">StageDuration</span>(<span class="mxinfo " id="T1:U1741"><span class="var type1" id="S106T1U2468">tmp1</span>-<span class="mxinfo " id="T1:U1743">6</span></span>, <span class="mxinfo " id="T1:U1744">1</span>)</span></span>*<span class="mxinfo " id="T1:U1745">4</span></span>)</span>/<span class="mxinfo " id="T1:U1746">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,462" id="srcline462"> 462</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,463" id="srcline463"> 463</a></span><span class="line">                                <span class="mxinfo " id="T1:U1747"><span class="mxinfo " id="T1:U1748"><span class="mxinfo " id="T47:U1749"><span class="var type1" id="S71T48U2478">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U2480">z</span>, <span class="var type1" id="S105T1U2481">l2</span>)</span>    = <span class="mxinfo " id="T1:U1753">1000</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,464" id="srcline464"> 464</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,465" id="srcline465"> 465</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1754"><span class="var type1" id="S106T1U2486">tmp1</span> &gt; <span class="mxinfo " id="T1:U1756">8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,466" id="srcline466"> 466</a></span><span class="line">                                <span class="mxinfo " id="T1:U1757"><span class="mxinfo " id="T1:U1758"><span class="mxinfo " id="T47:U1759"><span class="var type1" id="S71T48U2492">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U2494">z</span>, <span class="var type1" id="S105T1U2495">l2</span>)</span>   = <span class="mxinfo " id="T1:U1763"><span class="var type1" id="S96T1U2497">time</span> + <span class="mxinfo " id="T1:U1765"><span class="mxinfo " id="T1:U1766">round(<span class="mxinfo " id="T1:U1767"><span class="mxinfo " id="T1:U1768"><span class="var type1" id="S107T1U2503">tmp2</span>*<span class="mxinfo " id="T1:U1770">sum(<span class="mxinfo " id="T88:U1771"><span class="var type1" id="S51T40U2507">StageDuration</span>(<span class="mxinfo " id="T1:U1773"><span class="var type1" id="S106T1U2509">tmp1</span>-<span class="mxinfo " id="T1:U1775">6</span></span>, <span class="mxinfo " id="T56:U1776">1:2</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U1777">4</span></span>)</span>/<span class="mxinfo " id="T1:U1778">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,467" id="srcline467"> 467</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,468" id="srcline468"> 468</a></span><span class="line">                                <span class="mxinfo " id="T1:U1779"><span class="mxinfo " id="T1:U1780"><span class="mxinfo " id="T47:U1781"><span class="var type1" id="S71T48U2521">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U2523">z</span>, <span class="var type1" id="S105T1U2524">l2</span>)</span>   = <span class="mxinfo " id="T1:U1785">1000</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,469" id="srcline469"> 469</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,470" id="srcline470"> 470</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1786"><span class="var type1" id="S106T1U2529">tmp1</span> &gt; <span class="mxinfo " id="T1:U1788">9</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,471" id="srcline471"> 471</a></span><span class="line">                                <span class="mxinfo " id="T1:U1789"><span class="mxinfo " id="T1:U1790"><span class="mxinfo " id="T47:U1791"><span class="var type1" id="S71T48U2535">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U2537">z</span>, <span class="var type1" id="S105T1U2538">l2</span>)</span>  = <span class="mxinfo " id="T1:U1795"><span class="var type1" id="S96T1U2540">time</span> + <span class="mxinfo " id="T1:U1797"><span class="mxinfo " id="T1:U1798">round(<span class="mxinfo " id="T1:U1799"><span class="mxinfo " id="T1:U1800"><span class="var type1" id="S107T1U2546">tmp2</span>*<span class="mxinfo " id="T1:U1802">sum(<span class="mxinfo " id="T89:U1803"><span class="var type1" id="S51T40U2550">StageDuration</span>(<span class="mxinfo " id="T1:U1805"><span class="var type1" id="S106T1U2552">tmp1</span>-<span class="mxinfo " id="T1:U1807">6</span></span>, <span class="mxinfo " id="T90:U1808">1:3</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U1809">4</span></span>)</span>/<span class="mxinfo " id="T1:U1810">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,472" id="srcline472"> 472</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,473" id="srcline473"> 473</a></span><span class="line">                                <span class="mxinfo " id="T1:U1811"><span class="mxinfo " id="T1:U1812"><span class="mxinfo " id="T47:U1813"><span class="var type1" id="S71T48U2564">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U2566">z</span>, <span class="var type1" id="S105T1U2567">l2</span>)</span>  = <span class="mxinfo " id="T1:U1817">1000</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,474" id="srcline474"> 474</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,475" id="srcline475"> 475</a></span><span class="line">                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,476" id="srcline476"> 476</a></span><span class="line">                            <span class="comment">% we keep track</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,477" id="srcline477"> 477</a></span><span class="line">                            <span class="mxinfo " id="T1:U1818"><span class="mxinfo " id="T1:U1819"><span class="var type1" id="S15T7U2572">DwellTimeProgression</span>(<span class="var type1" id="S2T1U2573">y</span>, <span class="mxinfo " id="T1:U1822"><span class="mxinfo " id="T91:U1823">length(<span class="mxinfo " id="T91:U1824">find(<span class="mxinfo " id="T92:U1825"><span class="var type1" id="S15T7U2580">DwellTimeProgression</span>(<span class="var type1" id="S2T1U2581">y</span>, <span class="mxinfo " id="T93:U1828">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U1829">1</span></span>)</span> =<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,478" id="srcline478"> 478</a></span><span class="line">                                <span class="mxinfo " id="T1:U1830"><span class="var type1" id="S96T1U2585">time</span> - <span class="mxinfo " id="T1:U1832"><span class="mxinfo " id="T45:U1833"><span class="var type1" id="S70T46U2588">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U2590">z</span>, <span class="var type1" id="S77T1U2591">f</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,479" id="srcline479"> 479</a></span><span class="line">                            <span class="mxinfo " id="T94:U1837"><span class="mxinfo " id="T94:U1838"><span class="var type1" id="S17T8U2595">HasCancer</span>(<span class="mxinfo " id="T95:U1840"><span class="var type1" id="S2T1U2597">y</span>:<span class="mxinfo " id="T1:U1842">100</span></span>, <span class="var type1" id="S94T1U2599">z</span>)</span> = <span class="mxinfo " id="T1:U1844">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,480" id="srcline480"> 480</a></span><span class="line">                            <span class="mxinfo " id="T1:U1845"><span class="mxinfo " id="T1:U1846"><span class="var type1" id="S12T5U2604">ProgressedCancer</span>(<span class="var type1" id="S2T1U2605">y</span>)</span> = <span class="mxinfo " id="T1:U1849"><span class="mxinfo " id="T1:U1850"><span class="var type1" id="S12T5U2608">ProgressedCancer</span>(<span class="var type1" id="S2T1U2609">y</span>)</span> + <span class="mxinfo " id="T1:U1853">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,481" id="srcline481"> 481</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U1854"><span class="mxinfo " id="T1:U1855"><span class="mxinfo " id="T47:U1856"><span class="var type1" id="S71T48U2616">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U2618">z</span>, <span class="var type1" id="S105T1U2619">l2</span>)</span>&lt;<span class="mxinfo " id="T1:U1860">4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,482" id="srcline482"> 482</a></span><span class="line">                                <span class="mxinfo " id="T1:U1861"><span class="mxinfo " id="T1:U1862"><span class="var type1" id="S13T5U2624">ProgressedCancerR</span>(<span class="var type1" id="S2T1U2625">y</span>)</span> = <span class="mxinfo " id="T1:U1865"><span class="mxinfo " id="T1:U1866"><span class="var type1" id="S13T5U2628">ProgressedCancerR</span>(<span class="var type1" id="S2T1U2629">y</span>)</span> + <span class="mxinfo " id="T1:U1869">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,483" id="srcline483"> 483</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,484" id="srcline484"> 484</a></span><span class="line">                            <span class="comment">% and we delete the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,485" id="srcline485"> 485</a></span><span class="line">                            <span class="mxinfo " id="T96:U1870"><span class="mxinfo " id="T96:U1871"><span class="mxinfo " id="T45:U1872"><span class="var type1" id="S70T46U2635">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2637">z</span>, <span class="mxinfo " id="T97:U1875"><span class="var type1" id="S77T1U2639">f</span>:<span class="var type1" id="S101T1U2640">l</span></span>)</span>           = <span class="mxinfo " id="T96:U1878"><span class="mxinfo " id="T45:U1879"><span class="var type1" id="S70T46U2643">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2645">z</span>, <span class="mxinfo " id="T97:U1882"><span class="mxinfo " id="T1:U1883"><span class="var type1" id="S77T1U2648">f</span>+<span class="mxinfo " id="T1:U1885">1</span></span>:<span class="mxinfo " id="T1:U1886"><span class="var type1" id="S101T1U2651">l</span>+<span class="mxinfo " id="T1:U1888">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,486" id="srcline486"> 486</a></span><span class="line">                            <span class="mxinfo " id="T96:U1889"><span class="mxinfo " id="T96:U1890"><span class="mxinfo " id="T45:U1891"><span class="var type1" id="S70T46U2657">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U2659">z</span>, <span class="mxinfo " id="T97:U1894"><span class="var type1" id="S77T1U2661">f</span>:<span class="var type1" id="S101T1U2662">l</span></span>)</span>        = <span class="mxinfo " id="T96:U1897"><span class="mxinfo " id="T45:U1898"><span class="var type1" id="S70T46U2665">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U2667">z</span>, <span class="mxinfo " id="T97:U1901"><span class="mxinfo " id="T1:U1902"><span class="var type1" id="S77T1U2670">f</span>+<span class="mxinfo " id="T1:U1904">1</span></span>:<span class="mxinfo " id="T1:U1905"><span class="var type1" id="S101T1U2673">l</span>+<span class="mxinfo " id="T1:U1907">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,487" id="srcline487"> 487</a></span><span class="line">                            <span class="mxinfo " id="T96:U1908"><span class="mxinfo " id="T96:U1909"><span class="mxinfo " id="T45:U1910"><span class="var type1" id="S70T46U2679">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2681">z</span>, <span class="mxinfo " id="T97:U1913"><span class="var type1" id="S77T1U2683">f</span>:<span class="var type1" id="S101T1U2684">l</span></span>)</span>    = <span class="mxinfo " id="T96:U1916"><span class="mxinfo " id="T45:U1917"><span class="var type1" id="S70T46U2687">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2689">z</span>, <span class="mxinfo " id="T97:U1920"><span class="mxinfo " id="T1:U1921"><span class="var type1" id="S77T1U2692">f</span>+<span class="mxinfo " id="T1:U1923">1</span></span>:<span class="mxinfo " id="T1:U1924"><span class="var type1" id="S101T1U2695">l</span>+<span class="mxinfo " id="T1:U1926">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,488" id="srcline488"> 488</a></span><span class="line">                            <span class="mxinfo " id="T96:U1927"><span class="mxinfo " id="T96:U1928"><span class="mxinfo " id="T45:U1929"><span class="var type1" id="S70T46U2701">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U2703">z</span>, <span class="mxinfo " id="T97:U1932"><span class="var type1" id="S77T1U2705">f</span>:<span class="var type1" id="S101T1U2706">l</span></span>)</span> = <span class="mxinfo " id="T96:U1935"><span class="mxinfo " id="T45:U1936"><span class="var type1" id="S70T46U2709">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U2711">z</span>, <span class="mxinfo " id="T97:U1939"><span class="mxinfo " id="T1:U1940"><span class="var type1" id="S77T1U2714">f</span>+<span class="mxinfo " id="T1:U1942">1</span></span>:<span class="mxinfo " id="T1:U1943"><span class="var type1" id="S101T1U2717">l</span>+<span class="mxinfo " id="T1:U1945">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,489" id="srcline489"> 489</a></span><span class="line">                            <span class="mxinfo " id="T96:U1946"><span class="mxinfo " id="T96:U1947"><span class="mxinfo " id="T45:U1948"><span class="var type1" id="S70T46U2723">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U2725">z</span>, <span class="mxinfo " id="T97:U1951"><span class="var type1" id="S77T1U2727">f</span>:<span class="var type1" id="S101T1U2728">l</span></span>)</span>   = <span class="mxinfo " id="T96:U1954"><span class="mxinfo " id="T45:U1955"><span class="var type1" id="S70T46U2731">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U2733">z</span>, <span class="mxinfo " id="T97:U1958"><span class="mxinfo " id="T1:U1959"><span class="var type1" id="S77T1U2736">f</span>+<span class="mxinfo " id="T1:U1961">1</span></span>:<span class="mxinfo " id="T1:U1962"><span class="var type1" id="S101T1U2739">l</span>+<span class="mxinfo " id="T1:U1964">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,490" id="srcline490"> 490</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,491" id="srcline491"> 491</a></span><span class="line">                    <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U1965"><span class="mxinfo " id="T1:U1966">rand</span> &lt; <span class="mxinfo " id="T1:U1967"><span class="mxinfo " id="T1:U1968">(<span class="mxinfo " id="T28:U1969">strcmp(<span class="var type1" id="S55T43U2750">DwellSpeed</span>,<span class="string">'Slow'</span>)</span>)*(<span class="mxinfo " id="T1:U1971"><span class="mxinfo " id="T1:U1972"><span class="mxinfo " id="T1:U1973"><span class="mxinfo " id="T1:U1974"><span class="mxinfo " id="T20:U1975"><span class="var type1" id="S32T19U2758">StageVariables</span>.FastCancer</span>(<span class="mxinfo " id="T1:U1977"><span class="mxinfo " id="T45:U1978"><span class="var type1" id="S70T46U2762">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2764">z</span>, <span class="var type1" id="S77T1U2765">f</span>)</span>)</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,492" id="srcline492"> 492</a></span><span class="line">                        * <span class="mxinfo " id="T1:U1982"><span class="var type1" id="S43T33U2767">AgeProgression</span>(<span class="mxinfo " id="T1:U1984">6</span>, <span class="var type1" id="S2T1U2769">y</span>)</span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,493" id="srcline493"> 493</a></span><span class="line">                        * <span class="mxinfo " id="T1:U1986"><span class="var type1" id="S75T57U2771">LocationProgression</span>(<span class="mxinfo " id="T1:U1988">6</span>, <span class="mxinfo " id="T1:U1989"><span class="mxinfo " id="T45:U1990"><span class="var type1" id="S70T46U2775">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2777">z</span>, <span class="var type1" id="S77T1U2778">f</span>)</span>)</span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,494" id="srcline494"> 494</a></span><span class="line">                        * <span class="mxinfo " id="T1:U1994"><span class="var type1" id="S74T51U2780">GenderProgression</span>(<span class="mxinfo " id="T1:U1996">6</span>, <span class="mxinfo " id="T1:U1997"><span class="var type1" id="S3T2U2783">Gender</span>(<span class="var type1" id="S94T1U2784">z</span>)</span>)</span></span>)</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,495" id="srcline495"> 495</a></span><span class="line">                        + <span class="mxinfo " id="T1:U2000"><span class="mxinfo " id="T1:U2001">(<span class="mxinfo " id="T28:U2002">strcmp(<span class="var type1" id="S55T43U2790">DwellSpeed</span>,<span class="string">'Fast'</span>)</span>)*(<span class="mxinfo " id="T1:U2004"><span class="mxinfo " id="T1:U2005"><span class="mxinfo " id="T1:U2006"><span class="mxinfo " id="T1:U2007"><span class="mxinfo " id="T20:U2008"><span class="var type1" id="S32T19U2798">StageVariables</span>.FastCancer</span>(<span class="mxinfo " id="T1:U2010"><span class="mxinfo " id="T45:U2011"><span class="var type1" id="S70T46U2802">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2804">z</span>, <span class="var type1" id="S77T1U2805">f</span>)</span>)</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,496" id="srcline496"> 496</a></span><span class="line">                        * <span class="mxinfo " id="T1:U2015"><span class="var type1" id="S43T33U2807">AgeProgression</span>(<span class="mxinfo " id="T1:U2017">6</span>, <span class="var type1" id="S2T1U2809">y</span>)</span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,497" id="srcline497"> 497</a></span><span class="line">                        * <span class="mxinfo " id="T1:U2019"><span class="var type1" id="S75T57U2811">LocationProgression</span>(<span class="mxinfo " id="T1:U2021">6</span>, <span class="mxinfo " id="T1:U2022"><span class="mxinfo " id="T45:U2023"><span class="var type1" id="S70T46U2815">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2817">z</span>, <span class="var type1" id="S77T1U2818">f</span>)</span>)</span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,498" id="srcline498"> 498</a></span><span class="line">                        * <span class="mxinfo " id="T1:U2027"><span class="var type1" id="S74T51U2820">GenderProgression</span>(<span class="mxinfo " id="T1:U2029">6</span>, <span class="mxinfo " id="T1:U2030"><span class="var type1" id="S3T2U2823">Gender</span>(<span class="var type1" id="S94T1U2824">z</span>)</span>)</span></span>)</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,499" id="srcline499"> 499</a></span><span class="line">                        * (<span class="mxinfo " id="T1:U2033"><span class="mxinfo " id="T1:U2034">(<span class="mxinfo " id="T28:U2035"><span class="mxinfo " id="T1:U2036"><span class="mxinfo " id="T45:U2037"><span class="var type1" id="S70T46U2832">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2834">z</span>, <span class="var type1" id="S77T1U2835">f</span>)</span>&lt;<span class="mxinfo " id="T1:U2041">5</span></span>) * <span class="mxinfo " id="T1:U2042"><span class="mxinfo " id="T36:U2043"><span class="var type1" id="S47T35U2839">RiskDistribution</span>.EarlyRisk</span>(<span class="mxinfo " id="T1:U2045"><span class="mxinfo " id="T45:U2046"><span class="var type1" id="S70T46U2843">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U2845">z</span>, <span class="var type1" id="S77T1U2846">f</span>)</span>)</span></span> +<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,500" id="srcline500"> 500</a></span><span class="line">                          <span class="mxinfo " id="T1:U2050">( <span class="mxinfo " id="T28:U2051"><span class="mxinfo " id="T1:U2052"><span class="mxinfo " id="T45:U2053"><span class="var type1" id="S70T46U2852">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U2854">z</span>, <span class="var type1" id="S77T1U2855">f</span>)</span>&gt;<span class="mxinfo " id="T1:U2057">4</span></span>) * <span class="mxinfo " id="T1:U2058"><span class="mxinfo " id="T36:U2059"><span class="var type1" id="S47T35U2859">RiskDistribution</span>.AdvancedRisk</span>(<span class="mxinfo " id="T1:U2061"><span class="mxinfo " id="T45:U2062"><span class="var type1" id="S70T46U2863">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U2865">z</span>, <span class="var type1" id="S77T1U2866">f</span>)</span>)</span></span></span>)</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,501" id="srcline501"> 501</a></span><span class="line">         </span></span>
<span class="srcline"><span class="lineno"><a href="1,502" id="srcline502"> 502</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,503" id="srcline503"> 503</a></span><span class="line">                        <span class="comment">% this is fast progressed cancer now. we need to write</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,504" id="srcline504"> 504</a></span><span class="line">                        <span class="comment">% everything into the cancer variable</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,505" id="srcline505"> 505</a></span><span class="line">                        <span class="mxinfo " id="T1:U2066"><span class="var type1" id="S105T1U2869">l2</span> = <span class="mxinfo " id="T1:U2068"><span class="mxinfo " id="T87:U2069">length(<span class="mxinfo " id="T87:U2070">find(<span class="mxinfo " id="T73:U2071"><span class="mxinfo " id="T47:U2072"><span class="var type1" id="S71T48U2877">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U2879">z</span>, <span class="mxinfo " id="T76:U2075">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U2076">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,506" id="srcline506"> 506</a></span><span class="line">                        <span class="mxinfo " id="T1:U2077"><span class="mxinfo " id="T1:U2078"><span class="mxinfo " id="T47:U2079"><span class="var type1" id="S71T48U2886">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U2888">z</span>, <span class="var type1" id="S105T1U2889">l2</span>)</span>         = <span class="mxinfo " id="T1:U2083">7</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,507" id="srcline507"> 507</a></span><span class="line">                        <span class="mxinfo " id="T1:U2084"><span class="mxinfo " id="T1:U2085"><span class="mxinfo " id="T47:U2086"><span class="var type1" id="S71T48U2895">Ca</span>.CancerYear</span>(<span class="var type1" id="S94T1U2897">z</span>, <span class="var type1" id="S105T1U2898">l2</span>)</span>     = <span class="var type1" id="S96T1U2899">time</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,508" id="srcline508"> 508</a></span><span class="line">                        <span class="mxinfo " id="T1:U2091"><span class="mxinfo " id="T1:U2092"><span class="mxinfo " id="T47:U2093"><span class="var type1" id="S71T48U2904">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U2906">z</span>, <span class="var type1" id="S105T1U2907">l2</span>)</span> = <span class="mxinfo " id="T1:U2097"><span class="mxinfo " id="T45:U2098"><span class="var type1" id="S70T46U2910">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U2912">z</span>, <span class="var type1" id="S77T1U2913">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,509" id="srcline509"> 509</a></span><span class="line">                        <span class="mxinfo " id="T1:U2102"><span class="mxinfo " id="T1:U2103"><span class="mxinfo " id="T47:U2104"><span class="var type1" id="S71T48U2918">Ca</span>.DwellTime</span>(<span class="var type1" id="S94T1U2920">z</span>,<span class="var type1" id="S105T1U2921">l2</span>)</span> = <span class="mxinfo " id="T1:U2108"><span class="var type1" id="S96T1U2923">time</span> - <span class="mxinfo " id="T1:U2110"><span class="mxinfo " id="T45:U2111"><span class="var type1" id="S70T46U2926">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U2928">z</span>, <span class="var type1" id="S77T1U2929">f</span>)</span></span></span>; <span class="comment">% POSSIBLY DELETE LATER</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,510" id="srcline510"> 510</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,511" id="srcline511"> 511</a></span><span class="line">                        <span class="comment">% a random number for stage and sojourn time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,512" id="srcline512"> 512</a></span><span class="line">                        <span class="mxinfo " id="T1:U2115"><span class="var type1" id="S106T1U2932">tmp1</span> = <span class="mxinfo " id="T1:U2117"><span class="var type1" id="S84T69U2934">StageMatrix</span>(<span class="mxinfo " id="T1:U2119">round(<span class="mxinfo " id="T1:U2120"><span class="mxinfo " id="T1:U2121"><span class="mxinfo " id="T1:U2122">rand</span>*<span class="mxinfo " id="T1:U2123">999</span></span>+<span class="mxinfo " id="T1:U2124">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,513" id="srcline513"> 513</a></span><span class="line">                        <span class="mxinfo " id="T1:U2125"><span class="var type1" id="S107T1U2945">tmp2</span> = <span class="mxinfo " id="T1:U2127"><span class="var type1" id="S86T74U2947">SojournMatrix</span>(<span class="mxinfo " id="T1:U2129">round(<span class="mxinfo " id="T1:U2130"><span class="mxinfo " id="T1:U2131"><span class="mxinfo " id="T1:U2132">rand</span>*<span class="mxinfo " id="T1:U2133">999</span></span>+<span class="mxinfo " id="T1:U2134">1</span></span>)</span>, <span class="mxinfo " id="T1:U2135"><span class="var type1" id="S106T1U2957">tmp1</span>-<span class="mxinfo " id="T1:U2137">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,514" id="srcline514"> 514</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,515" id="srcline515"> 515</a></span><span class="line">                        <span class="mxinfo " id="T1:U2138"><span class="mxinfo " id="T1:U2139"><span class="mxinfo " id="T47:U2140"><span class="var type1" id="S71T48U2963">Ca</span>.SympTime</span>(<span class="var type1" id="S94T1U2965">z</span>, <span class="var type1" id="S105T1U2966">l2</span>)</span>       = <span class="mxinfo " id="T1:U2144"><span class="var type1" id="S96T1U2968">time</span>+<span class="var type1" id="S107T1U2969">tmp2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,516" id="srcline516"> 516</a></span><span class="line">                        <span class="mxinfo " id="T1:U2147"><span class="mxinfo " id="T1:U2148"><span class="mxinfo " id="T47:U2149"><span class="var type1" id="S71T48U2974">Ca</span>.SympStage</span>(<span class="var type1" id="S94T1U2976">z</span>, <span class="var type1" id="S105T1U2977">l2</span>)</span>      = <span class="var type1" id="S106T1U2978">tmp1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,517" id="srcline517"> 517</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2154"><span class="var type1" id="S106T1U2982">tmp1</span> &gt; <span class="mxinfo " id="T1:U2156">7</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,518" id="srcline518"> 518</a></span><span class="line">                            <span class="mxinfo " id="T1:U2157"><span class="mxinfo " id="T1:U2158"><span class="mxinfo " id="T47:U2159"><span class="var type1" id="S71T48U2988">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U2990">z</span>, <span class="var type1" id="S105T1U2991">l2</span>)</span>    = <span class="mxinfo " id="T1:U2163"><span class="var type1" id="S96T1U2993">time</span> + <span class="mxinfo " id="T1:U2165"><span class="mxinfo " id="T1:U2166">round(<span class="mxinfo " id="T1:U2167"><span class="mxinfo " id="T1:U2168"><span class="var type1" id="S107T1U2999">tmp2</span>*<span class="mxinfo " id="T1:U2170"><span class="var type1" id="S51T40U3001">StageDuration</span>(<span class="mxinfo " id="T1:U2172"><span class="var type1" id="S106T1U3003">tmp1</span>-<span class="mxinfo " id="T1:U2174">6</span></span>, <span class="mxinfo " id="T1:U2175">1</span>)</span></span>*<span class="mxinfo " id="T1:U2176">4</span></span>)</span>/<span class="mxinfo " id="T1:U2177">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,519" id="srcline519"> 519</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,520" id="srcline520"> 520</a></span><span class="line">                            <span class="mxinfo " id="T1:U2178"><span class="mxinfo " id="T1:U2179"><span class="mxinfo " id="T47:U2180"><span class="var type1" id="S71T48U3013">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U3015">z</span>, <span class="var type1" id="S105T1U3016">l2</span>)</span>    = <span class="mxinfo " id="T1:U2184">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,521" id="srcline521"> 521</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,522" id="srcline522"> 522</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2185"><span class="var type1" id="S106T1U3021">tmp1</span> &gt; <span class="mxinfo " id="T1:U2187">8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,523" id="srcline523"> 523</a></span><span class="line">                            <span class="mxinfo " id="T1:U2188"><span class="mxinfo " id="T1:U2189"><span class="mxinfo " id="T47:U2190"><span class="var type1" id="S71T48U3027">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U3029">z</span>, <span class="var type1" id="S105T1U3030">l2</span>)</span>   = <span class="mxinfo " id="T1:U2194"><span class="var type1" id="S96T1U3032">time</span> + <span class="mxinfo " id="T1:U2196"><span class="mxinfo " id="T1:U2197">round(<span class="mxinfo " id="T1:U2198"><span class="mxinfo " id="T1:U2199"><span class="var type1" id="S107T1U3038">tmp2</span>*<span class="mxinfo " id="T1:U2201">sum(<span class="mxinfo " id="T88:U2202"><span class="var type1" id="S51T40U3042">StageDuration</span>(<span class="mxinfo " id="T1:U2204"><span class="var type1" id="S106T1U3044">tmp1</span>-<span class="mxinfo " id="T1:U2206">6</span></span>, <span class="mxinfo " id="T56:U2207">1:2</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U2208">4</span></span>)</span>/<span class="mxinfo " id="T1:U2209">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,524" id="srcline524"> 524</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,525" id="srcline525"> 525</a></span><span class="line">                            <span class="mxinfo " id="T1:U2210"><span class="mxinfo " id="T1:U2211"><span class="mxinfo " id="T47:U2212"><span class="var type1" id="S71T48U3056">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U3058">z</span>, <span class="var type1" id="S105T1U3059">l2</span>)</span>   = <span class="mxinfo " id="T1:U2216">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,526" id="srcline526"> 526</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,527" id="srcline527"> 527</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2217"><span class="var type1" id="S106T1U3064">tmp1</span> &gt; <span class="mxinfo " id="T1:U2219">9</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,528" id="srcline528"> 528</a></span><span class="line">                            <span class="mxinfo " id="T1:U2220"><span class="mxinfo " id="T1:U2221"><span class="mxinfo " id="T47:U2222"><span class="var type1" id="S71T48U3070">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U3072">z</span>, <span class="var type1" id="S105T1U3073">l2</span>)</span>  = <span class="mxinfo " id="T1:U2226"><span class="var type1" id="S96T1U3075">time</span> + <span class="mxinfo " id="T1:U2228"><span class="mxinfo " id="T1:U2229">round(<span class="mxinfo " id="T1:U2230"><span class="mxinfo " id="T1:U2231"><span class="var type1" id="S107T1U3081">tmp2</span>*<span class="mxinfo " id="T1:U2233">sum(<span class="mxinfo " id="T89:U2234"><span class="var type1" id="S51T40U3085">StageDuration</span>(<span class="mxinfo " id="T1:U2236"><span class="var type1" id="S106T1U3087">tmp1</span>-<span class="mxinfo " id="T1:U2238">6</span></span>, <span class="mxinfo " id="T90:U2239">1:3</span>)</span>)</span></span>*<span class="mxinfo " id="T1:U2240">4</span></span>)</span>/<span class="mxinfo " id="T1:U2241">4</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,529" id="srcline529"> 529</a></span><span class="line">                        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,530" id="srcline530"> 530</a></span><span class="line">                            <span class="mxinfo " id="T1:U2242"><span class="mxinfo " id="T1:U2243"><span class="mxinfo " id="T47:U2244"><span class="var type1" id="S71T48U3099">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U3101">z</span>, <span class="var type1" id="S105T1U3102">l2</span>)</span>  = <span class="mxinfo " id="T1:U2248">1000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,531" id="srcline531"> 531</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,532" id="srcline532"> 532</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,533" id="srcline533"> 533</a></span><span class="line">                        <span class="comment">% we keep track</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,534" id="srcline534"> 534</a></span><span class="line">                        <span class="mxinfo " id="T1:U2249"><span class="mxinfo " id="T1:U2250"><span class="var type1" id="S16T7U3107">DwellTimeFastCancer</span>(<span class="var type1" id="S2T1U3108">y</span>, <span class="mxinfo " id="T1:U2253"><span class="mxinfo " id="T91:U2254">length(<span class="mxinfo " id="T91:U2255">find(<span class="mxinfo " id="T92:U2256"><span class="var type1" id="S16T7U3115">DwellTimeFastCancer</span>(<span class="var type1" id="S2T1U3116">y</span>, <span class="mxinfo " id="T93:U2259">:</span>)</span>)</span>)</span>+<span class="mxinfo " id="T1:U2260">1</span></span>)</span> =<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,535" id="srcline535"> 535</a></span><span class="line">                            <span class="mxinfo " id="T1:U2261"><span class="var type1" id="S96T1U3120">time</span> - <span class="mxinfo " id="T1:U2263"><span class="mxinfo " id="T45:U2264"><span class="var type1" id="S70T46U3123">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U3125">z</span>, <span class="var type1" id="S77T1U3126">f</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,536" id="srcline536"> 536</a></span><span class="line">                        <span class="mxinfo " id="T94:U2268"><span class="mxinfo " id="T94:U2269"><span class="var type1" id="S17T8U3130">HasCancer</span>(<span class="mxinfo " id="T95:U2271"><span class="var type1" id="S2T1U3132">y</span>:<span class="mxinfo " id="T1:U2273">100</span></span>, <span class="var type1" id="S94T1U3134">z</span>)</span> = <span class="mxinfo " id="T1:U2275">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,537" id="srcline537"> 537</a></span><span class="line">                        <span class="mxinfo " id="T1:U2276"><span class="mxinfo " id="T1:U2277"><span class="var type1" id="S8T4U3139">DirectCancer</span>(<span class="mxinfo " id="T1:U2279"><span class="mxinfo " id="T45:U2280"><span class="var type1" id="S70T46U3142">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3144">z</span>, <span class="var type1" id="S77T1U3145">f</span>)</span>, <span class="var type1" id="S2T1U3146">y</span>)</span> = <span class="mxinfo " id="T1:U2285"><span class="mxinfo " id="T1:U2286"><span class="var type1" id="S8T4U3149">DirectCancer</span>(<span class="mxinfo " id="T1:U2288"><span class="mxinfo " id="T45:U2289"><span class="var type1" id="S70T46U3152">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3154">z</span>, <span class="var type1" id="S77T1U3155">f</span>)</span>, <span class="var type1" id="S2T1U3156">y</span>)</span> +<span class="mxinfo " id="T1:U2294">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,538" id="srcline538"> 538</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2295"><span class="mxinfo " id="T1:U2296"><span class="mxinfo " id="T47:U2297"><span class="var type1" id="S71T48U3163">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U3165">z</span>, <span class="var type1" id="S105T1U3166">l2</span>)</span>&lt;<span class="mxinfo " id="T1:U2301">4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,539" id="srcline539"> 539</a></span><span class="line">                            <span class="mxinfo " id="T1:U2302"><span class="mxinfo " id="T1:U2303"><span class="var type1" id="S9T5U3171">DirectCancerR</span>(<span class="var type1" id="S2T1U3172">y</span>)</span> = <span class="mxinfo " id="T1:U2306"><span class="mxinfo " id="T1:U2307"><span class="var type1" id="S9T5U3175">DirectCancerR</span>(<span class="var type1" id="S2T1U3176">y</span>)</span> +<span class="mxinfo " id="T1:U2310">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,540" id="srcline540"> 540</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,541" id="srcline541"> 541</a></span><span class="line">                        <span class="comment">% and we delete the polyp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,542" id="srcline542"> 542</a></span><span class="line">                        <span class="mxinfo " id="T96:U2311"><span class="mxinfo " id="T96:U2312"><span class="mxinfo " id="T45:U2313"><span class="var type1" id="S70T46U3182">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3184">z</span>, <span class="mxinfo " id="T97:U2316"><span class="var type1" id="S77T1U3186">f</span>:<span class="var type1" id="S101T1U3187">l</span></span>)</span>           = <span class="mxinfo " id="T96:U2319"><span class="mxinfo " id="T45:U2320"><span class="var type1" id="S70T46U3190">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3192">z</span>, <span class="mxinfo " id="T97:U2323"><span class="mxinfo " id="T1:U2324"><span class="var type1" id="S77T1U3195">f</span>+<span class="mxinfo " id="T1:U2326">1</span></span>:<span class="mxinfo " id="T1:U2327"><span class="var type1" id="S101T1U3198">l</span>+<span class="mxinfo " id="T1:U2329">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,543" id="srcline543"> 543</a></span><span class="line">                        <span class="mxinfo " id="T96:U2330"><span class="mxinfo " id="T96:U2331"><span class="mxinfo " id="T45:U2332"><span class="var type1" id="S70T46U3204">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U3206">z</span>, <span class="mxinfo " id="T97:U2335"><span class="var type1" id="S77T1U3208">f</span>:<span class="var type1" id="S101T1U3209">l</span></span>)</span>        = <span class="mxinfo " id="T96:U2338"><span class="mxinfo " id="T45:U2339"><span class="var type1" id="S70T46U3212">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U3214">z</span>, <span class="mxinfo " id="T97:U2342"><span class="mxinfo " id="T1:U2343"><span class="var type1" id="S77T1U3217">f</span>+<span class="mxinfo " id="T1:U2345">1</span></span>:<span class="mxinfo " id="T1:U2346"><span class="var type1" id="S101T1U3220">l</span>+<span class="mxinfo " id="T1:U2348">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,544" id="srcline544"> 544</a></span><span class="line">                        <span class="mxinfo " id="T96:U2349"><span class="mxinfo " id="T96:U2350"><span class="mxinfo " id="T45:U2351"><span class="var type1" id="S70T46U3226">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U3228">z</span>, <span class="mxinfo " id="T97:U2354"><span class="var type1" id="S77T1U3230">f</span>:<span class="var type1" id="S101T1U3231">l</span></span>)</span>    = <span class="mxinfo " id="T96:U2357"><span class="mxinfo " id="T45:U2358"><span class="var type1" id="S70T46U3234">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U3236">z</span>, <span class="mxinfo " id="T97:U2361"><span class="mxinfo " id="T1:U2362"><span class="var type1" id="S77T1U3239">f</span>+<span class="mxinfo " id="T1:U2364">1</span></span>:<span class="mxinfo " id="T1:U2365"><span class="var type1" id="S101T1U3242">l</span>+<span class="mxinfo " id="T1:U2367">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,545" id="srcline545"> 545</a></span><span class="line">                        <span class="mxinfo " id="T96:U2368"><span class="mxinfo " id="T96:U2369"><span class="mxinfo " id="T45:U2370"><span class="var type1" id="S70T46U3248">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U3250">z</span>, <span class="mxinfo " id="T97:U2373"><span class="var type1" id="S77T1U3252">f</span>:<span class="var type1" id="S101T1U3253">l</span></span>)</span> = <span class="mxinfo " id="T96:U2376"><span class="mxinfo " id="T45:U2377"><span class="var type1" id="S70T46U3256">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U3258">z</span>, <span class="mxinfo " id="T97:U2380"><span class="mxinfo " id="T1:U2381"><span class="var type1" id="S77T1U3261">f</span>+<span class="mxinfo " id="T1:U2383">1</span></span>:<span class="mxinfo " id="T1:U2384"><span class="var type1" id="S101T1U3264">l</span>+<span class="mxinfo " id="T1:U2386">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,546" id="srcline546"> 546</a></span><span class="line">                        <span class="mxinfo " id="T96:U2387"><span class="mxinfo " id="T96:U2388"><span class="mxinfo " id="T45:U2389"><span class="var type1" id="S70T46U3270">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U3272">z</span>, <span class="mxinfo " id="T97:U2392"><span class="var type1" id="S77T1U3274">f</span>:<span class="var type1" id="S101T1U3275">l</span></span>)</span>   = <span class="mxinfo " id="T96:U2395"><span class="mxinfo " id="T45:U2396"><span class="var type1" id="S70T46U3278">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U3280">z</span>, <span class="mxinfo " id="T97:U2399"><span class="mxinfo " id="T1:U2400"><span class="var type1" id="S77T1U3283">f</span>+<span class="mxinfo " id="T1:U2402">1</span></span>:<span class="mxinfo " id="T1:U2403"><span class="var type1" id="S101T1U3286">l</span>+<span class="mxinfo " id="T1:U2405">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,547" id="srcline547"> 547</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,548" id="srcline548"> 548</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,549" id="srcline549"> 549</a></span><span class="line">                <span class="comment">%                 catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,550" id="srcline550"> 550</a></span><span class="line">                <span class="comment">%                     rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,551" id="srcline551"> 551</a></span><span class="line">                <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,552" id="srcline552"> 552</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,553" id="srcline553"> 553</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,554" id="srcline554"> 554</a></span><span class="line">                <span class="comment">%   a polyp shrinks or disappears      %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,555" id="srcline555"> 555</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,556" id="srcline556"> 556</a></span><span class="line">                <span class="comment">%    try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,557" id="srcline557"> 557</a></span><span class="line">                <span class="mxinfo " id="T1:U2406"><span class="var type1" id="S101T1U3290">l</span> = <span class="mxinfo " id="T96:U2408">length(<span class="mxinfo " id="T96:U2409">find(<span class="mxinfo " id="T85:U2410"><span class="mxinfo " id="T45:U2411"><span class="var type1" id="S70T46U3297">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3299">z</span>, <span class="mxinfo " id="T86:U2414">:</span>)</span>)</span>)</span></span>; <span class="comment">% we need to calculate the length again</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,558" id="srcline558"> 558</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S77T1U3303">f</span>=<span class="var type1" id="S101T1U3306">l</span>:<span class="mxinfo " id="T1:U2417">-1</span>:<span class="mxinfo " id="T1:U2418">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,559" id="srcline559"> 559</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2419"><span class="mxinfo " id="T1:U2420">rand</span> &lt; <span class="mxinfo " id="T1:U2421"><span class="mxinfo " id="T20:U2422"><span class="var type1" id="S32T19U3317">StageVariables</span>.Healing</span>(<span class="mxinfo " id="T1:U2424"><span class="mxinfo " id="T45:U2425"><span class="var type1" id="S70T46U3321">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3323">z</span>, <span class="var type1" id="S77T1U3324">f</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,560" id="srcline560"> 560</a></span><span class="line">                        <span class="mxinfo " id="T1:U2429"><span class="mxinfo " id="T1:U2430"><span class="mxinfo " id="T45:U2431"><span class="var type1" id="S70T46U3329">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3331">z</span>, <span class="var type1" id="S77T1U3332">f</span>)</span> = <span class="mxinfo " id="T1:U2435"><span class="mxinfo " id="T1:U2436"><span class="mxinfo " id="T45:U2437"><span class="var type1" id="S70T46U3336">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3338">z</span>, <span class="var type1" id="S77T1U3339">f</span>)</span> - <span class="mxinfo " id="T1:U2441">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,561" id="srcline561"> 561</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2442">isequal(<span class="mxinfo " id="T1:U2443"><span class="mxinfo " id="T45:U2444"><span class="var type1" id="S70T46U3347">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3349">z</span>, <span class="var type1" id="S77T1U3350">f</span>)</span>, <span class="mxinfo " id="T1:U2448">0</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,562" id="srcline562"> 562</a></span><span class="line">                            <span class="comment">% in this case, the polyp had been of the smallest size,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,563" id="srcline563"> 563</a></span><span class="line">                            <span class="comment">% further shrinkage causes disappearance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,564" id="srcline564"> 564</a></span><span class="line">                            <span class="mxinfo " id="T96:U2449"><span class="mxinfo " id="T96:U2450"><span class="mxinfo " id="T45:U2451"><span class="var type1" id="S70T46U3356">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3358">z</span>, <span class="mxinfo " id="T97:U2454"><span class="var type1" id="S77T1U3360">f</span>:<span class="var type1" id="S101T1U3361">l</span></span>)</span>           = <span class="mxinfo " id="T96:U2457"><span class="mxinfo " id="T45:U2458"><span class="var type1" id="S70T46U3364">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U3366">z</span>, <span class="mxinfo " id="T97:U2461"><span class="mxinfo " id="T1:U2462"><span class="var type1" id="S77T1U3369">f</span>+<span class="mxinfo " id="T1:U2464">1</span></span>:<span class="mxinfo " id="T1:U2465"><span class="var type1" id="S101T1U3372">l</span>+<span class="mxinfo " id="T1:U2467">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,565" id="srcline565"> 565</a></span><span class="line">                            <span class="mxinfo " id="T96:U2468"><span class="mxinfo " id="T96:U2469"><span class="mxinfo " id="T45:U2470"><span class="var type1" id="S70T46U3378">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U3380">z</span>, <span class="mxinfo " id="T97:U2473"><span class="var type1" id="S77T1U3382">f</span>:<span class="var type1" id="S101T1U3383">l</span></span>)</span>        = <span class="mxinfo " id="T96:U2476"><span class="mxinfo " id="T45:U2477"><span class="var type1" id="S70T46U3386">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U3388">z</span>, <span class="mxinfo " id="T97:U2480"><span class="mxinfo " id="T1:U2481"><span class="var type1" id="S77T1U3391">f</span>+<span class="mxinfo " id="T1:U2483">1</span></span>:<span class="mxinfo " id="T1:U2484"><span class="var type1" id="S101T1U3394">l</span>+<span class="mxinfo " id="T1:U2486">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,566" id="srcline566"> 566</a></span><span class="line">                            <span class="mxinfo " id="T96:U2487"><span class="mxinfo " id="T96:U2488"><span class="mxinfo " id="T45:U2489"><span class="var type1" id="S70T46U3400">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U3402">z</span>, <span class="mxinfo " id="T97:U2492"><span class="var type1" id="S77T1U3404">f</span>:<span class="var type1" id="S101T1U3405">l</span></span>)</span>    = <span class="mxinfo " id="T96:U2495"><span class="mxinfo " id="T45:U2496"><span class="var type1" id="S70T46U3408">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U3410">z</span>, <span class="mxinfo " id="T97:U2499"><span class="mxinfo " id="T1:U2500"><span class="var type1" id="S77T1U3413">f</span>+<span class="mxinfo " id="T1:U2502">1</span></span>:<span class="mxinfo " id="T1:U2503"><span class="var type1" id="S101T1U3416">l</span>+<span class="mxinfo " id="T1:U2505">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,567" id="srcline567"> 567</a></span><span class="line">                            <span class="mxinfo " id="T96:U2506"><span class="mxinfo " id="T96:U2507"><span class="mxinfo " id="T45:U2508"><span class="var type1" id="S70T46U3422">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U3424">z</span>, <span class="mxinfo " id="T97:U2511"><span class="var type1" id="S77T1U3426">f</span>:<span class="var type1" id="S101T1U3427">l</span></span>)</span> = <span class="mxinfo " id="T96:U2514"><span class="mxinfo " id="T45:U2515"><span class="var type1" id="S70T46U3430">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U3432">z</span>, <span class="mxinfo " id="T97:U2518"><span class="mxinfo " id="T1:U2519"><span class="var type1" id="S77T1U3435">f</span>+<span class="mxinfo " id="T1:U2521">1</span></span>:<span class="mxinfo " id="T1:U2522"><span class="var type1" id="S101T1U3438">l</span>+<span class="mxinfo " id="T1:U2524">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,568" id="srcline568"> 568</a></span><span class="line">                            <span class="mxinfo " id="T96:U2525"><span class="mxinfo " id="T96:U2526"><span class="mxinfo " id="T45:U2527"><span class="var type1" id="S70T46U3444">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U3446">z</span>, <span class="mxinfo " id="T97:U2530"><span class="var type1" id="S77T1U3448">f</span>:<span class="var type1" id="S101T1U3449">l</span></span>)</span>   = <span class="mxinfo " id="T96:U2533"><span class="mxinfo " id="T45:U2534"><span class="var type1" id="S70T46U3452">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U3454">z</span>, <span class="mxinfo " id="T97:U2537"><span class="mxinfo " id="T1:U2538"><span class="var type1" id="S77T1U3457">f</span>+<span class="mxinfo " id="T1:U2540">1</span></span>:<span class="mxinfo " id="T1:U2541"><span class="var type1" id="S101T1U3460">l</span>+<span class="mxinfo " id="T1:U2543">1</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,569" id="srcline569"> 569</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,570" id="srcline570"> 570</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,571" id="srcline571"> 571</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,572" id="srcline572"> 572</a></span><span class="line">                <span class="comment">%                 catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,573" id="srcline573"> 573</a></span><span class="line">                <span class="comment">%                     rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,574" id="srcline574"> 574</a></span><span class="line">                <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,575" id="srcline575"> 575</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,576" id="srcline576"> 576</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,577" id="srcline577"> 577</a></span><span class="line">                <span class="comment">% symptom development               %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,578" id="srcline578"> 578</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,579" id="srcline579"> 579</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,580" id="srcline580"> 580</a></span><span class="line">                <span class="comment">% try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,581" id="srcline581"> 581</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S77T1U3464">f</span>=<span class="mxinfo " id="T1:U2545">length(<span class="mxinfo " id="T87:U2546">find(<span class="mxinfo " id="T73:U2547"><span class="mxinfo " id="T47:U2548"><span class="var type1" id="S71T48U3473">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3475">z</span>, <span class="mxinfo " id="T76:U2551">:</span>)</span>)</span>)</span> : <span class="mxinfo " id="T1:U2552">-1</span> : <span class="mxinfo " id="T1:U2553">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,582" id="srcline582"> 582</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2554"><span class="var type1" id="S96T1U3483">time</span> &gt;= <span class="mxinfo " id="T1:U2556"><span class="mxinfo " id="T47:U2557"><span class="var type1" id="S71T48U3486">Ca</span>.SympTime</span>(<span class="var type1" id="S94T1U3488">z</span>,<span class="var type1" id="S77T1U3489">f</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,583" id="srcline583"> 583</a></span><span class="line">                            <span class="comment">% if symptoms appear we do colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,584" id="srcline584"> 584</a></span><span class="line">                            <span class="mxinfo " id="T1:U2561"><span class="mxinfo " id="T1:U2562"><span class="mxinfo " id="T5:U2563"><span class="var type1" id="S25T17U3494">Number</span>.Symptoms_Colonoscopy</span>(<span class="var type1" id="S2T1U3496">y</span>)</span> = <span class="mxinfo " id="T1:U2566"><span class="mxinfo " id="T1:U2567"><span class="mxinfo " id="T5:U2568"><span class="var type1" id="S25T17U3500">Number</span>.Symptoms_Colonoscopy</span>(<span class="var type1" id="S2T1U3502">y</span>)</span>+<span class="mxinfo " id="T1:U2571">1</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,585" id="srcline585"> 585</a></span><span class="line">                            [<span class="var type1" id="S70T46U3507">Polyp</span>, <span class="var type1" id="S71T48U3508">Ca</span>, <span class="var type1" id="S72T50U3509">Detected</span>, <span class="var type1" id="S58T44U3510">Included</span>, <span class="var type1" id="S4T2U3511">DeathCause</span>, <span class="var type1" id="S6T2U3512">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,586" id="srcline586"> 586</a></span><span class="line">                                <span class="var type1" id="S27T8U3513">DiagnosedCancer</span>, <span class="var type1" id="S28T5U3514">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U3515">EarlyPolypsRemoved</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,587" id="srcline587"> 587</a></span><span class="line">                                <span class="var type1" id="S5T3U3516">Last</span>, <span class="var type1" id="S14T6U3517">TumorRecord</span>, <span class="var type1" id="S23T10U3518">PaymentType</span>, <span class="var type1" id="S24T15U3519">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,588" id="srcline588"> 588</a></span><span class="line">                                = Colonoscopy(<span class="var type1" id="S94T1U3522">z</span>, <span class="var type1" id="S2T1U3523">y</span>, <span class="var type1" id="S95T1U3524">q</span>, <span class="string">'Symp'</span>, <span class="var type1" id="S3T2U3526">Gender</span>, <span class="var type1" id="S70T46U3527">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,589" id="srcline589"> 589</a></span><span class="line">                                <span class="var type1" id="S71T48U3528">Ca</span>, <span class="var type1" id="S72T50U3529">Detected</span>, <span class="var type1" id="S58T44U3530">Included</span>, <span class="var type1" id="S4T2U3531">DeathCause</span>, <span class="var type1" id="S6T2U3532">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,590" id="srcline590"> 590</a></span><span class="line">                                <span class="var type1" id="S27T8U3533">DiagnosedCancer</span>, <span class="var type1" id="S28T5U3534">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U3535">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U3536">Last</span>, <span class="var type1" id="S14T6U3537">TumorRecord</span>, <span class="var type1" id="S23T10U3538">PaymentType</span>, <span class="var type1" id="S24T15U3539">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,591" id="srcline591"> 591</a></span><span class="line">                                <span class="var type1" id="S32T19U3540">StageVariables</span>, <span class="var type1" id="S34T23U3541">Cost</span>, <span class="var type1" id="S33T21U3542">Location</span>, <span class="var type1" id="S36T26U3543">risc</span>, <span class="var type1" id="S81T62U3544">ColoReachMatrix</span>, <span class="var type1" id="S49T38U3545">MortalityMatrix</span>, <span class="var type1" id="S35T24U3546">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,592" id="srcline592"> 592</a></span><span class="line">                            <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,593" id="srcline593"> 593</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,594" id="srcline594"> 594</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,595" id="srcline595"> 595</a></span><span class="line"><span class="comment">%                 catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,596" id="srcline596"> 596</a></span><span class="line"><span class="comment">%                     rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,597" id="srcline597"> 597</a></span><span class="line"><span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,598" id="srcline598"> 598</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,599" id="srcline599"> 599</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,600" id="srcline600"> 600</a></span><span class="line">                <span class="comment">% Cancer Progression                %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,601" id="srcline601"> 601</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,602" id="srcline602"> 602</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,603" id="srcline603"> 603</a></span><span class="line">                <span class="comment">%                try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,604" id="srcline604"> 604</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S77T1U3550">f</span>=<span class="mxinfo " id="T1:U2610">1</span>:<span class="mxinfo " id="T1:U2611">length(<span class="mxinfo " id="T87:U2612">find(<span class="mxinfo " id="T73:U2613"><span class="mxinfo " id="T47:U2614"><span class="var type1" id="S71T48U3559">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3561">z</span>, <span class="mxinfo " id="T76:U2617">:</span>)</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,605" id="srcline605"> 605</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2618">isequal(<span class="mxinfo " id="T1:U2619"><span class="mxinfo " id="T47:U2620"><span class="var type1" id="S71T48U3569">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3571">z</span>, <span class="var type1" id="S77T1U3572">f</span>)</span>, <span class="mxinfo " id="T1:U2624">7</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,606" id="srcline606"> 606</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2625"><span class="var type1" id="S96T1U3577">time</span> &gt;= <span class="mxinfo " id="T1:U2627"><span class="mxinfo " id="T47:U2628"><span class="var type1" id="S71T48U3580">Ca</span>.TimeStage_I</span>(<span class="var type1" id="S94T1U3582">z</span>, <span class="var type1" id="S77T1U3583">f</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,607" id="srcline607"> 607</a></span><span class="line">                            <span class="mxinfo " id="T1:U2632"><span class="mxinfo " id="T1:U2633"><span class="mxinfo " id="T47:U2634"><span class="var type1" id="S71T48U3588">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3590">z</span>, <span class="var type1" id="S77T1U3591">f</span>)</span> = <span class="mxinfo " id="T1:U2638">8</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,608" id="srcline608"> 608</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,609" id="srcline609"> 609</a></span><span class="line">                    <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2639">isequal(<span class="mxinfo " id="T1:U2640"><span class="mxinfo " id="T47:U2641"><span class="var type1" id="S71T48U3598">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3600">z</span>, <span class="var type1" id="S77T1U3601">f</span>)</span>, <span class="mxinfo " id="T1:U2645">8</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,610" id="srcline610"> 610</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2646"><span class="var type1" id="S96T1U3606">time</span> &gt;= <span class="mxinfo " id="T1:U2648"><span class="mxinfo " id="T47:U2649"><span class="var type1" id="S71T48U3609">Ca</span>.TimeStage_II</span>(<span class="var type1" id="S94T1U3611">z</span>, <span class="var type1" id="S77T1U3612">f</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,611" id="srcline611"> 611</a></span><span class="line">                            <span class="mxinfo " id="T1:U2653"><span class="mxinfo " id="T1:U2654"><span class="mxinfo " id="T47:U2655"><span class="var type1" id="S71T48U3617">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3619">z</span>, <span class="var type1" id="S77T1U3620">f</span>)</span> = <span class="mxinfo " id="T1:U2659">9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,612" id="srcline612"> 612</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,613" id="srcline613"> 613</a></span><span class="line">                    <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2660">isequal(<span class="mxinfo " id="T1:U2661"><span class="mxinfo " id="T47:U2662"><span class="var type1" id="S71T48U3627">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3629">z</span>, <span class="var type1" id="S77T1U3630">f</span>)</span>, <span class="mxinfo " id="T1:U2666">9</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,614" id="srcline614"> 614</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2667"><span class="var type1" id="S96T1U3635">time</span> &gt;= <span class="mxinfo " id="T1:U2669"><span class="mxinfo " id="T47:U2670"><span class="var type1" id="S71T48U3638">Ca</span>.TimeStage_III</span>(<span class="var type1" id="S94T1U3640">z</span>, <span class="var type1" id="S77T1U3641">f</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,615" id="srcline615"> 615</a></span><span class="line">                            <span class="mxinfo " id="T1:U2674"><span class="mxinfo " id="T1:U2675"><span class="mxinfo " id="T47:U2676"><span class="var type1" id="S71T48U3646">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U3648">z</span>, <span class="var type1" id="S77T1U3649">f</span>)</span> = <span class="mxinfo " id="T1:U2680">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,616" id="srcline616"> 616</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,617" id="srcline617"> 617</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,618" id="srcline618"> 618</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,619" id="srcline619"> 619</a></span><span class="line">                <span class="comment">%                 catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,620" id="srcline620"> 620</a></span><span class="line">                <span class="comment">%                     rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,621" id="srcline621"> 621</a></span><span class="line">                <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,622" id="srcline622"> 622</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,623" id="srcline623"> 623</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,624" id="srcline624"> 624</a></span><span class="line">                <span class="comment">%    baseline colonoscopy           %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,625" id="srcline625"> 625</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,626" id="srcline626"> 626</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,627" id="srcline627"> 627</a></span><span class="line">                <span class="comment">% There is a small chance,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,628" id="srcline628"> 628</a></span><span class="line">                <span class="comment">% symptoms appear even without a leasion</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,629" id="srcline629"> 629</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,630" id="srcline630"> 630</a></span><span class="line">                <span class="comment">%                 if isequal(q,1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,631" id="srcline631"> 631</a></span><span class="line">                <span class="comment">%                     if rand &lt; ColonoscopyLikelyhood(y)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,632" id="srcline632"> 632</a></span><span class="line">                <span class="comment">%                         % symptoms without a polyp: we do baseline colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,633" id="srcline633"> 633</a></span><span class="line">                <span class="comment">%                         Number.Baseline_Colonoscopy(y) = Number.Baseline_Colonoscopy(y) +1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,634" id="srcline634"> 634</a></span><span class="line">                <span class="comment">%                         [Polyp, Ca, Detected, Included, DeathCause, DeathYear,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,635" id="srcline635"> 635</a></span><span class="line">                <span class="comment">%                             DiagnosedCancer, AdvancedPolypsRemoved, EarlyPolypsRemoved, Last, TumorRecord, PaymentType, Money]<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,636" id="srcline636"> 636</a></span><span class="line">                <span class="comment">%                             = Colonoscopy(z, y, q, 'Base', Gender, Polyp,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,637" id="srcline637"> 637</a></span><span class="line">                <span class="comment">%                             Ca, Detected, Included, DeathCause, DeathYear,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,638" id="srcline638"> 638</a></span><span class="line">                <span class="comment">%                             DiagnosedCancer, AdvancedPolypsRemoved, EarlyPolypsRemoved, Last, TumorRecord, PaymentType, Money,<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,639" id="srcline639"> 639</a></span><span class="line">                <span class="comment">%                             StageVariables, Cost, Location, risc, ColoReachMatrix, MortalityMatrix, CostStage);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,640" id="srcline640"> 640</a></span><span class="line">                <span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,641" id="srcline641"> 641</a></span><span class="line">                <span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,642" id="srcline642"> 642</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,643" id="srcline643"> 643</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,644" id="srcline644"> 644</a></span><span class="line">                <span class="comment">% polyp and cancer surveillance     %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,645" id="srcline645"> 645</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,646" id="srcline646"> 646</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,647" id="srcline647"> 647</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T28:U2681">isequal(<span class="var type1" id="S95T1U3655">q</span>, <span class="mxinfo " id="T1:U2683">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,648" id="srcline648"> 648</a></span><span class="line">                    <span class="mxinfo " id="T1:U2684"><span class="var type1" id="S111T1U3659">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2686">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,649" id="srcline649"> 649</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2687"><span class="var type1" id="S37T27U3664">flag</span>.Polyp_Surveillance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,650" id="srcline650"> 650</a></span><span class="line">                        <span class="comment">% a polyp removed 5 years ago if no colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,651" id="srcline651"> 651</a></span><span class="line">                        <span class="comment">% performed inbetween.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,652" id="srcline652"> 652</a></span><span class="line">                        <span class="comment">%      try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,653" id="srcline653"> 653</a></span><span class="line">                        <span class="keyword">if</span>     <span class="mxinfo " id="T28:U2689">and(<span class="mxinfo " id="T28:U2690">isequal(<span class="mxinfo " id="T1:U2691"><span class="var type1" id="S2T1U3673">y</span> - <span class="mxinfo " id="T1:U2693"><span class="mxinfo " id="T2:U2694"><span class="var type1" id="S5T3U3676">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U3678">z</span>)</span></span>, <span class="mxinfo " id="T1:U2697">5</span>)</span>, (<span class="mxinfo " id="T28:U2698">(<span class="mxinfo " id="T1:U2699"><span class="var type1" id="S2T1U3684">y</span> - <span class="mxinfo " id="T1:U2701"><span class="mxinfo " id="T2:U2702"><span class="var type1" id="S5T3U3687">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3689">z</span>)</span></span>) &gt;=<span class="mxinfo " id="T1:U2705">5</span></span>))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,654" id="srcline654"> 654</a></span><span class="line">                            <span class="mxinfo " id="T1:U2706"><span class="var type1" id="S111T1U3693">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2708">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,655" id="srcline655"> 655</a></span><span class="line">                            <span class="comment">% between 5 and 9 years after polyp removal after last colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,656" id="srcline656"> 656</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2709">and(<span class="mxinfo " id="T28:U2710">(<span class="mxinfo " id="T1:U2711"><span class="var type1" id="S2T1U3702">y</span> - <span class="mxinfo " id="T1:U2713"><span class="mxinfo " id="T2:U2714"><span class="var type1" id="S5T3U3705">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U3707">z</span>)</span></span>)&gt;<span class="mxinfo " id="T1:U2717">5</span></span>, <span class="mxinfo " id="T28:U2718">(<span class="mxinfo " id="T1:U2719"><span class="var type1" id="S2T1U3712">y</span> - <span class="mxinfo " id="T1:U2721"><span class="mxinfo " id="T2:U2722"><span class="var type1" id="S5T3U3715">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U3717">z</span>)</span></span>)&lt;=<span class="mxinfo " id="T1:U2725">9</span></span>)</span> &amp;&amp; (<span class="mxinfo " id="T28:U2726">(<span class="mxinfo " id="T1:U2727"><span class="var type1" id="S2T1U3723">y</span>-<span class="mxinfo " id="T1:U2729"><span class="mxinfo " id="T2:U2730"><span class="var type1" id="S5T3U3726">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3728">z</span>)</span></span>) &gt;=<span class="mxinfo " id="T1:U2733">5</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,657" id="srcline657"> 657</a></span><span class="line">                            <span class="mxinfo " id="T1:U2734"><span class="var type1" id="S111T1U3732">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2736">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,658" id="srcline658"> 658</a></span><span class="line">                            <span class="comment">% This provides surveillance every 5 years after</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,659" id="srcline659"> 659</a></span><span class="line">                            <span class="comment">% each polyp !!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,660" id="srcline660"> 660</a></span><span class="line">                            <span class="comment">%   elseif and(~isequal(Last.Polyp(z), -100), y-Last.Colonoscopy(z) &gt;=5)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,661" id="srcline661"> 661</a></span><span class="line">                            <span class="comment">%       SurveillanceFlag = 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,662" id="srcline662"> 662</a></span><span class="line">                            <span class="comment">% an advanced polyp 3 years ago</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,663" id="srcline663"> 663</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2737">and(<span class="mxinfo " id="T28:U2738">isequal(<span class="mxinfo " id="T1:U2739"><span class="var type1" id="S2T1U3740">y</span> - <span class="mxinfo " id="T1:U2741"><span class="mxinfo " id="T2:U2742"><span class="var type1" id="S5T3U3743">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U3745">z</span>)</span></span>, <span class="mxinfo " id="T1:U2745">3</span>)</span>, (<span class="mxinfo " id="T28:U2746"><span class="mxinfo " id="T1:U2747"><span class="var type1" id="S2T1U3750">y</span> - <span class="mxinfo " id="T1:U2749"><span class="mxinfo " id="T2:U2750"><span class="var type1" id="S5T3U3753">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3755">z</span>)</span></span> &gt;=<span class="mxinfo " id="T1:U2753">3</span></span>))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,664" id="srcline664"> 664</a></span><span class="line">                            <span class="mxinfo " id="T1:U2754"><span class="var type1" id="S111T1U3759">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2756">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,665" id="srcline665"> 665</a></span><span class="line">                            <span class="comment">% 5 years intervals if an advanced polyp had been</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,666" id="srcline666"> 666</a></span><span class="line">                            <span class="comment">% diagnosed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,667" id="srcline667"> 667</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2757">~<span class="mxinfo " id="T28:U2758">isequal(<span class="mxinfo " id="T1:U2759"><span class="mxinfo " id="T2:U2760"><span class="var type1" id="S5T3U3767">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U3769">z</span>)</span>, <span class="mxinfo " id="T1:U2763">-100</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,668" id="srcline668"> 668</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U2764">and(<span class="mxinfo " id="T28:U2765">(<span class="mxinfo " id="T1:U2766"><span class="var type1" id="S2T1U3779">y</span> - <span class="mxinfo " id="T1:U2768"><span class="mxinfo " id="T2:U2769"><span class="var type1" id="S5T3U3782">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U3784">z</span>)</span></span>)&gt;=<span class="mxinfo " id="T1:U2772">5</span></span>, <span class="mxinfo " id="T28:U2773">(<span class="mxinfo " id="T1:U2774"><span class="var type1" id="S2T1U3789">y</span>-<span class="mxinfo " id="T1:U2776"><span class="mxinfo " id="T2:U2777"><span class="var type1" id="S5T3U3792">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3794">z</span>)</span></span>) &gt;=<span class="mxinfo " id="T1:U2780">5</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,669" id="srcline669"> 669</a></span><span class="line">                                <span class="comment">% and((y - LastAdvPolyp(z))&gt;8, (y - LastAdvPolyp(z))&lt;=13) &amp;&amp; ((y-LastColonoscopy(z)) &gt;=5)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,670" id="srcline670"> 670</a></span><span class="line">                                <span class="mxinfo " id="T1:U2781"><span class="var type1" id="S111T1U3798">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2783">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,671" id="srcline671"> 671</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,672" id="srcline672"> 672</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U2784"><span class="var type1" id="S37T27U3802">flag</span>.AllPolypFollowUp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,673" id="srcline673"> 673</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U2786">~<span class="mxinfo " id="T28:U2787">isequal(<span class="mxinfo " id="T1:U2788"><span class="mxinfo " id="T2:U2789"><span class="var type1" id="S5T3U3811">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U3813">z</span>)</span>, <span class="mxinfo " id="T1:U2792">-100</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,674" id="srcline674"> 674</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U2793">and(<span class="mxinfo " id="T28:U2794">(<span class="mxinfo " id="T1:U2795"><span class="var type1" id="S2T1U3823">y</span> - <span class="mxinfo " id="T1:U2797"><span class="mxinfo " id="T2:U2798"><span class="var type1" id="S5T3U3826">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U3828">z</span>)</span></span>)&gt;=<span class="mxinfo " id="T1:U2801">5</span></span>, <span class="mxinfo " id="T28:U2802">(<span class="mxinfo " id="T1:U2803"><span class="var type1" id="S2T1U3833">y</span>-<span class="mxinfo " id="T1:U2805"><span class="mxinfo " id="T2:U2806"><span class="var type1" id="S5T3U3836">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3838">z</span>)</span></span>) &gt;=<span class="mxinfo " id="T1:U2809">5</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,675" id="srcline675"> 675</a></span><span class="line">                                    <span class="mxinfo " id="T1:U2810"><span class="var type1" id="S111T1U3842">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2812">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,676" id="srcline676"> 676</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,677" id="srcline677"> 677</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,678" id="srcline678"> 678</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,679" id="srcline679"> 679</a></span><span class="line">                        <span class="comment">%                     catch exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,680" id="srcline680"> 680</a></span><span class="line">                        <span class="comment">%                         rethrow(exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,681" id="srcline681"> 681</a></span><span class="line">                        <span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,682" id="srcline682"> 682</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,683" id="srcline683"> 683</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,684" id="srcline684"> 684</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2813"><span class="var type1" id="S37T27U3847">flag</span>.Cancer_Surveillance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,685" id="srcline685"> 685</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2815">~<span class="mxinfo " id="T28:U2816">isequal(<span class="mxinfo " id="T1:U2817"><span class="mxinfo " id="T2:U2818"><span class="var type1" id="S5T3U3856">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U3858">z</span>)</span>, <span class="mxinfo " id="T1:U2821">-100</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,686" id="srcline686"> 686</a></span><span class="line">                            <span class="comment">% 1 year after cancer diagnosis</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,687" id="srcline687"> 687</a></span><span class="line">                            <span class="keyword">if</span>  <span class="mxinfo " id="T28:U2822">and(<span class="mxinfo " id="T28:U2823">isequal(<span class="mxinfo " id="T1:U2824"><span class="var type1" id="S2T1U3868">y</span> - <span class="mxinfo " id="T1:U2826"><span class="mxinfo " id="T2:U2827"><span class="var type1" id="S5T3U3871">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U3873">z</span>)</span></span>, <span class="mxinfo " id="T1:U2830">1</span>)</span>, <span class="mxinfo " id="T28:U2831">isequal((<span class="mxinfo " id="T1:U2832"><span class="var type1" id="S2T1U3879">y</span>-<span class="mxinfo " id="T1:U2834"><span class="mxinfo " id="T2:U2835"><span class="var type1" id="S5T3U3882">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3884">z</span>)</span></span>), <span class="mxinfo " id="T1:U2838">1</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,688" id="srcline688"> 688</a></span><span class="line">                                <span class="mxinfo " id="T1:U2839"><span class="var type1" id="S111T1U3888">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2841">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,689" id="srcline689"> 689</a></span><span class="line">                                <span class="comment">% 4 years after cancer diagnosis</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,690" id="srcline690"> 690</a></span><span class="line">                            <span class="keyword">elseif</span>  <span class="mxinfo " id="T28:U2842">and(<span class="mxinfo " id="T28:U2843">isequal(<span class="mxinfo " id="T1:U2844"><span class="var type1" id="S2T1U3896">y</span> - <span class="mxinfo " id="T1:U2846"><span class="mxinfo " id="T2:U2847"><span class="var type1" id="S5T3U3899">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U3901">z</span>)</span></span>, <span class="mxinfo " id="T1:U2850">4</span>)</span>, <span class="mxinfo " id="T28:U2851">isequal((<span class="mxinfo " id="T1:U2852"><span class="var type1" id="S2T1U3907">y</span>-<span class="mxinfo " id="T1:U2854"><span class="mxinfo " id="T2:U2855"><span class="var type1" id="S5T3U3910">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3912">z</span>)</span></span>), <span class="mxinfo " id="T1:U2858">3</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,691" id="srcline691"> 691</a></span><span class="line">                                <span class="mxinfo " id="T1:U2859"><span class="var type1" id="S111T1U3916">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2861">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,692" id="srcline692"> 692</a></span><span class="line">                                <span class="comment">% 5 years intervals after this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,693" id="srcline693"> 693</a></span><span class="line">                            <span class="keyword">elseif</span>  <span class="mxinfo " id="T28:U2862">and(<span class="mxinfo " id="T28:U2863">(<span class="mxinfo " id="T1:U2864"><span class="var type1" id="S2T1U3924">y</span> - <span class="mxinfo " id="T1:U2866"><span class="mxinfo " id="T2:U2867"><span class="var type1" id="S5T3U3927">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U3929">z</span>)</span></span>)&gt;=<span class="mxinfo " id="T1:U2870">5</span></span>, <span class="mxinfo " id="T28:U2871">(<span class="mxinfo " id="T1:U2872"><span class="var type1" id="S2T1U3934">y</span>-<span class="mxinfo " id="T1:U2874"><span class="mxinfo " id="T2:U2875"><span class="var type1" id="S5T3U3937">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U3939">z</span>)</span></span>) &gt;=<span class="mxinfo " id="T1:U2878">5</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,694" id="srcline694"> 694</a></span><span class="line">                                <span class="mxinfo " id="T1:U2879"><span class="var type1" id="S111T1U3943">SurveillanceFlag</span> = <span class="mxinfo " id="T1:U2881">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,695" id="srcline695"> 695</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,696" id="srcline696"> 696</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,697" id="srcline697"> 697</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,698" id="srcline698"> 698</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2882">isequal(<span class="var type1" id="S111T1U3949">SurveillanceFlag</span>, <span class="mxinfo " id="T1:U2884">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,699" id="srcline699"> 699</a></span><span class="line">                        <span class="mxinfo " id="T1:U2885"><span class="mxinfo " id="T1:U2886"><span class="mxinfo " id="T5:U2887"><span class="var type1" id="S25T17U3955">Number</span>.Follow_Up_Colonoscopy</span>(<span class="var type1" id="S2T1U3957">y</span>)</span> = <span class="mxinfo " id="T1:U2890"><span class="mxinfo " id="T1:U2891"><span class="mxinfo " id="T5:U2892"><span class="var type1" id="S25T17U3961">Number</span>.Follow_Up_Colonoscopy</span> (<span class="var type1" id="S2T1U3963">y</span>)</span> + <span class="mxinfo " id="T1:U2895">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,700" id="srcline700"> 700</a></span><span class="line">                        [<span class="var type1" id="S70T46U3968">Polyp</span>, <span class="var type1" id="S71T48U3969">Ca</span>, <span class="var type1" id="S72T50U3970">Detected</span>, <span class="var type1" id="S58T44U3971">Included</span>, <span class="var type1" id="S4T2U3972">DeathCause</span>, <span class="var type1" id="S6T2U3973">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,701" id="srcline701"> 701</a></span><span class="line">                            <span class="var type1" id="S27T8U3974">DiagnosedCancer</span>, <span class="var type1" id="S28T5U3975">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U3976">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U3977">Last</span>, <span class="var type1" id="S14T6U3978">TumorRecord</span>, <span class="var type1" id="S23T10U3979">PaymentType</span>, <span class="var type1" id="S24T15U3980">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,702" id="srcline702"> 702</a></span><span class="line">                            = Colonoscopy(<span class="var type1" id="S94T1U3983">z</span>, <span class="var type1" id="S2T1U3984">y</span>, <span class="var type1" id="S95T1U3985">q</span>, <span class="string">'Foll'</span>, <span class="var type1" id="S3T2U3987">Gender</span>, <span class="var type1" id="S70T46U3988">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,703" id="srcline703"> 703</a></span><span class="line">                            <span class="var type1" id="S71T48U3989">Ca</span>, <span class="var type1" id="S72T50U3990">Detected</span>, <span class="var type1" id="S58T44U3991">Included</span>, <span class="var type1" id="S4T2U3992">DeathCause</span>, <span class="var type1" id="S6T2U3993">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,704" id="srcline704"> 704</a></span><span class="line">                            <span class="var type1" id="S27T8U3994">DiagnosedCancer</span>, <span class="var type1" id="S28T5U3995">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U3996">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U3997">Last</span>, <span class="var type1" id="S14T6U3998">TumorRecord</span>, <span class="var type1" id="S23T10U3999">PaymentType</span>, <span class="var type1" id="S24T15U4000">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,705" id="srcline705"> 705</a></span><span class="line">                            <span class="var type1" id="S32T19U4001">StageVariables</span>, <span class="var type1" id="S34T23U4002">Cost</span>, <span class="var type1" id="S33T21U4003">Location</span>, <span class="var type1" id="S36T26U4004">risc</span>, <span class="var type1" id="S81T62U4005">ColoReachMatrix</span>, <span class="var type1" id="S49T38U4006">MortalityMatrix</span>, <span class="var type1" id="S35T24U4007">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,706" id="srcline706"> 706</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,707" id="srcline707"> 707</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,708" id="srcline708"> 708</a></span><span class="line">                    <span class="comment">% perhaps we do screening?</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,709" id="srcline709"> 709</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2933"><span class="var type1" id="S37T27U4011">flag</span>.Screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,710" id="srcline710"> 710</a></span><span class="line">                        <span class="comment">% we only screen patients who are alive</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,711" id="srcline711"> 711</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2935">and(<span class="mxinfo " id="T28:U2936"><span class="var type1" id="S58T44U4018">Included</span>(<span class="var type1" id="S94T1U4019">z</span>)</span>, <span class="mxinfo " id="T28:U2939">~<span class="mxinfo " id="T28:U2940">isequal(<span class="mxinfo " id="T1:U2941"><span class="var type1" id="S42T2U4024">ScreeningPreference</span>(<span class="var type1" id="S94T1U4025">z</span>)</span>, <span class="mxinfo " id="T1:U2944">0</span>)</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,712" id="srcline712"> 712</a></span><span class="line">                            <span class="comment">% x-matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,713" id="srcline713"> 713</a></span><span class="line">                            <span class="comment">% 1: PercentPop, 2: Adherence,    3: FollowUp,   4:y-start, 5:y-end,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,714" id="srcline714"> 714</a></span><span class="line">                            <span class="comment">% 6: interval,   7: y after colo, 8: specificity</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,715" id="srcline715"> 715</a></span><span class="line">                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,716" id="srcline716"> 716</a></span><span class="line">                            <span class="comment">% y-matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,717" id="srcline717"> 717</a></span><span class="line">                            <span class="comment">% 1: colonoscopy, 2: Rectosigmoidoscopy, 3: FOBT, 4: I_FOBT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,718" id="srcline718"> 718</a></span><span class="line">                            <span class="comment">% 5: Sept9_HiSens, 6: Sept9_HiSpec, 7: other</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,719" id="srcline719"> 719</a></span><span class="line">                            <span class="mxinfo " id="T1:U2945"><span class="var type1" id="S112T1U4029">preference</span> = <span class="mxinfo " id="T1:U2947"><span class="var type1" id="S42T2U4031">ScreeningPreference</span>(<span class="var type1" id="S94T1U4032">z</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,720" id="srcline720"> 720</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U2950">and(<span class="mxinfo " id="T28:U2951"><span class="var type1" id="S2T1U4038">y</span> &gt;= <span class="mxinfo " id="T1:U2953"><span class="var type1" id="S41T32U4040">ScreeningTest</span>(<span class="var type1" id="S112T1U4041">preference</span>, <span class="mxinfo " id="T1:U2956">4</span>)</span></span>, <span class="mxinfo " id="T28:U2957"><span class="var type1" id="S2T1U4044">y</span> &lt;<span class="mxinfo " id="T1:U2959"><span class="var type1" id="S41T32U4046">ScreeningTest</span>(<span class="var type1" id="S112T1U4047">preference</span>, <span class="mxinfo " id="T1:U2962">5</span>)</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,721" id="srcline721"> 721</a></span><span class="line">                                <span class="comment">% if and(y &gt;= Screening.Year_Start, y &lt;Screening.Year_End) % if the patients qualifies agewise</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,722" id="srcline722"> 722</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U2963"><span class="mxinfo " id="T1:U2964"><span class="var type1" id="S2T1U4053">y</span>-<span class="mxinfo " id="T1:U2966"><span class="mxinfo " id="T2:U2967"><span class="var type1" id="S5T3U4056">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U4058">z</span>)</span></span> &gt;= <span class="mxinfo " id="T1:U2970"><span class="var type1" id="S41T32U4060">ScreeningTest</span>(<span class="var type1" id="S112T1U4061">preference</span>, <span class="mxinfo " id="T1:U2973">7</span>)</span></span> <span class="comment">% we only screen so and so many years after the last Colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,723" id="srcline723"> 723</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,724" id="srcline724"> 724</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U2974">isequal(<span class="var type1" id="S112T1U4067">preference</span>, <span class="mxinfo " id="T1:U2976">1</span>)</span> <span class="comment">% Colonoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,725" id="srcline725"> 725</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U2977"><span class="mxinfo " id="T1:U2978"><span class="var type1" id="S2T1U4073">y</span>-<span class="mxinfo " id="T1:U2980"><span class="mxinfo " id="T2:U2981"><span class="var type1" id="S5T3U4076">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U4078">z</span>)</span></span> &gt;= <span class="mxinfo " id="T1:U2984"><span class="var type1" id="S41T32U4080">ScreeningTest</span>(<span class="var type1" id="S112T1U4081">preference</span>, <span class="mxinfo " id="T1:U2987">6</span>)</span></span> <span class="comment">% interval</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,726" id="srcline726"> 726</a></span><span class="line">                                            <span class="mxinfo " id="T1:U2988"><span class="mxinfo " id="T1:U2989"><span class="mxinfo " id="T5:U2990"><span class="var type1" id="S25T17U4087">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4089">y</span>)</span> = <span class="mxinfo " id="T1:U2993"><span class="mxinfo " id="T1:U2994"><span class="mxinfo " id="T5:U2995"><span class="var type1" id="S25T17U4093">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4095">y</span>)</span> + <span class="mxinfo " id="T1:U2998">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,727" id="srcline727"> 727</a></span><span class="line">                                            [<span class="var type1" id="S70T46U4100">Polyp</span>, <span class="var type1" id="S71T48U4101">Ca</span>, <span class="var type1" id="S72T50U4102">Detected</span>, <span class="var type1" id="S58T44U4103">Included</span>, <span class="var type1" id="S4T2U4104">DeathCause</span>, <span class="var type1" id="S6T2U4105">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,728" id="srcline728"> 728</a></span><span class="line">                                                <span class="var type1" id="S27T8U4106">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4107">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4108">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4109">Last</span>, <span class="var type1" id="S14T6U4110">TumorRecord</span>, <span class="var type1" id="S23T10U4111">PaymentType</span>, <span class="var type1" id="S24T15U4112">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,729" id="srcline729"> 729</a></span><span class="line">                                                = Colonoscopy(<span class="var type1" id="S94T1U4115">z</span>, <span class="var type1" id="S2T1U4116">y</span>, <span class="var type1" id="S95T1U4117">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U4119">Gender</span>, <span class="var type1" id="S70T46U4120">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,730" id="srcline730"> 730</a></span><span class="line">                                                <span class="var type1" id="S71T48U4121">Ca</span>, <span class="var type1" id="S72T50U4122">Detected</span>, <span class="var type1" id="S58T44U4123">Included</span>, <span class="var type1" id="S4T2U4124">DeathCause</span>, <span class="var type1" id="S6T2U4125">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,731" id="srcline731"> 731</a></span><span class="line">                                                <span class="var type1" id="S27T8U4126">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4127">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4128">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4129">Last</span>, <span class="var type1" id="S14T6U4130">TumorRecord</span>, <span class="var type1" id="S23T10U4131">PaymentType</span>, <span class="var type1" id="S24T15U4132">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,732" id="srcline732"> 732</a></span><span class="line">                                                <span class="var type1" id="S32T19U4133">StageVariables</span>, <span class="var type1" id="S34T23U4134">Cost</span>, <span class="var type1" id="S33T21U4135">Location</span>, <span class="var type1" id="S36T26U4136">risc</span>, <span class="var type1" id="S81T62U4137">ColoReachMatrix</span>, <span class="var type1" id="S49T38U4138">MortalityMatrix</span>, <span class="var type1" id="S35T24U4139">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,733" id="srcline733"> 733</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,734" id="srcline734"> 734</a></span><span class="line">                                    <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3036">isequal(<span class="var type1" id="S112T1U4143">preference</span>, <span class="mxinfo " id="T1:U3038">2</span>)</span> <span class="comment">% Rectosigmoidoscopy</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,735" id="srcline735"> 735</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3039"><span class="mxinfo " id="T1:U3040"><span class="var type1" id="S2T1U4149">y</span>-<span class="mxinfo " id="T1:U3042"><span class="mxinfo " id="T2:U3043"><span class="var type1" id="S5T3U4152">Last</span>.ScreenTest</span>(<span class="var type1" id="S94T1U4154">z</span>)</span></span> &gt;= <span class="mxinfo " id="T1:U3046"><span class="var type1" id="S41T32U4156">ScreeningTest</span>(<span class="var type1" id="S112T1U4157">preference</span>, <span class="mxinfo " id="T1:U3049">6</span>)</span></span>  <span class="comment">% interval</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,736" id="srcline736"> 736</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3050"><span class="mxinfo " id="T1:U3051">rand</span> &lt; <span class="mxinfo " id="T1:U3052"><span class="var type1" id="S41T32U4165">ScreeningTest</span>(<span class="var type1" id="S112T1U4166">preference</span>, <span class="mxinfo " id="T54:U3055">2</span>)</span></span> <span class="comment">% compliance with test</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,737" id="srcline737"> 737</a></span><span class="line">                                                <span class="mxinfo " id="T1:U3056"><span class="mxinfo " id="T1:U3057"><span class="mxinfo " id="T5:U3058"><span class="var type1" id="S25T17U4172">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U4174">y</span>)</span> = <span class="mxinfo " id="T1:U3061"><span class="mxinfo " id="T1:U3062"><span class="mxinfo " id="T5:U3063"><span class="var type1" id="S25T17U4178">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U4180">y</span>)</span> + <span class="mxinfo " id="T1:U3066">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,738" id="srcline738"> 738</a></span><span class="line">                                                <span class="mxinfo " id="T1:U3067"><span class="mxinfo " id="T1:U3068"><span class="mxinfo " id="T2:U3069"><span class="var type1" id="S5T3U4186">Last</span>.ScreenTest</span>(<span class="var type1" id="S94T1U4188">z</span>)</span>   = <span class="var type1" id="S2T1U4189">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,739" id="srcline739"> 739</a></span><span class="line">                                                [<span class="var type1" id="S70T46U4193">Polyp</span>, <span class="var type1" id="S113T1U4194">PolypFlag</span>, <span class="var type1" id="S114T1U4195">AdvPolypFlag</span>, <span class="var type1" id="S115T1U4196">CancerFlag</span>, <span class="var type1" id="S23T10U4197">PaymentType</span>, <span class="var type1" id="S24T15U4198">Money</span>, <span class="var type1" id="S58T44U4199">Included</span>, <span class="var type1" id="S4T2U4200">DeathCause</span>, <span class="var type1" id="S6T2U4201">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,740" id="srcline740"> 740</a></span><span class="line">                                                    = RectoSigmo(<span class="var type1" id="S94T1U4204">z</span>, <span class="var type1" id="S2T1U4205">y</span>, <span class="var type1" id="S70T46U4206">Polyp</span>, <span class="var type1" id="S71T48U4207">Ca</span>, <span class="var type1" id="S58T44U4208">Included</span>, <span class="var type1" id="S4T2U4209">DeathCause</span>, <span class="var type1" id="S6T2U4210">DeathYear</span>, <span class="var type1" id="S23T10U4211">PaymentType</span>, <span class="var type1" id="S24T15U4212">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,741" id="srcline741"> 741</a></span><span class="line">                                                    <span class="var type1" id="S32T19U4213">StageVariables</span>, <span class="var type1" id="S34T23U4214">Cost</span>, <span class="var type1" id="S33T21U4215">Location</span>, <span class="var type1" id="S36T26U4216">risc</span>, <span class="var type1" id="S79T62U4217">RectoSigmoReachMatrix</span>, <span class="var type1" id="S37T27U4218">flag</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,742" id="srcline742"> 742</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3097">or(<span class="mxinfo " id="T28:U3098">or(<span class="var type1" id="S113T1U4225">PolypFlag</span>, <span class="var type1" id="S115T1U4226">CancerFlag</span>)</span>, <span class="var type1" id="S114T1U4227">AdvPolypFlag</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,743" id="srcline743"> 743</a></span><span class="line">                                                    <span class="comment">% StageVariables.Colo_Detection(7:10) = 1; % BM 29.5.2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,744" id="srcline744"> 744</a></span><span class="line">                                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3102"><span class="mxinfo " id="T1:U3103">rand</span> &lt; <span class="mxinfo " id="T1:U3104"><span class="var type1" id="S41T32U4234">ScreeningTest</span>(<span class="var type1" id="S112T1U4235">preference</span>, <span class="mxinfo " id="T54:U3107">3</span>)</span></span> <span class="comment">% compliance with follow up kolo</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,745" id="srcline745"> 745</a></span><span class="line">                                                        <span class="mxinfo " id="T1:U3108"><span class="mxinfo " id="T1:U3109"><span class="mxinfo " id="T5:U3110"><span class="var type1" id="S25T17U4241">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4243">y</span>)</span> = <span class="mxinfo " id="T1:U3113"><span class="mxinfo " id="T1:U3114"><span class="mxinfo " id="T5:U3115"><span class="var type1" id="S25T17U4247">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4249">y</span>)</span> + <span class="mxinfo " id="T1:U3118">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,746" id="srcline746"> 746</a></span><span class="line">                                                        <span class="mxinfo " id="T1:U3119"><span class="mxinfo " id="T1:U3120"><span class="var type1" id="S42T2U4254">ScreeningPreference</span>(<span class="var type1" id="S94T1U4255">z</span>)</span> = <span class="mxinfo " id="T1:U3123">1</span></span>; <span class="comment">% according to paper by Zauber et al. we need to continue with colonoscopy screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,747" id="srcline747"> 747</a></span><span class="line">                                                        [<span class="var type1" id="S70T46U4260">Polyp</span>, <span class="var type1" id="S71T48U4261">Ca</span>, <span class="var type1" id="S72T50U4262">Detected</span>, <span class="var type1" id="S58T44U4263">Included</span>, <span class="var type1" id="S4T2U4264">DeathCause</span>, <span class="var type1" id="S6T2U4265">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,748" id="srcline748"> 748</a></span><span class="line">                                                            <span class="var type1" id="S27T8U4266">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4267">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4268">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4269">Last</span>, <span class="var type1" id="S14T6U4270">TumorRecord</span>, <span class="var type1" id="S23T10U4271">PaymentType</span>, <span class="var type1" id="S24T15U4272">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,749" id="srcline749"> 749</a></span><span class="line">                                                            = Colonoscopy(<span class="var type1" id="S94T1U4275">z</span>, <span class="var type1" id="S2T1U4276">y</span>, <span class="var type1" id="S95T1U4277">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U4279">Gender</span>, <span class="var type1" id="S70T46U4280">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,750" id="srcline750"> 750</a></span><span class="line">                                                            <span class="var type1" id="S71T48U4281">Ca</span>, <span class="var type1" id="S72T50U4282">Detected</span>, <span class="var type1" id="S58T44U4283">Included</span>, <span class="var type1" id="S4T2U4284">DeathCause</span>, <span class="var type1" id="S6T2U4285">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,751" id="srcline751"> 751</a></span><span class="line">                                                            <span class="var type1" id="S27T8U4286">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4287">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4288">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4289">Last</span>, <span class="var type1" id="S14T6U4290">TumorRecord</span>, <span class="var type1" id="S23T10U4291">PaymentType</span>, <span class="var type1" id="S24T15U4292">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,752" id="srcline752"> 752</a></span><span class="line">                                                            <span class="var type1" id="S32T19U4293">StageVariables</span>, <span class="var type1" id="S34T23U4294">Cost</span>, <span class="var type1" id="S33T21U4295">Location</span>, <span class="var type1" id="S36T26U4296">risc</span>, <span class="var type1" id="S81T62U4297">ColoReachMatrix</span>, <span class="var type1" id="S49T38U4298">MortalityMatrix</span>, <span class="var type1" id="S35T24U4299">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,753" id="srcline753"> 753</a></span><span class="line">                                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,754" id="srcline754"> 754</a></span><span class="line">                                                    <span class="comment">% StageVariables.Colo_Detection = Colo_Detection_bckup;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,755" id="srcline755"> 755</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,756" id="srcline756"> 756</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,757" id="srcline757"> 757</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,758" id="srcline758"> 758</a></span><span class="line">                                        <span class="comment">%%% we need to fill this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,759" id="srcline759"> 759</a></span><span class="line">                                    <span class="keyword">else</span> <span class="comment">% other test</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,760" id="srcline760"> 760</a></span><span class="line">                                        <span class="comment">% we do the Septin9 or any other test</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,761" id="srcline761"> 761</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3161"><span class="mxinfo " id="T1:U3162"><span class="var type1" id="S2T1U4305">y</span>-<span class="mxinfo " id="T1:U3164"><span class="mxinfo " id="T2:U3165"><span class="var type1" id="S5T3U4308">Last</span>.ScreenTest</span>(<span class="var type1" id="S94T1U4310">z</span>)</span></span> &gt;= <span class="mxinfo " id="T1:U3168"><span class="var type1" id="S41T32U4312">ScreeningTest</span>(<span class="var type1" id="S112T1U4313">preference</span>, <span class="mxinfo " id="T1:U3171">6</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,762" id="srcline762"> 762</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3172"><span class="mxinfo " id="T1:U3173">rand</span> &lt; <span class="mxinfo " id="T1:U3174"><span class="var type1" id="S41T32U4321">ScreeningTest</span>(<span class="var type1" id="S112T1U4322">preference</span>, <span class="mxinfo " id="T54:U3177">2</span>)</span></span> <span class="comment">% compliance with test</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,763" id="srcline763"> 763</a></span><span class="line">                                                <span class="mxinfo " id="T1:U3178"><span class="mxinfo " id="T1:U3179"><span class="mxinfo " id="T2:U3180"><span class="var type1" id="S5T3U4328">Last</span>.ScreenTest</span>(<span class="var type1" id="S94T1U4330">z</span>)</span>   = <span class="var type1" id="S2T1U4331">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,764" id="srcline764"> 764</a></span><span class="line">                                                <span class="mxinfo " id="T1:U3184"><span class="var type1" id="S117T1U4334">Limit</span> = <span class="mxinfo " id="T1:U3186">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,765" id="srcline765"> 765</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3187">~<span class="mxinfo " id="T28:U3188">isempty(<span class="mxinfo " id="T83:U3189">find(<span class="mxinfo " id="T85:U3190"><span class="mxinfo " id="T45:U3191"><span class="var type1" id="S70T46U4345">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U4347">z</span>, <span class="mxinfo " id="T86:U3194">:</span>)</span>, 1, <span class="string">'last'</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,766" id="srcline766"> 766</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3195"><span class="var type1" id="S117T1U4353">Limit</span> = <span class="mxinfo " id="T1:U3197"><span class="var type1" id="S40T31U4355">Sensitivity</span>(<span class="var type1" id="S112T1U4356">preference</span>, <span class="mxinfo " id="T1:U3200">max(<span class="mxinfo " id="T85:U3201"><span class="mxinfo " id="T45:U3202"><span class="var type1" id="S70T46U4361">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U4363">z</span>, <span class="mxinfo " id="T86:U3205">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,767" id="srcline767"> 767</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,768" id="srcline768"> 768</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3206">~<span class="mxinfo " id="T28:U3207">isempty(<span class="mxinfo " id="T83:U3208">find(<span class="mxinfo " id="T73:U3209"><span class="mxinfo " id="T47:U3210"><span class="var type1" id="S71T48U4374">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U4376">z</span>, <span class="mxinfo " id="T76:U3213">:</span>)</span>, 1, <span class="string">'last'</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,769" id="srcline769"> 769</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3214"><span class="var type1" id="S117T1U4382">Limit</span> = <span class="mxinfo " id="T1:U3216"><span class="var type1" id="S40T31U4384">Sensitivity</span>(<span class="var type1" id="S112T1U4385">preference</span>, <span class="mxinfo " id="T1:U3219">max(<span class="mxinfo " id="T73:U3220"><span class="mxinfo " id="T47:U3221"><span class="var type1" id="S71T48U4390">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U4392">z</span>, <span class="mxinfo " id="T76:U3224">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,770" id="srcline770"> 770</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,771" id="srcline771"> 771</a></span><span class="line">                                                <span class="mxinfo " id="T1:U3225"><span class="var type1" id="S117T1U4396">Limit</span> = <span class="mxinfo " id="T1:U3227">max(<span class="var type1" id="S117T1U4399">Limit</span>, <span class="mxinfo " id="T1:U3229"><span class="mxinfo " id="T1:U3230">1</span>-<span class="mxinfo " id="T1:U3231"><span class="var type1" id="S41T32U4403">ScreeningTest</span>(<span class="var type1" id="S112T1U4404">preference</span>, <span class="mxinfo " id="T54:U3234">8</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,772" id="srcline772"> 772</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3235"><span class="mxinfo " id="T1:U3236">rand</span> &lt; <span class="var type1" id="S117T1U4411">Limit</span></span> <span class="comment">% if the test happens to be positive</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,773" id="srcline773"> 773</a></span><span class="line">                                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3238"><span class="mxinfo " id="T1:U3239">rand</span> &lt; <span class="mxinfo " id="T1:U3240"><span class="var type1" id="S41T32U4418">ScreeningTest</span>(<span class="var type1" id="S112T1U4419">preference</span>, <span class="mxinfo " id="T54:U3243">3</span>)</span></span> <span class="comment">% compliance with follow up</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,774" id="srcline774"> 774</a></span><span class="line">                                                        <span class="mxinfo " id="T1:U3244"><span class="mxinfo " id="T1:U3245"><span class="mxinfo " id="T5:U3246"><span class="var type1" id="S25T17U4425">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4427">y</span>)</span> = <span class="mxinfo " id="T1:U3249"><span class="mxinfo " id="T1:U3250"><span class="mxinfo " id="T5:U3251"><span class="var type1" id="S25T17U4431">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U4433">y</span>)</span> + <span class="mxinfo " id="T1:U3254">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,775" id="srcline775"> 775</a></span><span class="line">                                                        <span class="mxinfo " id="T1:U3255"><span class="mxinfo " id="T1:U3256"><span class="var type1" id="S42T2U4438">ScreeningPreference</span>(<span class="var type1" id="S94T1U4439">z</span>)</span> = <span class="mxinfo " id="T1:U3259">1</span></span>; <span class="comment">% according to paper by Zauber et al. we need to continue with colonoscopy screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,776" id="srcline776"> 776</a></span><span class="line">                                                        [<span class="var type1" id="S70T46U4444">Polyp</span>, <span class="var type1" id="S71T48U4445">Ca</span>, <span class="var type1" id="S72T50U4446">Detected</span>, <span class="var type1" id="S58T44U4447">Included</span>, <span class="var type1" id="S4T2U4448">DeathCause</span>, <span class="var type1" id="S6T2U4449">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,777" id="srcline777"> 777</a></span><span class="line">                                                            <span class="var type1" id="S27T8U4450">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4451">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4452">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4453">Last</span>, <span class="var type1" id="S14T6U4454">TumorRecord</span>, <span class="var type1" id="S23T10U4455">PaymentType</span>, <span class="var type1" id="S24T15U4456">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,778" id="srcline778"> 778</a></span><span class="line">                                                            = Colonoscopy(<span class="var type1" id="S94T1U4459">z</span>, <span class="var type1" id="S2T1U4460">y</span>, <span class="var type1" id="S95T1U4461">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U4463">Gender</span>, <span class="var type1" id="S70T46U4464">Polyp</span>, <span class="var type1" id="S71T48U4465">Ca</span>, <span class="var type1" id="S72T50U4466">Detected</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,779" id="srcline779"> 779</a></span><span class="line">                                                            <span class="var type1" id="S58T44U4467">Included</span>, <span class="var type1" id="S4T2U4468">DeathCause</span>, <span class="var type1" id="S6T2U4469">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,780" id="srcline780"> 780</a></span><span class="line">                                                            <span class="var type1" id="S27T8U4470">DiagnosedCancer</span>, <span class="var type1" id="S28T5U4471">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U4472">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U4473">Last</span>, <span class="var type1" id="S14T6U4474">TumorRecord</span>, <span class="var type1" id="S23T10U4475">PaymentType</span>, <span class="var type1" id="S24T15U4476">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,781" id="srcline781"> 781</a></span><span class="line">                                                            <span class="var type1" id="S32T19U4477">StageVariables</span>, <span class="var type1" id="S34T23U4478">Cost</span>, <span class="var type1" id="S33T21U4479">Location</span>, <span class="var type1" id="S36T26U4480">risc</span>, <span class="var type1" id="S81T62U4481">ColoReachMatrix</span>, <span class="var type1" id="S49T38U4482">MortalityMatrix</span>, <span class="var type1" id="S35T24U4483">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,782" id="srcline782"> 782</a></span><span class="line">                                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,783" id="srcline783"> 783</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,784" id="srcline784"> 784</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3297">isequal(<span class="var type1" id="S112T1U4488">preference</span>, <span class="mxinfo " id="T1:U3299">3</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,785" id="srcline785"> 785</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3300"><span class="mxinfo " id="T1:U3301"><span class="mxinfo " id="T5:U3302"><span class="var type1" id="S25T17U4494">Number</span>.FOBT</span>(<span class="var type1" id="S2T1U4496">y</span>)</span> = <span class="mxinfo " id="T1:U3305"><span class="mxinfo " id="T1:U3306"><span class="mxinfo " id="T5:U3307"><span class="var type1" id="S25T17U4500">Number</span>.FOBT</span>(<span class="var type1" id="S2T1U4502">y</span>)</span> +<span class="mxinfo " id="T1:U3310">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,786" id="srcline786"> 786</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3311"><span class="mxinfo " id="T1:U3312"><span class="mxinfo " id="T16:U3313"><span class="var type1" id="S24T15U4508">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4510">y</span>)</span> = <span class="mxinfo " id="T1:U3316"><span class="mxinfo " id="T1:U3317"><span class="mxinfo " id="T16:U3318"><span class="var type1" id="S24T15U4514">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4516">y</span>)</span> + <span class="mxinfo " id="T1:U3321"><span class="var type1" id="S34T23U4518">Cost</span>.FOBT</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,787" id="srcline787"> 787</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3323"><span class="mxinfo " id="T1:U3324"><span class="mxinfo " id="T5:U3325"><span class="var type1" id="S23T10U4524">PaymentType</span>.FOBT</span>(<span class="mxinfo " id="T1:U3327">1</span>, <span class="var type1" id="S2T1U4527">y</span>)</span> = <span class="mxinfo " id="T1:U3329"><span class="mxinfo " id="T1:U3330"><span class="mxinfo " id="T5:U3331"><span class="var type1" id="S23T10U4531">PaymentType</span>.FOBT</span>(<span class="mxinfo " id="T1:U3333">1</span>, <span class="var type1" id="S2T1U4534">y</span>)</span> +<span class="mxinfo " id="T1:U3335">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,788" id="srcline788"> 788</a></span><span class="line">                                                <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3336">isequal(<span class="var type1" id="S112T1U4539">preference</span>, <span class="mxinfo " id="T1:U3338">4</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,789" id="srcline789"> 789</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3339"><span class="mxinfo " id="T1:U3340"><span class="mxinfo " id="T5:U3341"><span class="var type1" id="S25T17U4545">Number</span>.I_FOBT</span>(<span class="var type1" id="S2T1U4547">y</span>)</span>   = <span class="mxinfo " id="T1:U3344"><span class="mxinfo " id="T1:U3345"><span class="mxinfo " id="T5:U3346"><span class="var type1" id="S25T17U4551">Number</span>.I_FOBT</span>(<span class="var type1" id="S2T1U4553">y</span>)</span> +<span class="mxinfo " id="T1:U3349">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,790" id="srcline790"> 790</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3350"><span class="mxinfo " id="T1:U3351"><span class="mxinfo " id="T16:U3352"><span class="var type1" id="S24T15U4559">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4561">y</span>)</span> = <span class="mxinfo " id="T1:U3355"><span class="mxinfo " id="T1:U3356"><span class="mxinfo " id="T16:U3357"><span class="var type1" id="S24T15U4565">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4567">y</span>)</span> + <span class="mxinfo " id="T1:U3360"><span class="var type1" id="S34T23U4569">Cost</span>.I_FOBT</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,791" id="srcline791"> 791</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3362"><span class="mxinfo " id="T1:U3363"><span class="mxinfo " id="T5:U3364"><span class="var type1" id="S23T10U4575">PaymentType</span>.I_FOBT</span>(<span class="mxinfo " id="T1:U3366">1</span>, <span class="var type1" id="S2T1U4578">y</span>)</span> = <span class="mxinfo " id="T1:U3368"><span class="mxinfo " id="T1:U3369"><span class="mxinfo " id="T5:U3370"><span class="var type1" id="S23T10U4582">PaymentType</span>.I_FOBT</span>(<span class="mxinfo " id="T1:U3372">1</span>, <span class="var type1" id="S2T1U4585">y</span>)</span> +<span class="mxinfo " id="T1:U3374">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,792" id="srcline792"> 792</a></span><span class="line">                                                <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3375">isequal(<span class="var type1" id="S112T1U4590">preference</span>, <span class="mxinfo " id="T1:U3377">5</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,793" id="srcline793"> 793</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3378"><span class="mxinfo " id="T1:U3379"><span class="mxinfo " id="T5:U3380"><span class="var type1" id="S25T17U4596">Number</span>.Sept9</span>(<span class="var type1" id="S2T1U4598">y</span>)</span>    = <span class="mxinfo " id="T1:U3383"><span class="mxinfo " id="T1:U3384"><span class="mxinfo " id="T5:U3385"><span class="var type1" id="S25T17U4602">Number</span>.Sept9</span>(<span class="var type1" id="S2T1U4604">y</span>)</span> +<span class="mxinfo " id="T1:U3388">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,794" id="srcline794"> 794</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3389"><span class="mxinfo " id="T1:U3390"><span class="mxinfo " id="T16:U3391"><span class="var type1" id="S24T15U4610">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4612">y</span>)</span> = <span class="mxinfo " id="T1:U3394"><span class="mxinfo " id="T1:U3395"><span class="mxinfo " id="T16:U3396"><span class="var type1" id="S24T15U4616">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4618">y</span>)</span> + <span class="mxinfo " id="T1:U3399"><span class="var type1" id="S34T23U4620">Cost</span>.Sept9_HighSens</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,795" id="srcline795"> 795</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3401"><span class="mxinfo " id="T1:U3402"><span class="mxinfo " id="T5:U3403"><span class="var type1" id="S23T10U4626">PaymentType</span>.Sept9_HighSens</span>(<span class="mxinfo " id="T1:U3405">1</span>, <span class="var type1" id="S2T1U4629">y</span>)</span> = <span class="mxinfo " id="T1:U3407"><span class="mxinfo " id="T1:U3408"><span class="mxinfo " id="T5:U3409"><span class="var type1" id="S23T10U4633">PaymentType</span>.Sept9_HighSens</span>(<span class="mxinfo " id="T1:U3411">1</span>, <span class="var type1" id="S2T1U4636">y</span>)</span> +<span class="mxinfo " id="T1:U3413">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,796" id="srcline796"> 796</a></span><span class="line">                                                <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3414">isequal(<span class="var type1" id="S112T1U4641">preference</span>, <span class="mxinfo " id="T1:U3416">6</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,797" id="srcline797"> 797</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3417"><span class="mxinfo " id="T1:U3418"><span class="mxinfo " id="T5:U3419"><span class="var type1" id="S25T17U4647">Number</span>.Sept9</span>(<span class="var type1" id="S2T1U4649">y</span>)</span>    = <span class="mxinfo " id="T1:U3422"><span class="mxinfo " id="T1:U3423"><span class="mxinfo " id="T5:U3424"><span class="var type1" id="S25T17U4653">Number</span>.Sept9</span>(<span class="var type1" id="S2T1U4655">y</span>)</span> +<span class="mxinfo " id="T1:U3427">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,798" id="srcline798"> 798</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3428"><span class="mxinfo " id="T1:U3429"><span class="mxinfo " id="T16:U3430"><span class="var type1" id="S24T15U4661">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4663">y</span>)</span> = <span class="mxinfo " id="T1:U3433"><span class="mxinfo " id="T1:U3434"><span class="mxinfo " id="T16:U3435"><span class="var type1" id="S24T15U4667">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4669">y</span>)</span> + <span class="mxinfo " id="T1:U3438"><span class="var type1" id="S34T23U4671">Cost</span>.Sept9_HighSpec</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,799" id="srcline799"> 799</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3440"><span class="mxinfo " id="T1:U3441"><span class="mxinfo " id="T5:U3442"><span class="var type1" id="S23T10U4677">PaymentType</span>.Sept9_HighSpec</span>(<span class="mxinfo " id="T1:U3444">1</span>, <span class="var type1" id="S2T1U4680">y</span>)</span> = <span class="mxinfo " id="T1:U3446"><span class="mxinfo " id="T1:U3447"><span class="mxinfo " id="T5:U3448"><span class="var type1" id="S23T10U4684">PaymentType</span>.Sept9_HighSpec</span>(<span class="mxinfo " id="T1:U3450">1</span>, <span class="var type1" id="S2T1U4687">y</span>)</span> +<span class="mxinfo " id="T1:U3452">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,800" id="srcline800"> 800</a></span><span class="line">                                                <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3453">isequal(<span class="var type1" id="S112T1U4692">preference</span>, <span class="mxinfo " id="T1:U3455">7</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,801" id="srcline801"> 801</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3456"><span class="mxinfo " id="T1:U3457"><span class="mxinfo " id="T5:U3458"><span class="var type1" id="S25T17U4698">Number</span>.other</span>(<span class="var type1" id="S2T1U4700">y</span>)</span>    = <span class="mxinfo " id="T1:U3461"><span class="mxinfo " id="T1:U3462"><span class="mxinfo " id="T5:U3463"><span class="var type1" id="S25T17U4704">Number</span>.other</span>(<span class="var type1" id="S2T1U4706">y</span>)</span> +<span class="mxinfo " id="T1:U3466">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,802" id="srcline802"> 802</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3467"><span class="mxinfo " id="T1:U3468"><span class="mxinfo " id="T16:U3469"><span class="var type1" id="S24T15U4712">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4714">y</span>)</span> = <span class="mxinfo " id="T1:U3472"><span class="mxinfo " id="T1:U3473"><span class="mxinfo " id="T16:U3474"><span class="var type1" id="S24T15U4718">Money</span>.Screening</span>(<span class="var type1" id="S2T1U4720">y</span>)</span> + <span class="mxinfo " id="T1:U3477"><span class="var type1" id="S34T23U4722">Cost</span>.other</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,803" id="srcline803"> 803</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3479"><span class="mxinfo " id="T1:U3480"><span class="mxinfo " id="T5:U3481"><span class="var type1" id="S23T10U4728">PaymentType</span>.Other</span>(<span class="mxinfo " id="T1:U3483">1</span>, <span class="var type1" id="S2T1U4731">y</span>)</span> = <span class="mxinfo " id="T1:U3485"><span class="mxinfo " id="T1:U3486"><span class="mxinfo " id="T5:U3487"><span class="var type1" id="S23T10U4735">PaymentType</span>.Other</span>(<span class="mxinfo " id="T1:U3489">1</span>, <span class="var type1" id="S2T1U4738">y</span>)</span> +<span class="mxinfo " id="T1:U3491">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,804" id="srcline804"> 804</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,805" id="srcline805"> 805</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,806" id="srcline806"> 806</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,807" id="srcline807"> 807</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,808" id="srcline808"> 808</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,809" id="srcline809"> 809</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,810" id="srcline810"> 810</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,811" id="srcline811"> 811</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,812" id="srcline812"> 812</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,813" id="srcline813"> 813</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,814" id="srcline814"> 814</a></span><span class="line">                    <span class="comment">%    special scenarios              %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,815" id="srcline815"> 815</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,816" id="srcline816"> 816</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,817" id="srcline817"> 817</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3492">and(<span class="mxinfo " id="T28:U3493"><span class="var type1" id="S37T27U4745">flag</span>.SpecialFlag</span>, <span class="mxinfo " id="T28:U3495">isequal(<span class="var type1" id="S95T1U4749">q</span>, <span class="mxinfo " id="T1:U3497">1</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,818" id="srcline818"> 818</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3498"><span class="var type1" id="S37T27U4754">flag</span>.Atkin</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,819" id="srcline819"> 819</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3500">isequal(<span class="var type1" id="S2T1U4760">y</span>,<span class="mxinfo " id="T1:U3502">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,820" id="srcline820"> 820</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3503">isequal(<span class="var type1" id="S94T1U4766">z</span>, <span class="mxinfo " id="T1:U3505">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,821" id="srcline821"> 821</a></span><span class="line">                                    <span class="comment">% randomly one test year between 55 and 64</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,822" id="srcline822"> 822</a></span><span class="line">                                    <span class="mxinfo " id="T20:U3506"><span class="var type1" id="S108T20U4770">tmp</span>=<span class="mxinfo " id="T20:U3508">55:64</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,823" id="srcline823"> 823</a></span><span class="line">                                    <span class="keyword">for</span> <span class="var type1" id="S77T1U4776">f</span>=<span class="mxinfo " id="T1:U3510">1</span>:<span class="var type1" id="S57T1U4779">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,824" id="srcline824"> 824</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3512"><span class="mxinfo " id="T1:U3513"><span class="mxinfo " id="T2:U3514"><span class="var type1" id="S5T3U4784">Last</span>.Included</span>(<span class="var type1" id="S77T1U4786">f</span>)</span> = <span class="mxinfo " id="T1:U3517"><span class="var type1" id="S108T20U4788">tmp</span>(<span class="mxinfo " id="T1:U3519">round(<span class="mxinfo " id="T1:U3520"><span class="mxinfo " id="T1:U3521"><span class="mxinfo " id="T1:U3522">rand</span>*(<span class="mxinfo " id="T1:U3523"><span class="mxinfo " id="T1:U3524">length(<span class="var type1" id="S108T20U4799">tmp</span>)</span>-<span class="mxinfo " id="T1:U3526">1</span></span>)</span>+<span class="mxinfo " id="T1:U3527">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,825" id="srcline825"> 825</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3528"><span class="mxinfo " id="T1:U3529">rand</span> &lt; <span class="mxinfo " id="T1:U3530">0.71</span></span> <span class="comment">% adherence to first screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,826" id="srcline826"> 826</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3531"><span class="mxinfo " id="T1:U3532"><span class="mxinfo " id="T2:U3533"><span class="var type1" id="S5T3U4812">Last</span>.TestYear</span>(<span class="var type1" id="S77T1U4814">f</span>)</span> = <span class="mxinfo " id="T1:U3536"><span class="mxinfo " id="T2:U3537"><span class="var type1" id="S5T3U4817">Last</span>.Included</span>(<span class="var type1" id="S77T1U4819">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,827" id="srcline827"> 827</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,828" id="srcline828"> 828</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,829" id="srcline829"> 829</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,830" id="srcline830"> 830</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,831" id="srcline831"> 831</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3540">isequal(<span class="mxinfo " id="T1:U3541"><span class="mxinfo " id="T2:U3542"><span class="var type1" id="S5T3U4827">Last</span>.Included</span>(<span class="var type1" id="S94T1U4829">z</span>)</span>, <span class="var type1" id="S2T1U4830">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,832" id="srcline832"> 832</a></span><span class="line">                                    <span class="comment">% we need to check inclusion criteria</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,833" id="srcline833"> 833</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,834" id="srcline834"> 834</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3546"><span class="var type1" id="S118T28U4833">StudyFlag</span> = <span class="mxinfo " id="T28:U3548">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,835" id="srcline835"> 835</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3549"><span class="var type1" id="S118T28U4838">StudyFlag</span> = <span class="mxinfo " id="T28:U3551">and(<span class="var type1" id="S118T28U4841">StudyFlag</span>, <span class="mxinfo " id="T28:U3553"><span class="mxinfo " id="T1:U3554"><span class="var type1" id="S2T1U4844">y</span>-<span class="mxinfo " id="T1:U3556"><span class="mxinfo " id="T2:U3557"><span class="var type1" id="S5T3U4847">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U4849">z</span>)</span></span>&gt;<span class="mxinfo " id="T1:U3560">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,836" id="srcline836"> 836</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3561"><span class="var type1" id="S118T28U4853">StudyFlag</span> = <span class="mxinfo " id="T28:U3563">and(<span class="var type1" id="S118T28U4856">StudyFlag</span>, <span class="mxinfo " id="T28:U3565">isequal(<span class="mxinfo " id="T1:U3566"><span class="mxinfo " id="T2:U3567"><span class="var type1" id="S5T3U4861">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U4863">z</span>)</span>,<span class="mxinfo " id="T1:U3570">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,837" id="srcline837"> 837</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3571"><span class="var type1" id="S118T28U4868">StudyFlag</span> = <span class="mxinfo " id="T28:U3573">and(<span class="var type1" id="S118T28U4871">StudyFlag</span>, <span class="mxinfo " id="T28:U3575">isequal(<span class="mxinfo " id="T1:U3576"><span class="mxinfo " id="T2:U3577"><span class="var type1" id="S5T3U4876">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U4878">z</span>)</span>,<span class="mxinfo " id="T1:U3580">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,838" id="srcline838"> 838</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3581"><span class="var type1" id="S118T28U4883">StudyFlag</span> = <span class="mxinfo " id="T28:U3583">and(<span class="var type1" id="S118T28U4886">StudyFlag</span>, <span class="mxinfo " id="T28:U3585">isequal(<span class="mxinfo " id="T1:U3586"><span class="mxinfo " id="T2:U3587"><span class="var type1" id="S5T3U4891">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U4893">z</span>)</span>,<span class="mxinfo " id="T1:U3590">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,839" id="srcline839"> 839</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,840" id="srcline840"> 840</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3591">~<span class="var type1" id="S118T28U4899">StudyFlag</span></span> <span class="comment">% we exclude the patient by setting the years to -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,841" id="srcline841"> 841</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3593"><span class="mxinfo " id="T1:U3594"><span class="mxinfo " id="T2:U3595"><span class="var type1" id="S5T3U4904">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U4906">z</span>)</span>  = <span class="mxinfo " id="T1:U3598">-<span class="mxinfo " id="T1:U3599">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,842" id="srcline842"> 842</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3600"><span class="mxinfo " id="T1:U3601"><span class="mxinfo " id="T2:U3602"><span class="var type1" id="S5T3U4913">Last</span>.TestYear2</span>(<span class="var type1" id="S94T1U4915">z</span>)</span> = <span class="mxinfo " id="T1:U3605">-<span class="mxinfo " id="T1:U3606">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,843" id="srcline843"> 843</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3607"><span class="mxinfo " id="T1:U3608"><span class="mxinfo " id="T2:U3609"><span class="var type1" id="S5T3U4922">Last</span>.Included</span>(<span class="var type1" id="S94T1U4924">z</span>)</span>  = <span class="mxinfo " id="T1:U3612">-<span class="mxinfo " id="T1:U3613">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,844" id="srcline844"> 844</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,845" id="srcline845"> 845</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,846" id="srcline846"> 846</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3614">isequal(<span class="mxinfo " id="T1:U3615"><span class="mxinfo " id="T2:U3616"><span class="var type1" id="S5T3U4933">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U4935">z</span>)</span>, <span class="var type1" id="S2T1U4936">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,847" id="srcline847"> 847</a></span><span class="line">                                    <span class="mxinfo " id="T1:U3620"><span class="mxinfo " id="T1:U3621"><span class="mxinfo " id="T2:U3622"><span class="var type1" id="S5T3U4941">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U4943">z</span>)</span> = <span class="mxinfo " id="T1:U3625">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,848" id="srcline848"> 848</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3626">~<span class="mxinfo " id="T28:U3627"><span class="var type1" id="S37T27U4949">flag</span>.Mock</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,849" id="srcline849"> 849</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3629"><span class="mxinfo " id="T1:U3630"><span class="mxinfo " id="T5:U3631"><span class="var type1" id="S25T17U4955">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U4957">y</span>)</span> = <span class="mxinfo " id="T1:U3634"><span class="mxinfo " id="T1:U3635"><span class="mxinfo " id="T5:U3636"><span class="var type1" id="S25T17U4961">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U4963">y</span>)</span> + <span class="mxinfo " id="T1:U3639">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,850" id="srcline850"> 850</a></span><span class="line">                                        <span class="comment">% Number.Custom(y)     = Number.Custom(y) + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,851" id="srcline851"> 851</a></span><span class="line">                                        [<span class="var type1" id="S70T46U4968">Polyp</span>, <span class="var type1" id="S113T1U4969">PolypFlag</span>, <span class="var type1" id="S114T1U4970">AdvPolypFlag</span>, <span class="var type1" id="S115T1U4971">CancerFlag</span>, <span class="var type1" id="S23T10U4972">PaymentType</span>, <span class="var type1" id="S24T15U4973">Money</span>, <span class="var type1" id="S58T44U4974">Included</span>, <span class="var type1" id="S4T2U4975">DeathCause</span>, <span class="var type1" id="S6T2U4976">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,852" id="srcline852"> 852</a></span><span class="line">                                            = RectoSigmo(<span class="var type1" id="S94T1U4979">z</span>, <span class="var type1" id="S2T1U4980">y</span>, <span class="var type1" id="S70T46U4981">Polyp</span>, <span class="var type1" id="S71T48U4982">Ca</span>, <span class="var type1" id="S58T44U4983">Included</span>, <span class="var type1" id="S4T2U4984">DeathCause</span>, <span class="var type1" id="S6T2U4985">DeathYear</span>, <span class="var type1" id="S23T10U4986">PaymentType</span>, <span class="var type1" id="S24T15U4987">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,853" id="srcline853"> 853</a></span><span class="line">                                            <span class="var type1" id="S32T19U4988">StageVariables</span>, <span class="var type1" id="S34T23U4989">Cost</span>, <span class="var type1" id="S33T21U4990">Location</span>, <span class="var type1" id="S36T26U4991">risc</span>, <span class="var type1" id="S79T62U4992">RectoSigmoReachMatrix</span>, <span class="var type1" id="S37T27U4993">flag</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,854" id="srcline854"> 854</a></span><span class="line">                                        <span class="keyword">if</span> <span class="var type1" id="S114T1U4996">AdvPolypFlag</span>  <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,855" id="srcline855"> 855</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3665"><span class="mxinfo " id="T1:U3666"><span class="mxinfo " id="T2:U3667"><span class="var type1" id="S5T3U5001">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U5003">z</span>)</span> = <span class="var type1" id="S2T1U5004">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,856" id="srcline856"> 856</a></span><span class="line">                                        <span class="keyword">elseif</span> <span class="var type1" id="S113T1U5006">PolypFlag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,857" id="srcline857"> 857</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3672"><span class="mxinfo " id="T1:U3673"><span class="mxinfo " id="T2:U3674"><span class="var type1" id="S5T3U5011">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U5013">z</span>)</span> = <span class="var type1" id="S2T1U5014">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,858" id="srcline858"> 858</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,859" id="srcline859"> 859</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3678">or(<span class="var type1" id="S114T1U5019">AdvPolypFlag</span>, <span class="var type1" id="S115T1U5020">CancerFlag</span>)</span> <span class="comment">%m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,860" id="srcline860"> 860</a></span><span class="line">                                            <span class="keyword">if</span> <span class="var type1" id="S113T1U5023">PolypFlag</span>, <span class="mxinfo " id="T1:U3682"><span class="var type1" id="S67T1U5026">PosPolyp</span> = <span class="mxinfo " id="T1:U3684"><span class="var type1" id="S67T1U5028">PosPolyp</span> + <span class="mxinfo " id="T1:U3686">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,861" id="srcline861"> 861</a></span><span class="line">                                            <span class="keyword">if</span> <span class="var type1" id="S115T1U5032">CancerFlag</span>, <span class="mxinfo " id="T1:U3688"><span class="var type1" id="S68T1U5035">PosCa</span> = <span class="mxinfo " id="T1:U3690"><span class="var type1" id="S68T1U5037">PosCa</span> + <span class="mxinfo " id="T1:U3692">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,862" id="srcline862"> 862</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3693">and(<span class="var type1" id="S115T1U5043">CancerFlag</span>, <span class="var type1" id="S113T1U5044">PolypFlag</span>)</span>, <span class="mxinfo " id="T1:U3696"><span class="var type1" id="S69T1U5047">PosPolypCa</span> = <span class="mxinfo " id="T1:U3698"><span class="var type1" id="S69T1U5049">PosPolypCa</span> + <span class="mxinfo " id="T1:U3700">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,863" id="srcline863"> 863</a></span><span class="line">                                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,864" id="srcline864"> 864</a></span><span class="line">                                            <span class="comment">% StageVariables.Colo_Detection(7:10) = 1; % BM 29.5.2017</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,865" id="srcline865"> 865</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3701"><span class="mxinfo " id="T1:U3702"><span class="mxinfo " id="T5:U3703"><span class="var type1" id="S25T17U5055">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5057">y</span>)</span> = <span class="mxinfo " id="T1:U3706"><span class="mxinfo " id="T1:U3707"><span class="mxinfo " id="T5:U3708"><span class="var type1" id="S25T17U5061">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5063">y</span>)</span> + <span class="mxinfo " id="T1:U3711">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,866" id="srcline866"> 866</a></span><span class="line">                                            [<span class="var type1" id="S70T46U5068">Polyp</span>, <span class="var type1" id="S71T48U5069">Ca</span>, <span class="var type1" id="S72T50U5070">Detected</span>, <span class="var type1" id="S58T44U5071">Included</span>, <span class="var type1" id="S4T2U5072">DeathCause</span>, <span class="var type1" id="S6T2U5073">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,867" id="srcline867"> 867</a></span><span class="line">                                                <span class="var type1" id="S27T8U5074">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5075">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5076">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5077">Last</span>, <span class="var type1" id="S14T6U5078">TumorRecord</span>, <span class="var type1" id="S23T10U5079">PaymentType</span>, <span class="var type1" id="S24T15U5080">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,868" id="srcline868"> 868</a></span><span class="line">                                                = Colonoscopy(<span class="var type1" id="S94T1U5083">z</span>, <span class="var type1" id="S2T1U5084">y</span>, <span class="var type1" id="S95T1U5085">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U5087">Gender</span>, <span class="var type1" id="S70T46U5088">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,869" id="srcline869"> 869</a></span><span class="line">                                                <span class="var type1" id="S71T48U5089">Ca</span>, <span class="var type1" id="S72T50U5090">Detected</span>, <span class="var type1" id="S58T44U5091">Included</span>, <span class="var type1" id="S4T2U5092">DeathCause</span>, <span class="var type1" id="S6T2U5093">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,870" id="srcline870"> 870</a></span><span class="line">                                                <span class="var type1" id="S27T8U5094">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5095">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5096">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5097">Last</span>, <span class="var type1" id="S14T6U5098">TumorRecord</span>, <span class="var type1" id="S23T10U5099">PaymentType</span>, <span class="var type1" id="S24T15U5100">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,871" id="srcline871"> 871</a></span><span class="line">                                                <span class="var type1" id="S32T19U5101">StageVariables</span>, <span class="var type1" id="S34T23U5102">Cost</span>, <span class="var type1" id="S33T21U5103">Location</span>, <span class="var type1" id="S36T26U5104">risc</span>, <span class="var type1" id="S81T62U5105">ColoReachMatrix</span>, <span class="var type1" id="S49T38U5106">MortalityMatrix</span>, <span class="var type1" id="S35T24U5107">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,872" id="srcline872"> 872</a></span><span class="line">                                            <span class="comment">% StageVariables.Colo_Detection = Colo_Detection_bckup;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,873" id="srcline873"> 873</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,874" id="srcline874"> 874</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,875" id="srcline875"> 875</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,876" id="srcline876"> 876</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,877" id="srcline877"> 877</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3749"><span class="var type1" id="S37T27U5110">flag</span>.Schoen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,878" id="srcline878"> 878</a></span><span class="line">                            <span class="comment">% for this validation we use the study by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,879" id="srcline879"> 879</a></span><span class="line">                            <span class="comment">% Schoen et al., NEJM 2012.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,880" id="srcline880"> 880</a></span><span class="line">                            <span class="comment">% patients aged 55-74 were 1:1 randomized to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,881" id="srcline881"> 881</a></span><span class="line">                            <span class="comment">% undergo two rectosigmoidoscopies. adherence for the first RS: 83.5%, </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,882" id="srcline882"> 882</a></span><span class="line">                            <span class="comment">% to the second RS: 54%. "In the intervention</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,883" id="srcline883"> 883</a></span><span class="line">                            <span class="comment">% group, 83.5% of the participants underwent baseline screening and </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,884" id="srcline884"> 884</a></span><span class="line">                            <span class="comment">% 54.0% underwent subsequent screening. A </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,885" id="srcline885"> 885</a></span><span class="line">                            <span class="comment">% total of 86.6% of participants underwent at least one flexible </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,886" id="srcline886"> 886</a></span><span class="line">                            <span class="comment">% sigmoidoscopic screening, and 50.9% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,887" id="srcline887"> 887</a></span><span class="line">                        <span class="comment">%if strcmp(SpecialText, 'RS-RCT')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,888" id="srcline888"> 888</a></span><span class="line">                            <span class="comment">%SpecialText</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,889" id="srcline889"> 889</a></span><span class="line">                            <span class="comment">%fprintf('reached here 54 ')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,890" id="srcline890"> 890</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3751">isequal(<span class="var type1" id="S2T1U5116">y</span>,<span class="mxinfo " id="T1:U3753">1</span>)</span> <span class="comment">% for the first year, for the first patient we setup this validation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,891" id="srcline891"> 891</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3754">isequal(<span class="var type1" id="S94T1U5122">z</span>, <span class="mxinfo " id="T1:U3756">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,892" id="srcline892"> 892</a></span><span class="line">                                    <span class="comment">% randomly one test year between 55 and 74</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,893" id="srcline893"> 893</a></span><span class="line">                                    <span class="mxinfo " id="T98:U3757"><span class="var type1" id="S108T98U5126">tmp</span>=<span class="mxinfo " id="T98:U3759">55:74</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,894" id="srcline894"> 894</a></span><span class="line">                                    <span class="keyword">for</span> <span class="var type1" id="S77T1U5132">f</span>=<span class="mxinfo " id="T1:U3761">1</span>:<span class="var type1" id="S57T1U5135">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,895" id="srcline895"> 895</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3763"><span class="mxinfo " id="T1:U3764"><span class="mxinfo " id="T2:U3765"><span class="var type1" id="S5T3U5140">Last</span>.Included</span>(<span class="var type1" id="S77T1U5142">f</span>)</span> = <span class="mxinfo " id="T1:U3768"><span class="var type1" id="S108T98U5144">tmp</span>(<span class="mxinfo " id="T1:U3770">round(<span class="mxinfo " id="T1:U3771"><span class="mxinfo " id="T1:U3772"><span class="mxinfo " id="T1:U3773">rand</span>*(<span class="mxinfo " id="T1:U3774"><span class="mxinfo " id="T1:U3775">length(<span class="var type1" id="S108T98U5155">tmp</span>)</span>-<span class="mxinfo " id="T1:U3777">1</span></span>)</span>+<span class="mxinfo " id="T1:U3778">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,896" id="srcline896"> 896</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3779"><span class="mxinfo " id="T1:U3780">rand</span> &lt; <span class="mxinfo " id="T1:U3781">0.83</span></span> <span class="comment">% adherence to first screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,897" id="srcline897"> 897</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3782"><span class="mxinfo " id="T1:U3783"><span class="mxinfo " id="T2:U3784"><span class="var type1" id="S5T3U5168">Last</span>.TestYear</span>(<span class="var type1" id="S77T1U5170">f</span>)</span> = <span class="mxinfo " id="T1:U3787"><span class="mxinfo " id="T2:U3788"><span class="var type1" id="S5T3U5173">Last</span>.Included</span>(<span class="var type1" id="S77T1U5175">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,898" id="srcline898"> 898</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U3791"><span class="mxinfo " id="T1:U3792">rand</span> &lt; <span class="mxinfo " id="T1:U3793">0.65</span></span> <span class="comment">%0.54/0.83 % 54% of all individuals (more of the 83% screened individuals)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,899" id="srcline899"> 899</a></span><span class="line">                                                <span class="comment">% in the first 2 years</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,900" id="srcline900"> 900</a></span><span class="line">                                                <span class="comment">% second screening after 3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,901" id="srcline901"> 901</a></span><span class="line">                                                <span class="comment">% years, last 6y after 5y</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,902" id="srcline902"> 902</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3794"><span class="mxinfo " id="T1:U3795">rand</span> &lt;<span class="mxinfo " id="T1:U3796">0.25</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,903" id="srcline903"> 903</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3797"><span class="mxinfo " id="T1:U3798"><span class="mxinfo " id="T2:U3799"><span class="var type1" id="S5T3U5192">Last</span>.TestYear2</span>(<span class="var type1" id="S77T1U5194">f</span>)</span> = <span class="mxinfo " id="T1:U3802"><span class="mxinfo " id="T1:U3803"><span class="mxinfo " id="T2:U3804"><span class="var type1" id="S5T3U5198">Last</span>.Included</span>(<span class="var type1" id="S77T1U5200">f</span>)</span> + <span class="mxinfo " id="T1:U3807">3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,904" id="srcline904"> 904</a></span><span class="line">                                                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,905" id="srcline905"> 905</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3808"><span class="mxinfo " id="T1:U3809"><span class="mxinfo " id="T2:U3810"><span class="var type1" id="S5T3U5207">Last</span>.TestYear2</span>(<span class="var type1" id="S77T1U5209">f</span>)</span> = <span class="mxinfo " id="T1:U3813"><span class="mxinfo " id="T1:U3814"><span class="mxinfo " id="T2:U3815"><span class="var type1" id="S5T3U5213">Last</span>.Included</span>(<span class="var type1" id="S77T1U5215">f</span>)</span> + <span class="mxinfo " id="T1:U3818">5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,906" id="srcline906"> 906</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,907" id="srcline907"> 907</a></span><span class="line">                                            <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U3819"><span class="mxinfo " id="T1:U3820">rand</span> &lt; <span class="mxinfo " id="T1:U3821">0.035</span></span> <span class="comment">% only second screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,908" id="srcline908"> 908</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3822"><span class="mxinfo " id="T1:U3823">rand</span> &lt;<span class="mxinfo " id="T1:U3824">0.25</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,909" id="srcline909"> 909</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3825"><span class="mxinfo " id="T1:U3826"><span class="mxinfo " id="T2:U3827"><span class="var type1" id="S5T3U5232">Last</span>.TestYear2</span>(<span class="var type1" id="S77T1U5234">f</span>)</span> = <span class="mxinfo " id="T1:U3830"><span class="mxinfo " id="T1:U3831"><span class="mxinfo " id="T2:U3832"><span class="var type1" id="S5T3U5238">Last</span>.Included</span>(<span class="var type1" id="S77T1U5240">f</span>)</span> + <span class="mxinfo " id="T1:U3835">3</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,910" id="srcline910"> 910</a></span><span class="line">                                                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,911" id="srcline911"> 911</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U3836"><span class="mxinfo " id="T1:U3837"><span class="mxinfo " id="T2:U3838"><span class="var type1" id="S5T3U5247">Last</span>.TestYear2</span>(<span class="var type1" id="S77T1U5249">f</span>)</span> = <span class="mxinfo " id="T1:U3841"><span class="mxinfo " id="T1:U3842"><span class="mxinfo " id="T2:U3843"><span class="var type1" id="S5T3U5253">Last</span>.Included</span>(<span class="var type1" id="S77T1U5255">f</span>)</span> + <span class="mxinfo " id="T1:U3846">5</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,912" id="srcline912"> 912</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,913" id="srcline913"> 913</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,914" id="srcline914"> 914</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,915" id="srcline915"> 915</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,916" id="srcline916"> 916</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,917" id="srcline917"> 917</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,918" id="srcline918"> 918</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3847">isequal(<span class="mxinfo " id="T1:U3848"><span class="mxinfo " id="T2:U3849"><span class="var type1" id="S5T3U5264">Last</span>.Included</span>(<span class="var type1" id="S94T1U5266">z</span>)</span>, <span class="var type1" id="S2T1U5267">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,919" id="srcline919"> 919</a></span><span class="line">                                    <span class="comment">% we need to check inclusion and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,920" id="srcline920"> 920</a></span><span class="line">                                    <span class="comment">% exclusion criteria at the year of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,921" id="srcline921"> 921</a></span><span class="line">                                    <span class="comment">% inclusion, first quarter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,922" id="srcline922"> 922</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3853"><span class="var type1" id="S118T28U5270">StudyFlag</span> = <span class="mxinfo " id="T28:U3855">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,923" id="srcline923"> 923</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3856"><span class="var type1" id="S118T28U5275">StudyFlag</span> = <span class="mxinfo " id="T28:U3858">and(<span class="var type1" id="S118T28U5278">StudyFlag</span>, <span class="mxinfo " id="T28:U3860"><span class="mxinfo " id="T1:U3861"><span class="var type1" id="S2T1U5281">y</span>-<span class="mxinfo " id="T1:U3863"><span class="mxinfo " id="T2:U3864"><span class="var type1" id="S5T3U5284">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U5286">z</span>)</span></span>&gt;<span class="mxinfo " id="T1:U3867">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,924" id="srcline924"> 924</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3868"><span class="mxinfo " id="T1:U3869"><span class="var type1" id="S2T1U5292">y</span>-<span class="mxinfo " id="T1:U3871"><span class="mxinfo " id="T2:U3872"><span class="var type1" id="S5T3U5295">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U5297">z</span>)</span></span>&lt;=<span class="mxinfo " id="T1:U3875">3</span></span>, <span class="mxinfo " id="T1:U3876"><span class="var type1" id="S66T1U5301">AusschlussKolo</span> = <span class="mxinfo " id="T1:U3878"><span class="var type1" id="S66T1U5303">AusschlussKolo</span> +<span class="mxinfo " id="T1:U3880">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,925" id="srcline925"> 925</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3881"><span class="var type1" id="S118T28U5307">StudyFlag</span> = <span class="mxinfo " id="T28:U3883">and(<span class="var type1" id="S118T28U5310">StudyFlag</span>, <span class="mxinfo " id="T28:U3885">isequal(<span class="mxinfo " id="T1:U3886"><span class="mxinfo " id="T2:U3887"><span class="var type1" id="S5T3U5315">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U5317">z</span>)</span>,<span class="mxinfo " id="T1:U3890">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,926" id="srcline926"> 926</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3891">~<span class="mxinfo " id="T28:U3892">isequal(<span class="mxinfo " id="T1:U3893"><span class="mxinfo " id="T2:U3894"><span class="var type1" id="S5T3U5327">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U5329">z</span>)</span>,<span class="mxinfo " id="T1:U3897">-100</span>)</span></span>, <span class="mxinfo " id="T1:U3898"><span class="var type1" id="S65T1U5334">AusschlussCa</span> = <span class="mxinfo " id="T1:U3900"><span class="var type1" id="S65T1U5336">AusschlussCa</span> +<span class="mxinfo " id="T1:U3902">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,927" id="srcline927"> 927</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3903"><span class="var type1" id="S118T28U5340">StudyFlag</span> = <span class="mxinfo " id="T28:U3905">and(<span class="var type1" id="S118T28U5343">StudyFlag</span>, <span class="mxinfo " id="T28:U3907">isequal(<span class="mxinfo " id="T1:U3908"><span class="mxinfo " id="T2:U3909"><span class="var type1" id="S5T3U5348">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U5350">z</span>)</span>,<span class="mxinfo " id="T1:U3912">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,928" id="srcline928"> 928</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3913">or(<span class="mxinfo " id="T28:U3914">~<span class="mxinfo " id="T28:U3915">isequal(<span class="mxinfo " id="T1:U3916"><span class="mxinfo " id="T2:U3917"><span class="var type1" id="S5T3U5362">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U5364">z</span>)</span>,<span class="mxinfo " id="T1:U3920">-100</span>)</span></span>, <span class="mxinfo " id="T28:U3921">~<span class="mxinfo " id="T28:U3922">isequal(<span class="mxinfo " id="T1:U3923"><span class="mxinfo " id="T2:U3924"><span class="var type1" id="S5T3U5372">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U5374">z</span>)</span>,<span class="mxinfo " id="T1:U3927">-100</span>)</span></span>)</span>,</span></span>
<span class="srcline"><span class="lineno"><a href="1,929" id="srcline929"> 929</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3928"><span class="var type1" id="S64T1U5379">AusschlussPolyp</span> = <span class="mxinfo " id="T1:U3930"><span class="var type1" id="S64T1U5381">AusschlussPolyp</span> + <span class="mxinfo " id="T1:U3932">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,930" id="srcline930"> 930</a></span><span class="line">                                    <span class="mxinfo " id="T28:U3933"><span class="var type1" id="S118T28U5385">StudyFlag</span> = <span class="mxinfo " id="T28:U3935">and(<span class="var type1" id="S118T28U5388">StudyFlag</span>, <span class="mxinfo " id="T28:U3937">isequal(<span class="mxinfo " id="T1:U3938"><span class="mxinfo " id="T2:U3939"><span class="var type1" id="S5T3U5393">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U5395">z</span>)</span>,<span class="mxinfo " id="T1:U3942">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,931" id="srcline931"> 931</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,932" id="srcline932"> 932</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3943">~<span class="var type1" id="S118T28U5401">StudyFlag</span></span> <span class="comment">% we exclude the patient by setting the years to -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,933" id="srcline933"> 933</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3945"><span class="mxinfo " id="T1:U3946"><span class="mxinfo " id="T2:U3947"><span class="var type1" id="S5T3U5406">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U5408">z</span>)</span>  = <span class="mxinfo " id="T1:U3950">-<span class="mxinfo " id="T1:U3951">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,934" id="srcline934"> 934</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3952"><span class="mxinfo " id="T1:U3953"><span class="mxinfo " id="T2:U3954"><span class="var type1" id="S5T3U5415">Last</span>.TestYear2</span>(<span class="var type1" id="S94T1U5417">z</span>)</span> = <span class="mxinfo " id="T1:U3957">-<span class="mxinfo " id="T1:U3958">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,935" id="srcline935"> 935</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3959"><span class="mxinfo " id="T1:U3960"><span class="mxinfo " id="T2:U3961"><span class="var type1" id="S5T3U5424">Last</span>.Included</span>(<span class="var type1" id="S94T1U5426">z</span>)</span>  = <span class="mxinfo " id="T1:U3964">-<span class="mxinfo " id="T1:U3965">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,936" id="srcline936"> 936</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,937" id="srcline937"> 937</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,938" id="srcline938"> 938</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U3966">or(<span class="mxinfo " id="T28:U3967">isequal(<span class="mxinfo " id="T1:U3968"><span class="mxinfo " id="T2:U3969"><span class="var type1" id="S5T3U5437">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U5439">z</span>)</span>, <span class="var type1" id="S2T1U5440">y</span>)</span>, <span class="mxinfo " id="T28:U3973">isequal(<span class="mxinfo " id="T1:U3974"><span class="mxinfo " id="T2:U3975"><span class="var type1" id="S5T3U5445">Last</span>.TestYear2</span>(<span class="var type1" id="S94T1U5447">z</span>)</span>, <span class="var type1" id="S2T1U5448">y</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,939" id="srcline939"> 939</a></span><span class="line">                                    <span class="comment">% now we do the screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,940" id="srcline940"> 940</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U3979">isequal(<span class="var type1" id="S95T1U5453">q</span>, <span class="mxinfo " id="T1:U3981">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,941" id="srcline941"> 941</a></span><span class="line">                                        <span class="mxinfo " id="T1:U3982"><span class="mxinfo " id="T1:U3983"><span class="mxinfo " id="T2:U3984"><span class="var type1" id="S5T3U5459">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U5461">z</span>)</span> = <span class="mxinfo " id="T1:U3987">1</span></span>; <span class="comment">% for the per protocol analysis if necessary</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,942" id="srcline942"> 942</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U3988">~<span class="mxinfo " id="T28:U3989"><span class="var type1" id="S37T27U5467">flag</span>.Mock</span></span> <span class="comment">% special text would be: 'RS-RCT-Validation_Mock'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,943" id="srcline943"> 943</a></span><span class="line">                                            <span class="mxinfo " id="T1:U3991"><span class="mxinfo " id="T1:U3992"><span class="mxinfo " id="T5:U3993"><span class="var type1" id="S25T17U5473">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U5475">y</span>)</span> = <span class="mxinfo " id="T1:U3996"><span class="mxinfo " id="T1:U3997"><span class="mxinfo " id="T5:U3998"><span class="var type1" id="S25T17U5479">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U5481">y</span>)</span> + <span class="mxinfo " id="T1:U4001">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,944" id="srcline944"> 944</a></span><span class="line">                                            <span class="comment">% Number.Custom(y)     = Number.Custom(y) + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,945" id="srcline945"> 945</a></span><span class="line">                                            [<span class="var type1" id="S70T46U5486">Polyp</span>, <span class="var type1" id="S113T1U5487">PolypFlag</span>, <span class="var type1" id="S114T1U5488">AdvPolypFlag</span>, <span class="var type1" id="S115T1U5489">CancerFlag</span>, <span class="var type1" id="S23T10U5490">PaymentType</span>, <span class="var type1" id="S24T15U5491">Money</span>, <span class="var type1" id="S58T44U5492">Included</span>, <span class="var type1" id="S4T2U5493">DeathCause</span>, <span class="var type1" id="S6T2U5494">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,946" id="srcline946"> 946</a></span><span class="line">                                                = RectoSigmo(<span class="var type1" id="S94T1U5497">z</span>, <span class="var type1" id="S2T1U5498">y</span>, <span class="var type1" id="S70T46U5499">Polyp</span>, <span class="var type1" id="S71T48U5500">Ca</span>, <span class="var type1" id="S58T44U5501">Included</span>, <span class="var type1" id="S4T2U5502">DeathCause</span>, <span class="var type1" id="S6T2U5503">DeathYear</span>, <span class="var type1" id="S23T10U5504">PaymentType</span>, <span class="var type1" id="S24T15U5505">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,947" id="srcline947"> 947</a></span><span class="line">                                                <span class="var type1" id="S32T19U5506">StageVariables</span>, <span class="var type1" id="S34T23U5507">Cost</span>, <span class="var type1" id="S33T21U5508">Location</span>, <span class="var type1" id="S36T26U5509">risc</span>, <span class="var type1" id="S79T62U5510">RectoSigmoReachMatrix</span>, <span class="var type1" id="S37T27U5511">flag</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,948" id="srcline948"> 948</a></span><span class="line">                                            <span class="keyword">if</span> <span class="var type1" id="S114T1U5514">AdvPolypFlag</span>  <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,949" id="srcline949"> 949</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4027"><span class="mxinfo " id="T1:U4028"><span class="mxinfo " id="T2:U4029"><span class="var type1" id="S5T3U5519">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U5521">z</span>)</span> = <span class="var type1" id="S2T1U5522">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,950" id="srcline950"> 950</a></span><span class="line">                                            <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4033"><span class="var type1" id="S113T1U5525">PolypFlag</span> &gt; <span class="mxinfo " id="T1:U4035">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,951" id="srcline951"> 951</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4036"><span class="mxinfo " id="T1:U4037"><span class="mxinfo " id="T2:U4038"><span class="var type1" id="S5T3U5531">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U5533">z</span>)</span> = <span class="var type1" id="S2T1U5534">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,952" id="srcline952"> 952</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,953" id="srcline953"> 953</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4042">or(<span class="mxinfo " id="T28:U4043"><span class="var type1" id="S113T1U5540">PolypFlag</span> &gt; <span class="mxinfo " id="T1:U4045">1</span></span>, <span class="mxinfo " id="T28:U4046">or(<span class="var type1" id="S114T1U5544">AdvPolypFlag</span>, <span class="var type1" id="S115T1U5545">CancerFlag</span>)</span>)</span> <span class="comment">% we do follow up for a polyp &gt;0.5 cm or a cancer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,954" id="srcline954"> 954</a></span><span class="line">                                                <span class="comment">% please note that for this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,955" id="srcline955"> 955</a></span><span class="line">                                                <span class="comment">% study PolypFlag will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,956" id="srcline956"> 956</a></span><span class="line">                                                <span class="comment">% 1.5 for polyps &gt;0.5mm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,957" id="srcline957"> 957</a></span><span class="line">                                                <span class="keyword">if</span> <span class="var type1" id="S113T1U5548">PolypFlag</span>, <span class="mxinfo " id="T1:U4050"><span class="var type1" id="S67T1U5551">PosPolyp</span> = <span class="mxinfo " id="T1:U4052"><span class="var type1" id="S67T1U5553">PosPolyp</span> + <span class="mxinfo " id="T1:U4054">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,958" id="srcline958"> 958</a></span><span class="line">                                                <span class="keyword">if</span> <span class="var type1" id="S115T1U5557">CancerFlag</span>, <span class="mxinfo " id="T1:U4056"><span class="var type1" id="S68T1U5560">PosCa</span> = <span class="mxinfo " id="T1:U4058"><span class="var type1" id="S68T1U5562">PosCa</span> + <span class="mxinfo " id="T1:U4060">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,959" id="srcline959"> 959</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4061">and(<span class="var type1" id="S115T1U5568">CancerFlag</span>, <span class="var type1" id="S113T1U5569">PolypFlag</span>)</span>, <span class="mxinfo " id="T1:U4064"><span class="var type1" id="S69T1U5572">PosPolypCa</span> = <span class="mxinfo " id="T1:U4066"><span class="var type1" id="S69T1U5574">PosPolypCa</span> + <span class="mxinfo " id="T1:U4068">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,960" id="srcline960"> 960</a></span><span class="line">                                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,961" id="srcline961"> 961</a></span><span class="line">                                                <span class="comment">% StageVariables.Colo_Detection(7:10) = 1; % BM 29.5.2017</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,962" id="srcline962"> 962</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4069"><span class="mxinfo " id="T1:U4070"><span class="mxinfo " id="T5:U4071"><span class="var type1" id="S25T17U5580">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5582">y</span>)</span> = <span class="mxinfo " id="T1:U4074"><span class="mxinfo " id="T1:U4075"><span class="mxinfo " id="T5:U4076"><span class="var type1" id="S25T17U5586">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5588">y</span>)</span> + <span class="mxinfo " id="T1:U4079">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,963" id="srcline963"> 963</a></span><span class="line">                                                [<span class="var type1" id="S70T46U5593">Polyp</span>, <span class="var type1" id="S71T48U5594">Ca</span>, <span class="var type1" id="S72T50U5595">Detected</span>, <span class="var type1" id="S58T44U5596">Included</span>, <span class="var type1" id="S4T2U5597">DeathCause</span>, <span class="var type1" id="S6T2U5598">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,964" id="srcline964"> 964</a></span><span class="line">                                                    <span class="var type1" id="S27T8U5599">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5600">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5601">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5602">Last</span>, <span class="var type1" id="S14T6U5603">TumorRecord</span>, <span class="var type1" id="S23T10U5604">PaymentType</span>, <span class="var type1" id="S24T15U5605">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,965" id="srcline965"> 965</a></span><span class="line">                                                    = Colonoscopy(<span class="var type1" id="S94T1U5608">z</span>, <span class="var type1" id="S2T1U5609">y</span>, <span class="var type1" id="S95T1U5610">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U5612">Gender</span>, <span class="var type1" id="S70T46U5613">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,966" id="srcline966"> 966</a></span><span class="line">                                                    <span class="var type1" id="S71T48U5614">Ca</span>, <span class="var type1" id="S72T50U5615">Detected</span>, <span class="var type1" id="S58T44U5616">Included</span>, <span class="var type1" id="S4T2U5617">DeathCause</span>, <span class="var type1" id="S6T2U5618">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,967" id="srcline967"> 967</a></span><span class="line">                                                    <span class="var type1" id="S27T8U5619">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5620">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5621">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5622">Last</span>, <span class="var type1" id="S14T6U5623">TumorRecord</span>, <span class="var type1" id="S23T10U5624">PaymentType</span>, <span class="var type1" id="S24T15U5625">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,968" id="srcline968"> 968</a></span><span class="line">                                                    <span class="var type1" id="S32T19U5626">StageVariables</span>, <span class="var type1" id="S34T23U5627">Cost</span>, <span class="var type1" id="S33T21U5628">Location</span>, <span class="var type1" id="S36T26U5629">risc</span>, <span class="var type1" id="S81T62U5630">ColoReachMatrix</span>, <span class="var type1" id="S49T38U5631">MortalityMatrix</span>, <span class="var type1" id="S35T24U5632">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,969" id="srcline969"> 969</a></span><span class="line">                                                <span class="comment">% StageVariables.Colo_Detection = Colo_Detection_bckup;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,970" id="srcline970"> 970</a></span><span class="line">                                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,971" id="srcline971"> 971</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,972" id="srcline972"> 972</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,973" id="srcline973"> 973</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,974" id="srcline974"> 974</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,975" id="srcline975"> 975</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,976" id="srcline976"> 976</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4117"><span class="var type1" id="S37T27U5635">flag</span>.Segnan</span> <span class="comment">% Segnan</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,977" id="srcline977"> 977</a></span><span class="line">                            <span class="comment">% for this validation we use the study by</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,978" id="srcline978"> 978</a></span><span class="line">                            <span class="comment">% SEgnan et al., JNCI 2011.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,979" id="srcline979"> 979</a></span><span class="line">                            <span class="comment">% patients aged 55-64 were 1:1 randomized to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,980" id="srcline980"> 980</a></span><span class="line">                            <span class="comment">% undergo two rectosigmoidoscopy. adherence 58.35% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,981" id="srcline981"> 981</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4119">isequal(<span class="var type1" id="S2T1U5641">y</span>,<span class="mxinfo " id="T1:U4121">1</span>)</span> <span class="comment">% for the first year, for the first patient we setup this validation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,982" id="srcline982"> 982</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4122">isequal(<span class="var type1" id="S94T1U5647">z</span>, <span class="mxinfo " id="T1:U4124">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,983" id="srcline983"> 983</a></span><span class="line">                                    <span class="comment">% randomly one test year between 55 and 74</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,984" id="srcline984"> 984</a></span><span class="line">                                    <span class="mxinfo " id="T20:U4125"><span class="var type1" id="S108T20U5651">tmp</span>=<span class="mxinfo " id="T20:U4127">55:64</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,985" id="srcline985"> 985</a></span><span class="line">                                    <span class="keyword">for</span> <span class="var type1" id="S77T1U5657">f</span>=<span class="mxinfo " id="T1:U4129">1</span>:<span class="var type1" id="S57T1U5660">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,986" id="srcline986"> 986</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4131"><span class="mxinfo " id="T1:U4132"><span class="mxinfo " id="T2:U4133"><span class="var type1" id="S5T3U5665">Last</span>.Included</span>(<span class="var type1" id="S77T1U5667">f</span>)</span> = <span class="mxinfo " id="T1:U4136"><span class="var type1" id="S108T20U5669">tmp</span>(<span class="mxinfo " id="T1:U4138">round(<span class="mxinfo " id="T1:U4139"><span class="mxinfo " id="T1:U4140"><span class="mxinfo " id="T1:U4141">rand</span>*(<span class="mxinfo " id="T1:U4142"><span class="mxinfo " id="T1:U4143">length(<span class="var type1" id="S108T20U5680">tmp</span>)</span>-<span class="mxinfo " id="T1:U4145">1</span></span>)</span>+<span class="mxinfo " id="T1:U4146">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,987" id="srcline987"> 987</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U4147"><span class="mxinfo " id="T1:U4148">rand</span> &lt; <span class="mxinfo " id="T1:U4149">0.583</span></span> <span class="comment">% adherence to screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,988" id="srcline988"> 988</a></span><span class="line">                                            <span class="mxinfo " id="T1:U4150"><span class="mxinfo " id="T1:U4151"><span class="mxinfo " id="T2:U4152"><span class="var type1" id="S5T3U5693">Last</span>.TestYear</span>(<span class="var type1" id="S77T1U5695">f</span>)</span> = <span class="mxinfo " id="T1:U4155"><span class="mxinfo " id="T2:U4156"><span class="var type1" id="S5T3U5698">Last</span>.Included</span>(<span class="var type1" id="S77T1U5700">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,989" id="srcline989"> 989</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,990" id="srcline990"> 990</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,991" id="srcline991"> 991</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,992" id="srcline992"> 992</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,993" id="srcline993"> 993</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4159">isequal(<span class="mxinfo " id="T1:U4160"><span class="mxinfo " id="T2:U4161"><span class="var type1" id="S5T3U5708">Last</span>.Included</span>(<span class="var type1" id="S94T1U5710">z</span>)</span>, <span class="var type1" id="S2T1U5711">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,994" id="srcline994"> 994</a></span><span class="line">                                    <span class="comment">% we need to check inclusion and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,995" id="srcline995"> 995</a></span><span class="line">                                    <span class="comment">% exclusion criteria at the year of</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,996" id="srcline996"> 996</a></span><span class="line">                                    <span class="comment">% inclusion, first quarter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,997" id="srcline997"> 997</a></span><span class="line">                                    <span class="mxinfo " id="T28:U4165"><span class="var type1" id="S118T28U5714">StudyFlag</span> = <span class="mxinfo " id="T28:U4167">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,998" id="srcline998"> 998</a></span><span class="line">                                    <span class="mxinfo " id="T28:U4168"><span class="var type1" id="S118T28U5719">StudyFlag</span> = <span class="mxinfo " id="T28:U4170">and(<span class="var type1" id="S118T28U5722">StudyFlag</span>, <span class="mxinfo " id="T28:U4172"><span class="mxinfo " id="T1:U4173"><span class="var type1" id="S2T1U5725">y</span>-<span class="mxinfo " id="T1:U4175"><span class="mxinfo " id="T2:U4176"><span class="var type1" id="S5T3U5728">Last</span>.Colonoscopy</span>(<span class="var type1" id="S94T1U5730">z</span>)</span></span>&gt;<span class="mxinfo " id="T1:U4179">2</span></span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,999" id="srcline999"> 999</a></span><span class="line">                                    <span class="mxinfo " id="T28:U4180"><span class="var type1" id="S118T28U5734">StudyFlag</span> = <span class="mxinfo " id="T28:U4182">and(<span class="var type1" id="S118T28U5737">StudyFlag</span>, <span class="mxinfo " id="T28:U4184">isequal(<span class="mxinfo " id="T1:U4185"><span class="mxinfo " id="T2:U4186"><span class="var type1" id="S5T3U5742">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U5744">z</span>)</span>,<span class="mxinfo " id="T1:U4189">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1000" id="srcline1000">1000</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1001" id="srcline1001">1001</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U4190">~<span class="var type1" id="S118T28U5750">StudyFlag</span></span> <span class="comment">% we exclude the patient by setting the years to -1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1002" id="srcline1002">1002</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4192"><span class="mxinfo " id="T1:U4193"><span class="mxinfo " id="T2:U4194"><span class="var type1" id="S5T3U5755">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U5757">z</span>)</span>  = <span class="mxinfo " id="T1:U4197">-<span class="mxinfo " id="T1:U4198">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1003" id="srcline1003">1003</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4199"><span class="mxinfo " id="T1:U4200"><span class="mxinfo " id="T2:U4201"><span class="var type1" id="S5T3U5764">Last</span>.TestYear2</span>(<span class="var type1" id="S94T1U5766">z</span>)</span> = <span class="mxinfo " id="T1:U4204">-<span class="mxinfo " id="T1:U4205">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1004" id="srcline1004">1004</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4206"><span class="mxinfo " id="T1:U4207"><span class="mxinfo " id="T2:U4208"><span class="var type1" id="S5T3U5773">Last</span>.Included</span>(<span class="var type1" id="S94T1U5775">z</span>)</span>  = <span class="mxinfo " id="T1:U4211">-<span class="mxinfo " id="T1:U4212">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1005" id="srcline1005">1005</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1006" id="srcline1006">1006</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1007" id="srcline1007">1007</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4213">isequal(<span class="mxinfo " id="T1:U4214"><span class="mxinfo " id="T2:U4215"><span class="var type1" id="S5T3U5784">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U5786">z</span>)</span>, <span class="var type1" id="S2T1U5787">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1008" id="srcline1008">1008</a></span><span class="line">                                    <span class="comment">% now we do the screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1009" id="srcline1009">1009</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U4219">isequal(<span class="var type1" id="S95T1U5792">q</span>, <span class="mxinfo " id="T1:U4221">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1010" id="srcline1010">1010</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4222"><span class="mxinfo " id="T1:U4223"><span class="mxinfo " id="T2:U4224"><span class="var type1" id="S5T3U5798">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U5800">z</span>)</span> = <span class="mxinfo " id="T1:U4227">1</span></span>; <span class="comment">% for the per protocol analysis if necessary</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1011" id="srcline1011">1011</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U4228">~<span class="mxinfo " id="T28:U4229"><span class="var type1" id="S37T27U5806">flag</span>.Mock</span></span> <span class="comment">% special text would be: 'RS-RCT-Validation_Mock'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1012" id="srcline1012">1012</a></span><span class="line">                                            <span class="mxinfo " id="T1:U4231"><span class="mxinfo " id="T1:U4232"><span class="mxinfo " id="T5:U4233"><span class="var type1" id="S25T17U5812">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U5814">y</span>)</span> = <span class="mxinfo " id="T1:U4236"><span class="mxinfo " id="T1:U4237"><span class="mxinfo " id="T5:U4238"><span class="var type1" id="S25T17U5818">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U5820">y</span>)</span> + <span class="mxinfo " id="T1:U4241">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1013" id="srcline1013">1013</a></span><span class="line">                                            <span class="comment">% Number.Custom(y)     = Number.Custom(y) + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1014" id="srcline1014">1014</a></span><span class="line">                                            [<span class="var type1" id="S70T46U5825">Polyp</span>, <span class="var type1" id="S113T1U5826">PolypFlag</span>, <span class="var type1" id="S114T1U5827">AdvPolypFlag</span>, <span class="var type1" id="S115T1U5828">CancerFlag</span>, <span class="var type1" id="S23T10U5829">PaymentType</span>, <span class="var type1" id="S24T15U5830">Money</span>, <span class="var type1" id="S58T44U5831">Included</span>, <span class="var type1" id="S4T2U5832">DeathCause</span>, <span class="var type1" id="S6T2U5833">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1015" id="srcline1015">1015</a></span><span class="line">                                                = RectoSigmo(<span class="var type1" id="S94T1U5836">z</span>, <span class="var type1" id="S2T1U5837">y</span>, <span class="var type1" id="S70T46U5838">Polyp</span>, <span class="var type1" id="S71T48U5839">Ca</span>, <span class="var type1" id="S58T44U5840">Included</span>, <span class="var type1" id="S4T2U5841">DeathCause</span>, <span class="var type1" id="S6T2U5842">DeathYear</span>, <span class="var type1" id="S23T10U5843">PaymentType</span>, <span class="var type1" id="S24T15U5844">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1016" id="srcline1016">1016</a></span><span class="line">                                                <span class="var type1" id="S32T19U5845">StageVariables</span>, <span class="var type1" id="S34T23U5846">Cost</span>, <span class="var type1" id="S33T21U5847">Location</span>, <span class="var type1" id="S36T26U5848">risc</span>, <span class="var type1" id="S79T62U5849">RectoSigmoReachMatrix</span>, <span class="var type1" id="S37T27U5850">flag</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1017" id="srcline1017">1017</a></span><span class="line">                                            <span class="keyword">if</span> <span class="var type1" id="S114T1U5853">AdvPolypFlag</span>  <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1018" id="srcline1018">1018</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4267"><span class="mxinfo " id="T1:U4268"><span class="mxinfo " id="T2:U4269"><span class="var type1" id="S5T3U5858">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U5860">z</span>)</span> = <span class="var type1" id="S2T1U5861">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1019" id="srcline1019">1019</a></span><span class="line">                                            <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4273"><span class="var type1" id="S113T1U5864">PolypFlag</span> &gt; <span class="mxinfo " id="T1:U4275">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1020" id="srcline1020">1020</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4276"><span class="mxinfo " id="T1:U4277"><span class="mxinfo " id="T2:U4278"><span class="var type1" id="S5T3U5870">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U5872">z</span>)</span> = <span class="var type1" id="S2T1U5873">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1021" id="srcline1021">1021</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1022" id="srcline1022">1022</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4282">or(<span class="mxinfo " id="T28:U4283"><span class="var type1" id="S113T1U5879">PolypFlag</span> &gt; <span class="mxinfo " id="T1:U4285">1</span></span>, <span class="mxinfo " id="T28:U4286">or(<span class="var type1" id="S114T1U5883">AdvPolypFlag</span>, <span class="var type1" id="S115T1U5884">CancerFlag</span>)</span>)</span> <span class="comment">% we do follow up for a polyp &gt;0.5 cm or a cancer</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1023" id="srcline1023">1023</a></span><span class="line">                                                <span class="comment">% please note that for this</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1024" id="srcline1024">1024</a></span><span class="line">                                                <span class="comment">% study PolypFlag will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1025" id="srcline1025">1025</a></span><span class="line">                                                <span class="comment">% 1.5 for polyps &gt;0.5mm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1026" id="srcline1026">1026</a></span><span class="line">                                                <span class="keyword">if</span> <span class="var type1" id="S113T1U5887">PolypFlag</span>, <span class="mxinfo " id="T1:U4290"><span class="var type1" id="S67T1U5890">PosPolyp</span> = <span class="mxinfo " id="T1:U4292"><span class="var type1" id="S67T1U5892">PosPolyp</span> + <span class="mxinfo " id="T1:U4294">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1027" id="srcline1027">1027</a></span><span class="line">                                                <span class="keyword">if</span> <span class="var type1" id="S115T1U5896">CancerFlag</span>, <span class="mxinfo " id="T1:U4296"><span class="var type1" id="S68T1U5899">PosCa</span> = <span class="mxinfo " id="T1:U4298"><span class="var type1" id="S68T1U5901">PosCa</span> + <span class="mxinfo " id="T1:U4300">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1028" id="srcline1028">1028</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4301">and(<span class="var type1" id="S115T1U5907">CancerFlag</span>, <span class="var type1" id="S113T1U5908">PolypFlag</span>)</span>, <span class="mxinfo " id="T1:U4304"><span class="var type1" id="S69T1U5911">PosPolypCa</span> = <span class="mxinfo " id="T1:U4306"><span class="var type1" id="S69T1U5913">PosPolypCa</span> + <span class="mxinfo " id="T1:U4308">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1029" id="srcline1029">1029</a></span><span class="line">                                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1030" id="srcline1030">1030</a></span><span class="line">                                                <span class="comment">% StageVariables.Colo_Detection(7:10) = 1; % BM 29.5.2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1031" id="srcline1031">1031</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4309"><span class="mxinfo " id="T1:U4310"><span class="mxinfo " id="T5:U4311"><span class="var type1" id="S25T17U5919">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5921">y</span>)</span> = <span class="mxinfo " id="T1:U4314"><span class="mxinfo " id="T1:U4315"><span class="mxinfo " id="T5:U4316"><span class="var type1" id="S25T17U5925">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U5927">y</span>)</span> + <span class="mxinfo " id="T1:U4319">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1032" id="srcline1032">1032</a></span><span class="line">                                                [<span class="var type1" id="S70T46U5932">Polyp</span>, <span class="var type1" id="S71T48U5933">Ca</span>, <span class="var type1" id="S72T50U5934">Detected</span>, <span class="var type1" id="S58T44U5935">Included</span>, <span class="var type1" id="S4T2U5936">DeathCause</span>, <span class="var type1" id="S6T2U5937">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1033" id="srcline1033">1033</a></span><span class="line">                                                    <span class="var type1" id="S27T8U5938">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5939">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5940">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5941">Last</span>, <span class="var type1" id="S14T6U5942">TumorRecord</span>, <span class="var type1" id="S23T10U5943">PaymentType</span>, <span class="var type1" id="S24T15U5944">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1034" id="srcline1034">1034</a></span><span class="line">                                                    = Colonoscopy(<span class="var type1" id="S94T1U5947">z</span>, <span class="var type1" id="S2T1U5948">y</span>, <span class="var type1" id="S95T1U5949">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U5951">Gender</span>, <span class="var type1" id="S70T46U5952">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1035" id="srcline1035">1035</a></span><span class="line">                                                    <span class="var type1" id="S71T48U5953">Ca</span>, <span class="var type1" id="S72T50U5954">Detected</span>, <span class="var type1" id="S58T44U5955">Included</span>, <span class="var type1" id="S4T2U5956">DeathCause</span>, <span class="var type1" id="S6T2U5957">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1036" id="srcline1036">1036</a></span><span class="line">                                                    <span class="var type1" id="S27T8U5958">DiagnosedCancer</span>, <span class="var type1" id="S28T5U5959">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U5960">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U5961">Last</span>, <span class="var type1" id="S14T6U5962">TumorRecord</span>, <span class="var type1" id="S23T10U5963">PaymentType</span>, <span class="var type1" id="S24T15U5964">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1037" id="srcline1037">1037</a></span><span class="line">                                                    <span class="var type1" id="S32T19U5965">StageVariables</span>, <span class="var type1" id="S34T23U5966">Cost</span>, <span class="var type1" id="S33T21U5967">Location</span>, <span class="var type1" id="S36T26U5968">risc</span>, <span class="var type1" id="S81T62U5969">ColoReachMatrix</span>, <span class="var type1" id="S49T38U5970">MortalityMatrix</span>, <span class="var type1" id="S35T24U5971">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1038" id="srcline1038">1038</a></span><span class="line">                                                <span class="comment">% StageVariables.Colo_Detection = Colo_Detection_bckup;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1039" id="srcline1039">1039</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1040" id="srcline1040">1040</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1041" id="srcline1041">1041</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1042" id="srcline1042">1042</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1043" id="srcline1043">1043</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1044" id="srcline1044">1044</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4357"><span class="var type1" id="S37T27U5974">flag</span>.Holme</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1045" id="srcline1045">1045</a></span><span class="line">                        <span class="comment">% This uses the Norwegian Holme trial (JAMA 2014) for validation </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1046" id="srcline1046">1046</a></span><span class="line">                        <span class="comment">% it includes patients 50-64 years of age. 63%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1047" id="srcline1047">1047</a></span><span class="line">                        <span class="comment">% screening adherence. We model the intention to</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1048" id="srcline1048">1048</a></span><span class="line">                        <span class="comment">% screen analysis of the subgroup with</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1049" id="srcline1049">1049</a></span><span class="line">                        <span class="comment">% rectosigmoidoscopy only.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1050" id="srcline1050">1050</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4359">isequal(<span class="var type1" id="S2T1U5980">y</span>,<span class="mxinfo " id="T1:U4361">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1051" id="srcline1051">1051</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4362">isequal(<span class="var type1" id="S94T1U5986">z</span>, <span class="mxinfo " id="T1:U4364">1</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1052" id="srcline1052">1052</a></span><span class="line">                                    <span class="comment">% randomly one test year between 55 and 64</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1053" id="srcline1053">1053</a></span><span class="line">                                    <span class="mxinfo " id="T99:U4365"><span class="var type1" id="S108T99U5990">tmp</span>=<span class="mxinfo " id="T99:U4367">51:65</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1054" id="srcline1054">1054</a></span><span class="line">                                    <span class="keyword">for</span> <span class="var type1" id="S77T1U5996">f</span>=<span class="mxinfo " id="T1:U4369">1</span>:<span class="var type1" id="S57T1U5999">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1055" id="srcline1055">1055</a></span><span class="line">                                        <span class="mxinfo " id="T1:U4371"><span class="mxinfo " id="T1:U4372"><span class="mxinfo " id="T2:U4373"><span class="var type1" id="S5T3U6004">Last</span>.Included</span>(<span class="var type1" id="S77T1U6006">f</span>)</span> = <span class="mxinfo " id="T1:U4376"><span class="var type1" id="S108T99U6008">tmp</span>(<span class="mxinfo " id="T1:U4378">round(<span class="mxinfo " id="T1:U4379"><span class="mxinfo " id="T1:U4380"><span class="mxinfo " id="T1:U4381">rand</span>*(<span class="mxinfo " id="T1:U4382"><span class="mxinfo " id="T1:U4383">length(<span class="var type1" id="S108T99U6019">tmp</span>)</span>-<span class="mxinfo " id="T1:U4385">1</span></span>)</span>+<span class="mxinfo " id="T1:U4386">1</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1056" id="srcline1056">1056</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U4387"><span class="mxinfo " id="T1:U4388">rand</span> &lt; <span class="mxinfo " id="T1:U4389">0.651</span></span> <span class="comment">% adherence to screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1057" id="srcline1057">1057</a></span><span class="line">                                            <span class="mxinfo " id="T1:U4390"><span class="mxinfo " id="T1:U4391"><span class="mxinfo " id="T2:U4392"><span class="var type1" id="S5T3U6032">Last</span>.TestYear</span>(<span class="var type1" id="S77T1U6034">f</span>)</span> = <span class="mxinfo " id="T1:U4395"><span class="mxinfo " id="T2:U4396"><span class="var type1" id="S5T3U6037">Last</span>.Included</span>(<span class="var type1" id="S77T1U6039">f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1058" id="srcline1058">1058</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1059" id="srcline1059">1059</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1060" id="srcline1060">1060</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1061" id="srcline1061">1061</a></span><span class="line">                            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1062" id="srcline1062">1062</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4399">isequal(<span class="mxinfo " id="T1:U4400"><span class="mxinfo " id="T2:U4401"><span class="var type1" id="S5T3U6047">Last</span>.TestYear</span>(<span class="var type1" id="S94T1U6049">z</span>)</span>, <span class="var type1" id="S2T1U6050">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1063" id="srcline1063">1063</a></span><span class="line">                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U4405">~<span class="mxinfo " id="T28:U4406">isequal(<span class="mxinfo " id="T1:U4407"><span class="mxinfo " id="T2:U4408"><span class="var type1" id="S5T3U6058">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U6060">z</span>)</span>,<span class="mxinfo " id="T1:U4411">1</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1064" id="srcline1064">1064</a></span><span class="line">                                        <span class="comment">% we need to check inclusion and</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1065" id="srcline1065">1065</a></span><span class="line">                                        <span class="comment">% exclusion criteria - only</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1066" id="srcline1066">1066</a></span><span class="line">                                        <span class="comment">% patients with previous ca will be</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1067" id="srcline1067">1067</a></span><span class="line">                                        <span class="comment">% excluded</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1068" id="srcline1068">1068</a></span><span class="line">                                        <span class="mxinfo " id="T28:U4412"><span class="var type1" id="S118T28U6064">StudyFlag</span> = <span class="mxinfo " id="T28:U4414">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1069" id="srcline1069">1069</a></span><span class="line">                                        <span class="mxinfo " id="T28:U4415"><span class="var type1" id="S118T28U6069">StudyFlag</span> = <span class="mxinfo " id="T28:U4417">and(<span class="var type1" id="S118T28U6072">StudyFlag</span>, <span class="mxinfo " id="T28:U4419">isequal(<span class="mxinfo " id="T1:U4420"><span class="mxinfo " id="T2:U4421"><span class="var type1" id="S5T3U6077">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U6079">z</span>)</span>,<span class="mxinfo " id="T1:U4424">-100</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1070" id="srcline1070">1070</a></span><span class="line">                                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U4425">~<span class="mxinfo " id="T28:U4426">isequal(<span class="mxinfo " id="T1:U4427"><span class="mxinfo " id="T2:U4428"><span class="var type1" id="S5T3U6089">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U6091">z</span>)</span>,<span class="mxinfo " id="T1:U4431">-100</span>)</span></span>, <span class="mxinfo " id="T1:U4432"><span class="var type1" id="S65T1U6096">AusschlussCa</span> = <span class="mxinfo " id="T1:U4434"><span class="var type1" id="S65T1U6098">AusschlussCa</span> +<span class="mxinfo " id="T1:U4436">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1071" id="srcline1071">1071</a></span><span class="line">                                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,1072" id="srcline1072">1072</a></span><span class="line">                                        <span class="keyword">if</span> <span class="var type1" id="S118T28U6102">StudyFlag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1073" id="srcline1073">1073</a></span><span class="line">                                            <span class="mxinfo " id="T1:U4438"><span class="mxinfo " id="T1:U4439"><span class="mxinfo " id="T2:U4440"><span class="var type1" id="S5T3U6107">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U6109">z</span>)</span> = <span class="mxinfo " id="T1:U4443">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1074" id="srcline1074">1074</a></span><span class="line">                                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4444">~<span class="mxinfo " id="T28:U4445"><span class="var type1" id="S37T27U6115">flag</span>.Mock</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1075" id="srcline1075">1075</a></span><span class="line">                                                <span class="mxinfo " id="T1:U4447"><span class="mxinfo " id="T1:U4448"><span class="mxinfo " id="T5:U4449"><span class="var type1" id="S25T17U6121">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U6123">y</span>)</span> = <span class="mxinfo " id="T1:U4452"><span class="mxinfo " id="T1:U4453"><span class="mxinfo " id="T5:U4454"><span class="var type1" id="S25T17U6127">Number</span>.RectoSigmo</span>(<span class="var type1" id="S2T1U6129">y</span>)</span> + <span class="mxinfo " id="T1:U4457">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1076" id="srcline1076">1076</a></span><span class="line">                                                <span class="comment">% Number.Custom(y)     = Number.Custom(y) + 1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1077" id="srcline1077">1077</a></span><span class="line">                                                [<span class="var type1" id="S70T46U6134">Polyp</span>, <span class="var type1" id="S113T1U6135">PolypFlag</span>, <span class="var type1" id="S114T1U6136">AdvPolypFlag</span>, <span class="var type1" id="S115T1U6137">CancerFlag</span>, <span class="var type1" id="S23T10U6138">PaymentType</span>, <span class="var type1" id="S24T15U6139">Money</span>, <span class="var type1" id="S58T44U6140">Included</span>, <span class="var type1" id="S4T2U6141">DeathCause</span>, <span class="var type1" id="S6T2U6142">DeathYear</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1078" id="srcline1078">1078</a></span><span class="line">                                                    = RectoSigmo(<span class="var type1" id="S94T1U6145">z</span>, <span class="var type1" id="S2T1U6146">y</span>, <span class="var type1" id="S70T46U6147">Polyp</span>, <span class="var type1" id="S71T48U6148">Ca</span>, <span class="var type1" id="S58T44U6149">Included</span>, <span class="var type1" id="S4T2U6150">DeathCause</span>, <span class="var type1" id="S6T2U6151">DeathYear</span>, <span class="var type1" id="S23T10U6152">PaymentType</span>, <span class="var type1" id="S24T15U6153">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1079" id="srcline1079">1079</a></span><span class="line">                                                    <span class="var type1" id="S32T19U6154">StageVariables</span>, <span class="var type1" id="S34T23U6155">Cost</span>, <span class="var type1" id="S33T21U6156">Location</span>, <span class="var type1" id="S36T26U6157">risc</span>, <span class="var type1" id="S79T62U6158">RectoSigmoReachMatrix</span>, <span class="var type1" id="S37T27U6159">flag</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1080" id="srcline1080">1080</a></span><span class="line">                                                <span class="keyword">if</span> <span class="var type1" id="S114T1U6162">AdvPolypFlag</span>  <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1081" id="srcline1081">1081</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U4483"><span class="mxinfo " id="T1:U4484"><span class="mxinfo " id="T2:U4485"><span class="var type1" id="S5T3U6167">Last</span>.AdvPolyp</span>(<span class="var type1" id="S94T1U6169">z</span>)</span> = <span class="var type1" id="S2T1U6170">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1082" id="srcline1082">1082</a></span><span class="line">                                                <span class="keyword">elseif</span> <span class="var type1" id="S113T1U6172">PolypFlag</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1083" id="srcline1083">1083</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U4490"><span class="mxinfo " id="T1:U4491"><span class="mxinfo " id="T2:U4492"><span class="var type1" id="S5T3U6177">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U6179">z</span>)</span> = <span class="var type1" id="S2T1U6180">y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1084" id="srcline1084">1084</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1085" id="srcline1085">1085</a></span><span class="line">                                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U4496">or(<span class="var type1" id="S113T1U6185">PolypFlag</span>, <span class="mxinfo " id="T28:U4498">or(<span class="var type1" id="S114T1U6188">AdvPolypFlag</span>, <span class="var type1" id="S115T1U6189">CancerFlag</span>)</span>)</span> <span class="comment">% follow up for all lesions here </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1086" id="srcline1086">1086</a></span><span class="line">                                                    <span class="keyword">if</span> <span class="var type1" id="S113T1U6192">PolypFlag</span>, <span class="mxinfo " id="T1:U4502"><span class="var type1" id="S67T1U6195">PosPolyp</span> = <span class="mxinfo " id="T1:U4504"><span class="var type1" id="S67T1U6197">PosPolyp</span> + <span class="mxinfo " id="T1:U4506">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1087" id="srcline1087">1087</a></span><span class="line">                                                    <span class="keyword">if</span> <span class="var type1" id="S115T1U6201">CancerFlag</span>, <span class="mxinfo " id="T1:U4508"><span class="var type1" id="S68T1U6204">PosCa</span> = <span class="mxinfo " id="T1:U4510"><span class="var type1" id="S68T1U6206">PosCa</span> + <span class="mxinfo " id="T1:U4512">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1088" id="srcline1088">1088</a></span><span class="line">                                                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U4513">and(<span class="var type1" id="S115T1U6212">CancerFlag</span>, <span class="var type1" id="S113T1U6213">PolypFlag</span>)</span>, <span class="mxinfo " id="T1:U4516"><span class="var type1" id="S69T1U6216">PosPolypCa</span> = <span class="mxinfo " id="T1:U4518"><span class="var type1" id="S69T1U6218">PosPolypCa</span> + <span class="mxinfo " id="T1:U4520">1</span></span></span>; <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1089" id="srcline1089">1089</a></span><span class="line">                                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1090" id="srcline1090">1090</a></span><span class="line">                                                    <span class="comment">% StageVariables.Colo_Detection(7:10) = 1; % BM 29.5.2016</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1091" id="srcline1091">1091</a></span><span class="line">                                                    <span class="mxinfo " id="T1:U4521"><span class="mxinfo " id="T1:U4522"><span class="mxinfo " id="T5:U4523"><span class="var type1" id="S25T17U6224">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6226">y</span>)</span> = <span class="mxinfo " id="T1:U4526"><span class="mxinfo " id="T1:U4527"><span class="mxinfo " id="T5:U4528"><span class="var type1" id="S25T17U6230">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6232">y</span>)</span> + <span class="mxinfo " id="T1:U4531">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1092" id="srcline1092">1092</a></span><span class="line">                                                    [<span class="var type1" id="S70T46U6237">Polyp</span>, <span class="var type1" id="S71T48U6238">Ca</span>, <span class="var type1" id="S72T50U6239">Detected</span>, <span class="var type1" id="S58T44U6240">Included</span>, <span class="var type1" id="S4T2U6241">DeathCause</span>, <span class="var type1" id="S6T2U6242">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1093" id="srcline1093">1093</a></span><span class="line">                                                        <span class="var type1" id="S27T8U6243">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6244">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6245">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6246">Last</span>, <span class="var type1" id="S14T6U6247">TumorRecord</span>, <span class="var type1" id="S23T10U6248">PaymentType</span>, <span class="var type1" id="S24T15U6249">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1094" id="srcline1094">1094</a></span><span class="line">                                                        = Colonoscopy(<span class="var type1" id="S94T1U6252">z</span>, <span class="var type1" id="S2T1U6253">y</span>, <span class="var type1" id="S95T1U6254">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6256">Gender</span>, <span class="var type1" id="S70T46U6257">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1095" id="srcline1095">1095</a></span><span class="line">                                                        <span class="var type1" id="S71T48U6258">Ca</span>, <span class="var type1" id="S72T50U6259">Detected</span>, <span class="var type1" id="S58T44U6260">Included</span>, <span class="var type1" id="S4T2U6261">DeathCause</span>, <span class="var type1" id="S6T2U6262">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1096" id="srcline1096">1096</a></span><span class="line">                                                        <span class="var type1" id="S27T8U6263">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6264">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6265">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6266">Last</span>, <span class="var type1" id="S14T6U6267">TumorRecord</span>, <span class="var type1" id="S23T10U6268">PaymentType</span>, <span class="var type1" id="S24T15U6269">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1097" id="srcline1097">1097</a></span><span class="line">                                                        <span class="var type1" id="S32T19U6270">StageVariables</span>, <span class="var type1" id="S34T23U6271">Cost</span>, <span class="var type1" id="S33T21U6272">Location</span>, <span class="var type1" id="S36T26U6273">risc</span>, <span class="var type1" id="S81T62U6274">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6275">MortalityMatrix</span>, <span class="var type1" id="S35T24U6276">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1098" id="srcline1098">1098</a></span><span class="line">                                                    <span class="comment">% StageVariables.Colo_Detection = Colo_Detection_bckup;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1099" id="srcline1099">1099</a></span><span class="line">                                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1100" id="srcline1100">1100</a></span><span class="line">                                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1101" id="srcline1101">1101</a></span><span class="line">                                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1102" id="srcline1102">1102</a></span><span class="line">                                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1103" id="srcline1103">1103</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1104" id="srcline1104">1104</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1105" id="srcline1105">1105</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1106" id="srcline1106">1106</a></span><span class="line">                        <span class="keyword">if</span> <span class="mxinfo " id="T28:U4569"><span class="var type1" id="S37T27U6280">flag</span>.perfect</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1107" id="srcline1107">1107</a></span><span class="line">                            </span></span>
<span class="srcline"><span class="lineno"><a href="1,1108" id="srcline1108">1108</a></span><span class="line">                            <span class="comment">% we do analysis, examining a perfect screening</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1109" id="srcline1109">1109</a></span><span class="line">                            <span class="comment">% intervention once</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1110" id="srcline1110">1110</a></span><span class="line">                            <span class="mxinfo " id="T1:U4571"><span class="var type1" id="S119T1U6284">PerfectYear</span> = <span class="mxinfo " id="T1:U4573">66</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1111" id="srcline1111">1111</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4574">isequal(<span class="var type1" id="S2T1U6290">y</span>, <span class="var type1" id="S119T1U6291">PerfectYear</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1112" id="srcline1112">1112</a></span><span class="line">                                <span class="mxinfo " id="T45:U4577"><span class="mxinfo " id="T45:U4578"><span class="var type1" id="S70T46U6295">Polyp</span>.Polyps</span>           = <span class="mxinfo " id="T45:U4580">zeros(<span class="mxinfo " id="T1:U4581">25000</span>, <span class="mxinfo " id="T1:U4582">51</span>)</span></span>;   <span class="comment">% we initialize the polyps cells</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1113" id="srcline1113">1113</a></span><span class="line">                                <span class="mxinfo " id="T45:U4583"><span class="mxinfo " id="T45:U4584"><span class="var type1" id="S70T46U6304">Polyp</span>.PolypYear</span>        = <span class="mxinfo " id="T45:U4586">zeros(<span class="mxinfo " id="T1:U4587">25000</span>, <span class="mxinfo " id="T1:U4588">51</span>)</span></span>;   <span class="comment">% we initialize the field for keeping track of years</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1114" id="srcline1114">1114</a></span><span class="line">                                <span class="mxinfo " id="T45:U4589"><span class="mxinfo " id="T45:U4590"><span class="var type1" id="S70T46U6313">Polyp</span>.PolypLocation</span>    = <span class="mxinfo " id="T45:U4592">zeros(<span class="mxinfo " id="T1:U4593">25000</span>, <span class="mxinfo " id="T1:U4594">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1115" id="srcline1115">1115</a></span><span class="line">                                <span class="mxinfo " id="T45:U4595"><span class="mxinfo " id="T45:U4596"><span class="var type1" id="S70T46U6322">Polyp</span>.AdvProgression</span>   = <span class="mxinfo " id="T45:U4598">zeros(<span class="mxinfo " id="T1:U4599">25000</span>, <span class="mxinfo " id="T1:U4600">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1116" id="srcline1116">1116</a></span><span class="line">                                <span class="mxinfo " id="T45:U4601"><span class="mxinfo " id="T45:U4602"><span class="var type1" id="S70T46U6331">Polyp</span>.EarlyProgression</span> = <span class="mxinfo " id="T45:U4604">zeros(<span class="mxinfo " id="T1:U4605">25000</span>, <span class="mxinfo " id="T1:U4606">51</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1117" id="srcline1117">1117</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1118" id="srcline1118">1118</a></span><span class="line">                                <span class="mxinfo " id="T47:U4607"><span class="mxinfo " id="T47:U4608"><span class="var type1" id="S71T48U6340">Ca</span>.Cancer</span>            = <span class="mxinfo " id="T47:U4610">zeros(<span class="mxinfo " id="T1:U4611">25000</span>, <span class="mxinfo " id="T1:U4612">25</span>)</span></span>;    <span class="comment">% we initialize the cancer cells</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1119" id="srcline1119">1119</a></span><span class="line">                                <span class="mxinfo " id="T47:U4613"><span class="mxinfo " id="T47:U4614"><span class="var type1" id="S71T48U6349">Ca</span>.CancerYear</span>        = <span class="mxinfo " id="T47:U4616">zeros(<span class="mxinfo " id="T1:U4617">25000</span>, <span class="mxinfo " id="T1:U4618">25</span>)</span></span>;    <span class="comment">% we initialize the field for keeping track of years</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1120" id="srcline1120">1120</a></span><span class="line">                                <span class="mxinfo " id="T47:U4619"><span class="mxinfo " id="T47:U4620"><span class="var type1" id="S71T48U6358">Ca</span>.CancerLocation</span>    = <span class="mxinfo " id="T47:U4622">zeros(<span class="mxinfo " id="T1:U4623">25000</span>, <span class="mxinfo " id="T1:U4624">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1121" id="srcline1121">1121</a></span><span class="line">                                <span class="mxinfo " id="T47:U4625"><span class="mxinfo " id="T47:U4626"><span class="var type1" id="S71T48U6367">Ca</span>.TimeStage_I</span>        = <span class="mxinfo " id="T47:U4628">zeros(<span class="mxinfo " id="T1:U4629">25000</span>, <span class="mxinfo " id="T1:U4630">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1122" id="srcline1122">1122</a></span><span class="line">                                <span class="mxinfo " id="T47:U4631"><span class="mxinfo " id="T47:U4632"><span class="var type1" id="S71T48U6376">Ca</span>.TimeStage_II</span>       = <span class="mxinfo " id="T47:U4634">zeros(<span class="mxinfo " id="T1:U4635">25000</span>, <span class="mxinfo " id="T1:U4636">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1123" id="srcline1123">1123</a></span><span class="line">                                <span class="mxinfo " id="T47:U4637"><span class="mxinfo " id="T47:U4638"><span class="var type1" id="S71T48U6385">Ca</span>.TimeStage_III</span>      = <span class="mxinfo " id="T47:U4640">zeros(<span class="mxinfo " id="T1:U4641">25000</span>, <span class="mxinfo " id="T1:U4642">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1124" id="srcline1124">1124</a></span><span class="line">                                <span class="mxinfo " id="T47:U4643"><span class="mxinfo " id="T47:U4644"><span class="var type1" id="S71T48U6394">Ca</span>.SympTime</span>           = <span class="mxinfo " id="T47:U4646">zeros(<span class="mxinfo " id="T1:U4647">25000</span>, <span class="mxinfo " id="T1:U4648">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1125" id="srcline1125">1125</a></span><span class="line">                                <span class="mxinfo " id="T47:U4649"><span class="mxinfo " id="T47:U4650"><span class="var type1" id="S71T48U6403">Ca</span>.SympStage</span>          = <span class="mxinfo " id="T47:U4652">zeros(<span class="mxinfo " id="T1:U4653">25000</span>, <span class="mxinfo " id="T1:U4654">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1126" id="srcline1126">1126</a></span><span class="line">                                <span class="mxinfo " id="T47:U4655"><span class="mxinfo " id="T47:U4656"><span class="var type1" id="S71T48U6412">Ca</span>.DwellTime</span>          = <span class="mxinfo " id="T47:U4658">zeros(<span class="mxinfo " id="T1:U4659">25000</span>, <span class="mxinfo " id="T1:U4660">25</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1127" id="srcline1127">1127</a></span><span class="line">                                <span class="mxinfo " id="T49:U4661"><span class="mxinfo " id="T49:U4662"><span class="var type1" id="S72T50U6421">Detected</span>.Cancer</span>         = <span class="mxinfo " id="T49:U4664">zeros(<span class="mxinfo " id="T1:U4665">25000</span>, <span class="mxinfo " id="T1:U4666">50</span>)</span></span>;    <span class="comment">% this cancers are detected, patient might die</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1128" id="srcline1128">1128</a></span><span class="line">                                <span class="mxinfo " id="T49:U4667"><span class="mxinfo " id="T49:U4668"><span class="var type1" id="S72T50U6430">Detected</span>.CancerYear</span>     = <span class="mxinfo " id="T49:U4670">zeros(<span class="mxinfo " id="T1:U4671">25000</span>, <span class="mxinfo " id="T1:U4672">50</span>)</span></span>;    <span class="comment">% year this cancer had beed diagnosed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1129" id="srcline1129">1129</a></span><span class="line">                                <span class="mxinfo " id="T49:U4673"><span class="mxinfo " id="T49:U4674"><span class="var type1" id="S72T50U6439">Detected</span>.CancerLocation</span> = <span class="mxinfo " id="T49:U4676">zeros(<span class="mxinfo " id="T1:U4677">25000</span>, <span class="mxinfo " id="T1:U4678">50</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1130" id="srcline1130">1130</a></span><span class="line">                                <span class="mxinfo " id="T49:U4679"><span class="mxinfo " id="T49:U4680"><span class="var type1" id="S72T50U6448">Detected</span>.MortTime</span>       = <span class="mxinfo " id="T49:U4682">zeros(<span class="mxinfo " id="T1:U4683">25000</span>, <span class="mxinfo " id="T1:U4684">50</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1131" id="srcline1131">1131</a></span><span class="line">                                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1132" id="srcline1132">1132</a></span><span class="line">                                <span class="mxinfo " id="T7:U4685"><span class="mxinfo " id="T7:U4686"><span class="var type1" id="S14T6U6457">TumorRecord</span>.Stage</span>         = <span class="mxinfo " id="T7:U4688">zeros(<span class="mxinfo " id="T1:U4689">100</span>, <span class="mxinfo " id="T1:U4690">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1133" id="srcline1133">1133</a></span><span class="line">                                <span class="mxinfo " id="T7:U4691"><span class="mxinfo " id="T7:U4692"><span class="var type1" id="S14T6U6470">TumorRecord</span>.Location</span>      = <span class="mxinfo " id="T7:U4694">zeros(<span class="mxinfo " id="T1:U4695">100</span>, <span class="mxinfo " id="T1:U4696">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1134" id="srcline1134">1134</a></span><span class="line">                                <span class="mxinfo " id="T7:U4697"><span class="mxinfo " id="T7:U4698"><span class="var type1" id="S14T6U6483">TumorRecord</span>.Sojourn</span>       = <span class="mxinfo " id="T7:U4700">zeros(<span class="mxinfo " id="T1:U4701">100</span>, <span class="mxinfo " id="T1:U4702">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1135" id="srcline1135">1135</a></span><span class="line">                                <span class="mxinfo " id="T7:U4703"><span class="mxinfo " id="T7:U4704"><span class="var type1" id="S14T6U6496">TumorRecord</span>.DwellTime</span>     = <span class="mxinfo " id="T7:U4706">zeros(<span class="mxinfo " id="T1:U4707">100</span>, <span class="mxinfo " id="T1:U4708">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1136" id="srcline1136">1136</a></span><span class="line">                                <span class="mxinfo " id="T7:U4709"><span class="mxinfo " id="T7:U4710"><span class="var type1" id="S14T6U6509">TumorRecord</span>.Gender</span>        = <span class="mxinfo " id="T7:U4712">zeros(<span class="mxinfo " id="T1:U4713">100</span>, <span class="mxinfo " id="T1:U4714">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1137" id="srcline1137">1137</a></span><span class="line">                                <span class="mxinfo " id="T7:U4715"><span class="mxinfo " id="T7:U4716"><span class="var type1" id="S14T6U6522">TumorRecord</span>.Detection</span>     = <span class="mxinfo " id="T7:U4718">zeros(<span class="mxinfo " id="T1:U4719">100</span>, <span class="mxinfo " id="T1:U4720">round(25000/10)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1138" id="srcline1138">1138</a></span><span class="line">                                <span class="mxinfo " id="T7:U4721"><span class="mxinfo " id="T7:U4722"><span class="var type1" id="S14T6U6535">TumorRecord</span>.PatientNumber</span> = <span class="mxinfo " id="T7:U4724">zeros(<span class="mxinfo " id="T1:U4725">100</span>, <span class="mxinfo " id="T1:U4726">round(25000/10)</span>)</span></span>; <span class="comment">% RS ONLY !!!!!!</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1139" id="srcline1139">1139</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1140" id="srcline1140">1140</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1141" id="srcline1141">1141</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4727"><span class="var type1" id="S37T27U6547">flag</span>.Kolo1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1142" id="srcline1142">1142</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4729">isequal(<span class="mxinfo " id="T1:U4730"><span class="var type1" id="S41T32U6554">ScreeningTest</span>(<span class="mxinfo " id="T54:U4732">1</span>, <span class="mxinfo " id="T54:U4733">4</span>)</span>, <span class="var type1" id="S2T1U6557">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1143" id="srcline1143">1143</a></span><span class="line">                                <span class="mxinfo " id="T1:U4735"><span class="mxinfo " id="T1:U4736"><span class="mxinfo " id="T5:U4737"><span class="var type1" id="S25T17U6562">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6564">y</span>)</span> = <span class="mxinfo " id="T1:U4740"><span class="mxinfo " id="T1:U4741"><span class="mxinfo " id="T5:U4742"><span class="var type1" id="S25T17U6568">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6570">y</span>)</span> + <span class="mxinfo " id="T1:U4745">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1144" id="srcline1144">1144</a></span><span class="line">                                [<span class="var type1" id="S70T46U6575">Polyp</span>, <span class="var type1" id="S71T48U6576">Ca</span>, <span class="var type1" id="S72T50U6577">Detected</span>, <span class="var type1" id="S58T44U6578">Included</span>, <span class="var type1" id="S4T2U6579">DeathCause</span>, <span class="var type1" id="S6T2U6580">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1145" id="srcline1145">1145</a></span><span class="line">                                    <span class="var type1" id="S27T8U6581">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6582">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6583">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6584">Last</span>, <span class="var type1" id="S14T6U6585">TumorRecord</span>, <span class="var type1" id="S23T10U6586">PaymentType</span>, <span class="var type1" id="S24T15U6587">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1146" id="srcline1146">1146</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6590">z</span>, <span class="var type1" id="S2T1U6591">y</span>, <span class="var type1" id="S95T1U6592">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6594">Gender</span>, <span class="var type1" id="S70T46U6595">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1147" id="srcline1147">1147</a></span><span class="line">                                    <span class="var type1" id="S71T48U6596">Ca</span>, <span class="var type1" id="S72T50U6597">Detected</span>, <span class="var type1" id="S58T44U6598">Included</span>, <span class="var type1" id="S4T2U6599">DeathCause</span>, <span class="var type1" id="S6T2U6600">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1148" id="srcline1148">1148</a></span><span class="line">                                    <span class="var type1" id="S27T8U6601">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6602">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6603">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6604">Last</span>, <span class="var type1" id="S14T6U6605">TumorRecord</span>, <span class="var type1" id="S23T10U6606">PaymentType</span>, <span class="var type1" id="S24T15U6607">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1149" id="srcline1149">1149</a></span><span class="line">                                    <span class="var type1" id="S32T19U6608">StageVariables</span>, <span class="var type1" id="S34T23U6609">Cost</span>, <span class="var type1" id="S33T21U6610">Location</span>, <span class="var type1" id="S36T26U6611">risc</span>, <span class="var type1" id="S81T62U6612">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6613">MortalityMatrix</span>, <span class="var type1" id="S35T24U6614">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1150" id="srcline1150">1150</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1151" id="srcline1151">1151</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4783"><span class="var type1" id="S37T27U6617">flag</span>.Kolo2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1152" id="srcline1152">1152</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4785">isequal(<span class="mxinfo " id="T1:U4786"><span class="var type1" id="S41T32U6624">ScreeningTest</span>(<span class="mxinfo " id="T54:U4788">1</span>, <span class="mxinfo " id="T54:U4789">4</span>)</span>, <span class="var type1" id="S2T1U6627">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1153" id="srcline1153">1153</a></span><span class="line">                                <span class="mxinfo " id="T1:U4791"><span class="mxinfo " id="T1:U4792"><span class="mxinfo " id="T5:U4793"><span class="var type1" id="S25T17U6632">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6634">y</span>)</span> = <span class="mxinfo " id="T1:U4796"><span class="mxinfo " id="T1:U4797"><span class="mxinfo " id="T5:U4798"><span class="var type1" id="S25T17U6638">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6640">y</span>)</span> + <span class="mxinfo " id="T1:U4801">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1154" id="srcline1154">1154</a></span><span class="line">                                [<span class="var type1" id="S70T46U6645">Polyp</span>, <span class="var type1" id="S71T48U6646">Ca</span>, <span class="var type1" id="S72T50U6647">Detected</span>, <span class="var type1" id="S58T44U6648">Included</span>, <span class="var type1" id="S4T2U6649">DeathCause</span>, <span class="var type1" id="S6T2U6650">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1155" id="srcline1155">1155</a></span><span class="line">                                    <span class="var type1" id="S27T8U6651">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6652">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6653">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6654">Last</span>, <span class="var type1" id="S14T6U6655">TumorRecord</span>, <span class="var type1" id="S23T10U6656">PaymentType</span>, <span class="var type1" id="S24T15U6657">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1156" id="srcline1156">1156</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6660">z</span>, <span class="var type1" id="S2T1U6661">y</span>, <span class="var type1" id="S95T1U6662">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6664">Gender</span>, <span class="var type1" id="S70T46U6665">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1157" id="srcline1157">1157</a></span><span class="line">                                    <span class="var type1" id="S71T48U6666">Ca</span>, <span class="var type1" id="S72T50U6667">Detected</span>, <span class="var type1" id="S58T44U6668">Included</span>, <span class="var type1" id="S4T2U6669">DeathCause</span>, <span class="var type1" id="S6T2U6670">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1158" id="srcline1158">1158</a></span><span class="line">                                    <span class="var type1" id="S27T8U6671">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6672">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6673">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6674">Last</span>, <span class="var type1" id="S14T6U6675">TumorRecord</span>, <span class="var type1" id="S23T10U6676">PaymentType</span>, <span class="var type1" id="S24T15U6677">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1159" id="srcline1159">1159</a></span><span class="line">                                    <span class="var type1" id="S32T19U6678">StageVariables</span>, <span class="var type1" id="S34T23U6679">Cost</span>, <span class="var type1" id="S33T21U6680">Location</span>, <span class="var type1" id="S36T26U6681">risc</span>, <span class="var type1" id="S81T62U6682">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6683">MortalityMatrix</span>, <span class="var type1" id="S35T24U6684">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1160" id="srcline1160">1160</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1161" id="srcline1161">1161</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4839">isequal(<span class="mxinfo " id="T1:U4840"><span class="var type1" id="S41T32U6690">ScreeningTest</span>(<span class="mxinfo " id="T54:U4842">1</span>, <span class="mxinfo " id="T54:U4843">5</span>)</span>, <span class="var type1" id="S2T1U6693">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1162" id="srcline1162">1162</a></span><span class="line">                                <span class="mxinfo " id="T1:U4845"><span class="mxinfo " id="T1:U4846"><span class="mxinfo " id="T5:U4847"><span class="var type1" id="S25T17U6698">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6700">y</span>)</span> = <span class="mxinfo " id="T1:U4850"><span class="mxinfo " id="T1:U4851"><span class="mxinfo " id="T5:U4852"><span class="var type1" id="S25T17U6704">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6706">y</span>)</span> + <span class="mxinfo " id="T1:U4855">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1163" id="srcline1163">1163</a></span><span class="line">                                [<span class="var type1" id="S70T46U6711">Polyp</span>, <span class="var type1" id="S71T48U6712">Ca</span>, <span class="var type1" id="S72T50U6713">Detected</span>, <span class="var type1" id="S58T44U6714">Included</span>, <span class="var type1" id="S4T2U6715">DeathCause</span>, <span class="var type1" id="S6T2U6716">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1164" id="srcline1164">1164</a></span><span class="line">                                    <span class="var type1" id="S27T8U6717">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6718">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6719">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6720">Last</span>, <span class="var type1" id="S14T6U6721">TumorRecord</span>, <span class="var type1" id="S23T10U6722">PaymentType</span>, <span class="var type1" id="S24T15U6723">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1165" id="srcline1165">1165</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6726">z</span>, <span class="var type1" id="S2T1U6727">y</span>, <span class="var type1" id="S95T1U6728">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6730">Gender</span>, <span class="var type1" id="S70T46U6731">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1166" id="srcline1166">1166</a></span><span class="line">                                    <span class="var type1" id="S71T48U6732">Ca</span>, <span class="var type1" id="S72T50U6733">Detected</span>, <span class="var type1" id="S58T44U6734">Included</span>, <span class="var type1" id="S4T2U6735">DeathCause</span>, <span class="var type1" id="S6T2U6736">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1167" id="srcline1167">1167</a></span><span class="line">                                    <span class="var type1" id="S27T8U6737">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6738">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6739">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6740">Last</span>, <span class="var type1" id="S14T6U6741">TumorRecord</span>, <span class="var type1" id="S23T10U6742">PaymentType</span>, <span class="var type1" id="S24T15U6743">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1168" id="srcline1168">1168</a></span><span class="line">                                    <span class="var type1" id="S32T19U6744">StageVariables</span>, <span class="var type1" id="S34T23U6745">Cost</span>, <span class="var type1" id="S33T21U6746">Location</span>, <span class="var type1" id="S36T26U6747">risc</span>, <span class="var type1" id="S81T62U6748">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6749">MortalityMatrix</span>, <span class="var type1" id="S35T24U6750">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1169" id="srcline1169">1169</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1170" id="srcline1170">1170</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U4893"><span class="var type1" id="S37T27U6753">flag</span>.Kolo3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1171" id="srcline1171">1171</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4895">isequal(<span class="mxinfo " id="T1:U4896"><span class="var type1" id="S41T32U6760">ScreeningTest</span>(<span class="mxinfo " id="T54:U4898">1</span>, <span class="mxinfo " id="T54:U4899">4</span>)</span>, <span class="var type1" id="S2T1U6763">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1172" id="srcline1172">1172</a></span><span class="line">                                <span class="mxinfo " id="T1:U4901"><span class="mxinfo " id="T1:U4902"><span class="mxinfo " id="T5:U4903"><span class="var type1" id="S25T17U6768">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6770">y</span>)</span> = <span class="mxinfo " id="T1:U4906"><span class="mxinfo " id="T1:U4907"><span class="mxinfo " id="T5:U4908"><span class="var type1" id="S25T17U6774">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6776">y</span>)</span> + <span class="mxinfo " id="T1:U4911">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1173" id="srcline1173">1173</a></span><span class="line">                                [<span class="var type1" id="S70T46U6781">Polyp</span>, <span class="var type1" id="S71T48U6782">Ca</span>, <span class="var type1" id="S72T50U6783">Detected</span>, <span class="var type1" id="S58T44U6784">Included</span>, <span class="var type1" id="S4T2U6785">DeathCause</span>, <span class="var type1" id="S6T2U6786">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1174" id="srcline1174">1174</a></span><span class="line">                                    <span class="var type1" id="S27T8U6787">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6788">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6789">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6790">Last</span>, <span class="var type1" id="S14T6U6791">TumorRecord</span>, <span class="var type1" id="S23T10U6792">PaymentType</span>, <span class="var type1" id="S24T15U6793">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1175" id="srcline1175">1175</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6796">z</span>, <span class="var type1" id="S2T1U6797">y</span>, <span class="var type1" id="S95T1U6798">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6800">Gender</span>, <span class="var type1" id="S70T46U6801">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1176" id="srcline1176">1176</a></span><span class="line">                                    <span class="var type1" id="S71T48U6802">Ca</span>, <span class="var type1" id="S72T50U6803">Detected</span>, <span class="var type1" id="S58T44U6804">Included</span>, <span class="var type1" id="S4T2U6805">DeathCause</span>, <span class="var type1" id="S6T2U6806">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1177" id="srcline1177">1177</a></span><span class="line">                                    <span class="var type1" id="S27T8U6807">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6808">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6809">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6810">Last</span>, <span class="var type1" id="S14T6U6811">TumorRecord</span>, <span class="var type1" id="S23T10U6812">PaymentType</span>, <span class="var type1" id="S24T15U6813">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1178" id="srcline1178">1178</a></span><span class="line">                                    <span class="var type1" id="S32T19U6814">StageVariables</span>, <span class="var type1" id="S34T23U6815">Cost</span>, <span class="var type1" id="S33T21U6816">Location</span>, <span class="var type1" id="S36T26U6817">risc</span>, <span class="var type1" id="S81T62U6818">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6819">MortalityMatrix</span>, <span class="var type1" id="S35T24U6820">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1179" id="srcline1179">1179</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1180" id="srcline1180">1180</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U4949">isequal(<span class="mxinfo " id="T1:U4950"><span class="var type1" id="S41T32U6826">ScreeningTest</span>(<span class="mxinfo " id="T54:U4952">1</span>, <span class="mxinfo " id="T54:U4953">5</span>)</span>, <span class="var type1" id="S2T1U6829">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1181" id="srcline1181">1181</a></span><span class="line">                                <span class="mxinfo " id="T1:U4955"><span class="mxinfo " id="T1:U4956"><span class="mxinfo " id="T5:U4957"><span class="var type1" id="S25T17U6834">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6836">y</span>)</span> = <span class="mxinfo " id="T1:U4960"><span class="mxinfo " id="T1:U4961"><span class="mxinfo " id="T5:U4962"><span class="var type1" id="S25T17U6840">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6842">y</span>)</span> + <span class="mxinfo " id="T1:U4965">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1182" id="srcline1182">1182</a></span><span class="line">                                [<span class="var type1" id="S70T46U6847">Polyp</span>, <span class="var type1" id="S71T48U6848">Ca</span>, <span class="var type1" id="S72T50U6849">Detected</span>, <span class="var type1" id="S58T44U6850">Included</span>, <span class="var type1" id="S4T2U6851">DeathCause</span>, <span class="var type1" id="S6T2U6852">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1183" id="srcline1183">1183</a></span><span class="line">                                    <span class="var type1" id="S27T8U6853">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6854">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6855">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6856">Last</span>, <span class="var type1" id="S14T6U6857">TumorRecord</span>, <span class="var type1" id="S23T10U6858">PaymentType</span>, <span class="var type1" id="S24T15U6859">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1184" id="srcline1184">1184</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6862">z</span>, <span class="var type1" id="S2T1U6863">y</span>, <span class="var type1" id="S95T1U6864">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6866">Gender</span>, <span class="var type1" id="S70T46U6867">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1185" id="srcline1185">1185</a></span><span class="line">                                    <span class="var type1" id="S71T48U6868">Ca</span>, <span class="var type1" id="S72T50U6869">Detected</span>, <span class="var type1" id="S58T44U6870">Included</span>, <span class="var type1" id="S4T2U6871">DeathCause</span>, <span class="var type1" id="S6T2U6872">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1186" id="srcline1186">1186</a></span><span class="line">                                    <span class="var type1" id="S27T8U6873">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6874">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6875">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6876">Last</span>, <span class="var type1" id="S14T6U6877">TumorRecord</span>, <span class="var type1" id="S23T10U6878">PaymentType</span>, <span class="var type1" id="S24T15U6879">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1187" id="srcline1187">1187</a></span><span class="line">                                    <span class="var type1" id="S32T19U6880">StageVariables</span>, <span class="var type1" id="S34T23U6881">Cost</span>, <span class="var type1" id="S33T21U6882">Location</span>, <span class="var type1" id="S36T26U6883">risc</span>, <span class="var type1" id="S81T62U6884">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6885">MortalityMatrix</span>, <span class="var type1" id="S35T24U6886">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1188" id="srcline1188">1188</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1189" id="srcline1189">1189</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U5003">isequal(<span class="mxinfo " id="T1:U5004"><span class="var type1" id="S41T32U6892">ScreeningTest</span>(<span class="mxinfo " id="T54:U5006">1</span>, <span class="mxinfo " id="T54:U5007">6</span>)</span>, <span class="var type1" id="S2T1U6895">y</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1190" id="srcline1190">1190</a></span><span class="line">                                <span class="mxinfo " id="T1:U5009"><span class="mxinfo " id="T1:U5010"><span class="mxinfo " id="T5:U5011"><span class="var type1" id="S25T17U6900">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6902">y</span>)</span> = <span class="mxinfo " id="T1:U5014"><span class="mxinfo " id="T1:U5015"><span class="mxinfo " id="T5:U5016"><span class="var type1" id="S25T17U6906">Number</span>.Screening_Colonoscopy</span>(<span class="var type1" id="S2T1U6908">y</span>)</span> + <span class="mxinfo " id="T1:U5019">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1191" id="srcline1191">1191</a></span><span class="line">                                [<span class="var type1" id="S70T46U6913">Polyp</span>, <span class="var type1" id="S71T48U6914">Ca</span>, <span class="var type1" id="S72T50U6915">Detected</span>, <span class="var type1" id="S58T44U6916">Included</span>, <span class="var type1" id="S4T2U6917">DeathCause</span>, <span class="var type1" id="S6T2U6918">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1192" id="srcline1192">1192</a></span><span class="line">                                    <span class="var type1" id="S27T8U6919">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6920">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6921">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6922">Last</span>, <span class="var type1" id="S14T6U6923">TumorRecord</span>, <span class="var type1" id="S23T10U6924">PaymentType</span>, <span class="var type1" id="S24T15U6925">Money</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1193" id="srcline1193">1193</a></span><span class="line">                                    = Colonoscopy(<span class="var type1" id="S94T1U6928">z</span>, <span class="var type1" id="S2T1U6929">y</span>, <span class="var type1" id="S95T1U6930">q</span>, <span class="string">'Scre'</span>, <span class="var type1" id="S3T2U6932">Gender</span>, <span class="var type1" id="S70T46U6933">Polyp</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1194" id="srcline1194">1194</a></span><span class="line">                                    <span class="var type1" id="S71T48U6934">Ca</span>, <span class="var type1" id="S72T50U6935">Detected</span>, <span class="var type1" id="S58T44U6936">Included</span>, <span class="var type1" id="S4T2U6937">DeathCause</span>, <span class="var type1" id="S6T2U6938">DeathYear</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1195" id="srcline1195">1195</a></span><span class="line">                                    <span class="var type1" id="S27T8U6939">DiagnosedCancer</span>, <span class="var type1" id="S28T5U6940">AdvancedPolypsRemoved</span>, <span class="var type1" id="S26T5U6941">EarlyPolypsRemoved</span>, <span class="var type1" id="S5T3U6942">Last</span>, <span class="var type1" id="S14T6U6943">TumorRecord</span>, <span class="var type1" id="S23T10U6944">PaymentType</span>, <span class="var type1" id="S24T15U6945">Money</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1196" id="srcline1196">1196</a></span><span class="line">                                    <span class="var type1" id="S32T19U6946">StageVariables</span>, <span class="var type1" id="S34T23U6947">Cost</span>, <span class="var type1" id="S33T21U6948">Location</span>, <span class="var type1" id="S36T26U6949">risc</span>, <span class="var type1" id="S81T62U6950">ColoReachMatrix</span>, <span class="var type1" id="S49T38U6951">MortalityMatrix</span>, <span class="var type1" id="S35T24U6952">CostStage</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,1197" id="srcline1197">1197</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1198" id="srcline1198">1198</a></span><span class="line">                        <span class="keyword">elseif</span> <span class="mxinfo " id="T28:U5057"><span class="var type1" id="S37T27U6955">flag</span>.Po55</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1199" id="srcline1199">1199</a></span><span class="line">                            <span class="keyword">if</span> <span class="mxinfo " id="T28:U5059">isequal(<span class="var type1" id="S2T1U6961">y</span>, <span class="mxinfo " id="T1:U5061">56</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1200" id="srcline1200">1200</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U5062">or(<span class="mxinfo " id="T28:U5063">or(<span class="mxinfo " id="T28:U5064"><span class="mxinfo " id="T1:U5065">max(<span class="mxinfo " id="T85:U5066"><span class="mxinfo " id="T45:U5067"><span class="var type1" id="S70T46U6974">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U6976">z</span>, <span class="mxinfo " id="T86:U5070">:</span>)</span>)</span> &gt; <span class="mxinfo " id="T1:U5071">0</span></span>, <span class="mxinfo " id="T28:U5072"><span class="mxinfo " id="T1:U5073">max(<span class="mxinfo " id="T73:U5074"><span class="mxinfo " id="T47:U5075"><span class="var type1" id="S71T48U6984">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U6986">z</span>, <span class="mxinfo " id="T76:U5078">:</span>)</span>)</span> &gt; <span class="mxinfo " id="T1:U5079">0</span></span>)</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1201" id="srcline1201">1201</a></span><span class="line">                                        <span class="mxinfo " id="T28:U5080">or(<span class="mxinfo " id="T28:U5081"><span class="mxinfo " id="T1:U5082"><span class="mxinfo " id="T2:U5083"><span class="var type1" id="S5T3U6994">Last</span>.Polyp</span>(<span class="var type1" id="S94T1U6996">z</span>)</span> &gt; <span class="mxinfo " id="T1:U5086">-<span class="mxinfo " id="T1:U5087">100</span></span></span>, <span class="mxinfo " id="T28:U5088"><span class="mxinfo " id="T1:U5089"><span class="mxinfo " id="T2:U5090"><span class="var type1" id="S5T3U7002">Last</span>.Cancer</span>(<span class="var type1" id="S94T1U7004">z</span>)</span> &gt; <span class="mxinfo " id="T1:U5093">-<span class="mxinfo " id="T1:U5094">100</span></span></span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1202" id="srcline1202">1202</a></span><span class="line">                                    <span class="mxinfo " id="T1:U5095"><span class="mxinfo " id="T1:U5096"><span class="mxinfo " id="T2:U5097"><span class="var type1" id="S5T3U7011">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U7013">z</span>)</span> = <span class="mxinfo " id="T1:U5100">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1203" id="srcline1203">1203</a></span><span class="line">                                <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1204" id="srcline1204">1204</a></span><span class="line">                                    <span class="mxinfo " id="T1:U5101"><span class="mxinfo " id="T1:U5102"><span class="mxinfo " id="T2:U5103"><span class="var type1" id="S5T3U7020">Last</span>.TestDone</span>(<span class="var type1" id="S94T1U7022">z</span>)</span> = <span class="mxinfo " id="T1:U5106">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1205" id="srcline1205">1205</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1206" id="srcline1206">1206</a></span><span class="line">                                <span class="keyword">if</span> <span class="mxinfo " id="T28:U5107"><span class="var type1" id="S37T27U7027">flag</span>.treated</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1207" id="srcline1207">1207</a></span><span class="line">                                    <span class="mxinfo " id="T85:U5109"><span class="mxinfo " id="T85:U5110"><span class="mxinfo " id="T45:U5111"><span class="var type1" id="S70T46U7033">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U7035">z</span>, <span class="mxinfo " id="T86:U5114">1:51</span>)</span>           = <span class="mxinfo " id="T1:U5115">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1208" id="srcline1208">1208</a></span><span class="line">                                    <span class="mxinfo " id="T85:U5116"><span class="mxinfo " id="T85:U5117"><span class="mxinfo " id="T45:U5118"><span class="var type1" id="S70T46U7044">Polyp</span>.PolypYear</span>(<span class="var type1" id="S94T1U7046">z</span>, <span class="mxinfo " id="T86:U5121">1:51</span>)</span>        = <span class="mxinfo " id="T1:U5122">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1209" id="srcline1209">1209</a></span><span class="line">                                    <span class="mxinfo " id="T85:U5123"><span class="mxinfo " id="T85:U5124"><span class="mxinfo " id="T45:U5125"><span class="var type1" id="S70T46U7055">Polyp</span>.PolypLocation</span>(<span class="var type1" id="S94T1U7057">z</span>, <span class="mxinfo " id="T86:U5128">1:51</span>)</span>    = <span class="mxinfo " id="T1:U5129">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1210" id="srcline1210">1210</a></span><span class="line">                                    <span class="mxinfo " id="T85:U5130"><span class="mxinfo " id="T85:U5131"><span class="mxinfo " id="T45:U5132"><span class="var type1" id="S70T46U7066">Polyp</span>.AdvProgression</span>(<span class="var type1" id="S94T1U7068">z</span>, <span class="mxinfo " id="T86:U5135">1:51</span>)</span>   = <span class="mxinfo " id="T1:U5136">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1211" id="srcline1211">1211</a></span><span class="line">                                    <span class="mxinfo " id="T85:U5137"><span class="mxinfo " id="T85:U5138"><span class="mxinfo " id="T45:U5139"><span class="var type1" id="S70T46U7077">Polyp</span>.EarlyProgression</span>(<span class="var type1" id="S94T1U7079">z</span>, <span class="mxinfo " id="T86:U5142">1:51</span>)</span> = <span class="mxinfo " id="T1:U5143">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1212" id="srcline1212">1212</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1213" id="srcline1213">1213</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5144"><span class="mxinfo " id="T73:U5145"><span class="mxinfo " id="T47:U5146"><span class="var type1" id="S71T48U7088">Ca</span>.Cancer</span>        (<span class="var type1" id="S94T1U7090">z</span>, <span class="mxinfo " id="T76:U5149">1:25</span>)</span> = <span class="mxinfo " id="T1:U5150">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1214" id="srcline1214">1214</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5151"><span class="mxinfo " id="T73:U5152"><span class="mxinfo " id="T47:U5153"><span class="var type1" id="S71T48U7099">Ca</span>.CancerYear</span>    (<span class="var type1" id="S94T1U7101">z</span>, <span class="mxinfo " id="T76:U5156">1:25</span>)</span> = <span class="mxinfo " id="T1:U5157">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1215" id="srcline1215">1215</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5158"><span class="mxinfo " id="T73:U5159"><span class="mxinfo " id="T47:U5160"><span class="var type1" id="S71T48U7110">Ca</span>.CancerLocation</span>(<span class="var type1" id="S94T1U7112">z</span>, <span class="mxinfo " id="T76:U5163">1:25</span>)</span> = <span class="mxinfo " id="T1:U5164">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1216" id="srcline1216">1216</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5165"><span class="mxinfo " id="T73:U5166"><span class="mxinfo " id="T47:U5167"><span class="var type1" id="S71T48U7121">Ca</span>.TimeStage_I</span>   (<span class="var type1" id="S94T1U7123">z</span>, <span class="mxinfo " id="T76:U5170">1:25</span>)</span> = <span class="mxinfo " id="T1:U5171">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1217" id="srcline1217">1217</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5172"><span class="mxinfo " id="T73:U5173"><span class="mxinfo " id="T47:U5174"><span class="var type1" id="S71T48U7132">Ca</span>.TimeStage_II</span>  (<span class="var type1" id="S94T1U7134">z</span>, <span class="mxinfo " id="T76:U5177">1:25</span>)</span> = <span class="mxinfo " id="T1:U5178">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1218" id="srcline1218">1218</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5179"><span class="mxinfo " id="T73:U5180"><span class="mxinfo " id="T47:U5181"><span class="var type1" id="S71T48U7143">Ca</span>.TimeStage_III</span> (<span class="var type1" id="S94T1U7145">z</span>, <span class="mxinfo " id="T76:U5184">1:25</span>)</span> = <span class="mxinfo " id="T1:U5185">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1219" id="srcline1219">1219</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5186"><span class="mxinfo " id="T73:U5187"><span class="mxinfo " id="T47:U5188"><span class="var type1" id="S71T48U7154">Ca</span>.SympTime</span>      (<span class="var type1" id="S94T1U7156">z</span>, <span class="mxinfo " id="T76:U5191">1:25</span>)</span> = <span class="mxinfo " id="T1:U5192">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1220" id="srcline1220">1220</a></span><span class="line">                                    <span class="mxinfo " id="T73:U5193"><span class="mxinfo " id="T73:U5194"><span class="mxinfo " id="T47:U5195"><span class="var type1" id="S71T48U7165">Ca</span>.SympStage</span>     (<span class="var type1" id="S94T1U7167">z</span>, <span class="mxinfo " id="T76:U5198">1:25</span>)</span> = <span class="mxinfo " id="T1:U5199">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1221" id="srcline1221">1221</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1222" id="srcline1222">1222</a></span><span class="line">                                    <span class="mxinfo " id="T81:U5200"><span class="mxinfo " id="T81:U5201"><span class="mxinfo " id="T49:U5202"><span class="var type1" id="S72T50U7176">Detected</span>.Cancer</span>         (<span class="var type1" id="S94T1U7178">z</span>, <span class="mxinfo " id="T82:U5205">1:50</span>)</span> = <span class="mxinfo " id="T1:U5206">0</span></span>; <span class="comment">% this cancers are detected, patient might die</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1223" id="srcline1223">1223</a></span><span class="line">                                    <span class="mxinfo " id="T81:U5207"><span class="mxinfo " id="T81:U5208"><span class="mxinfo " id="T49:U5209"><span class="var type1" id="S72T50U7187">Detected</span>.CancerYear</span>     (<span class="var type1" id="S94T1U7189">z</span>, <span class="mxinfo " id="T82:U5212">1:50</span>)</span> = <span class="mxinfo " id="T1:U5213">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1224" id="srcline1224">1224</a></span><span class="line">                                    <span class="mxinfo " id="T81:U5214"><span class="mxinfo " id="T81:U5215"><span class="mxinfo " id="T49:U5216"><span class="var type1" id="S72T50U7198">Detected</span>.CancerLocation</span> (<span class="var type1" id="S94T1U7200">z</span>, <span class="mxinfo " id="T82:U5219">1:50</span>)</span> = <span class="mxinfo " id="T1:U5220">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1225" id="srcline1225">1225</a></span><span class="line">                                    <span class="mxinfo " id="T81:U5221"><span class="mxinfo " id="T81:U5222"><span class="mxinfo " id="T49:U5223"><span class="var type1" id="S72T50U7209">Detected</span>.MortTime</span>       (<span class="var type1" id="S94T1U7211">z</span>, <span class="mxinfo " id="T82:U5226">1:50</span>)</span> = <span class="mxinfo " id="T1:U5227">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1226" id="srcline1226">1226</a></span><span class="line">                                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1227" id="srcline1227">1227</a></span><span class="line">                                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1228" id="srcline1228">1228</a></span><span class="line">                            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1229" id="srcline1229">1229</a></span><span class="line">                            <span class="comment">% elseif (isequal(SpecialText(1:16), 'Po+-55nontreated'))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1230" id="srcline1230">1230</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1231" id="srcline1231">1231</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1232" id="srcline1232">1232</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1233" id="srcline1233">1233</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1234" id="srcline1234">1234</a></span><span class="line">                    <span class="comment">%    summarizing polyps             %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1235" id="srcline1235">1235</a></span><span class="line">                    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1236" id="srcline1236">1236</a></span><span class="line">                    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1237" id="srcline1237">1237</a></span><span class="line">                    <span class="comment">% before a polyp can be detected and removed for screening we</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1238" id="srcline1238">1238</a></span><span class="line">                    <span class="comment">% summarize the prevalence of all polyps and cancers</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1239" id="srcline1239">1239</a></span><span class="line">                    <span class="comment">%try</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1240" id="srcline1240">1240</a></span><span class="line">                    <span class="keyword">if</span> <span class="mxinfo " id="T28:U5228">~<span class="mxinfo " id="T28:U5229">isempty(<span class="mxinfo " id="T83:U5230">find(<span class="mxinfo " id="T85:U5231"><span class="mxinfo " id="T45:U5232"><span class="var type1" id="S70T46U7225">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U7227">z</span>, <span class="mxinfo " id="T86:U5235">:</span>)</span>, 1)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1241" id="srcline1241">1241</a></span><span class="line">                        <span class="mxinfo " id="T1:U5236"><span class="mxinfo " id="T1:U5237"><span class="var type1" id="S19T8U7233">MaxPolyps</span>(<span class="var type1" id="S2T1U7234">y</span>, <span class="var type1" id="S94T1U7235">z</span>)</span>      = <span class="mxinfo " id="T1:U5241">max(<span class="mxinfo " id="T85:U5242"><span class="mxinfo " id="T45:U5243"><span class="var type1" id="S70T46U7240">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U7242">z</span>, <span class="mxinfo " id="T86:U5246">:</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1242" id="srcline1242">1242</a></span><span class="line">                        <span class="mxinfo " id="T1:U5247"><span class="mxinfo " id="T1:U5248"><span class="var type1" id="S18T8U7247">NumPolyps</span>(<span class="var type1" id="S2T1U7248">y</span>, <span class="var type1" id="S94T1U7249">z</span>)</span>      = <span class="mxinfo " id="T96:U5252">length(<span class="mxinfo " id="T96:U5253">find(<span class="mxinfo " id="T85:U5254"><span class="mxinfo " id="T45:U5255"><span class="var type1" id="S70T46U7256">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U7258">z</span>, <span class="mxinfo " id="T86:U5258">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1243" id="srcline1243">1243</a></span><span class="line">                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,1244" id="srcline1244">1244</a></span><span class="line">                        <span class="comment">%                     if ~isempty(find(Polyp.PolypLocation(z, :)&lt;4, 1, 'first'))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1245" id="srcline1245">1245</a></span><span class="line">                        <span class="comment">%                         MaxPolypsRight(y,z)  = max(Polyp.Polyps(z, (Polyp.PolypLocation(z, :)&lt;4)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1246" id="srcline1246">1246</a></span><span class="line">                        <span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1247" id="srcline1247">1247</a></span><span class="line">                        <span class="comment">%                     if ~isempty(find(and(Polyp.PolypLocation(z, :)&gt;3, Polyp.PolypLocation(z,:)&lt;13), 1, 'first'))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1248" id="srcline1248">1248</a></span><span class="line">                        <span class="comment">%                         MaxPolypsRest(y,z)   = max(Polyp.Polyps(z, and(Polyp.PolypLocation(z, :)&gt;3, Polyp.PolypLocation(z,:)&lt;13)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1249" id="srcline1249">1249</a></span><span class="line">                        <span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1250" id="srcline1250">1250</a></span><span class="line">                        <span class="comment">%                     if ~isempty(find(Polyp.PolypLocation(z, :)==13, 1, 'first'))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1251" id="srcline1251">1251</a></span><span class="line">                        <span class="comment">%                         MaxPolypsRectum(y,z) = max(Polyp.Polyps(z, (Polyp.PolypLocation(z, :)==13)));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1252" id="srcline1252">1252</a></span><span class="line">                        <span class="comment">%                     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1253" id="srcline1253">1253</a></span><span class="line">                        <span class="keyword">for</span> <span class="var type1" id="S77T1U7262">f</span>=<span class="mxinfo " id="T1:U5260">1</span>:6</span></span>
<span class="srcline"><span class="lineno"><a href="1,1254" id="srcline1254">1254</a></span><span class="line">                            <span class="mxinfo " id="T1:U5261"><span class="mxinfo " id="T1:U5262"><span class="var type1" id="S20T9U7269">AllPolyps</span>(<span class="var type1" id="S77T1U7270">f</span>, <span class="var type1" id="S2T1U7271">y</span>)</span> = <span class="mxinfo " id="T1:U5266"><span class="mxinfo " id="T1:U5267"><span class="var type1" id="S20T9U7274">AllPolyps</span>(<span class="var type1" id="S77T1U7275">f</span>, <span class="var type1" id="S2T1U7276">y</span>)</span> + <span class="mxinfo " id="T1:U5271">sum(<span class="mxinfo " id="T96:U5272">length(<span class="mxinfo " id="T96:U5273">find(<span class="mxinfo " id="T100:U5274"><span class="mxinfo " id="T85:U5275"><span class="mxinfo " id="T45:U5276"><span class="var type1" id="S70T46U7286">Polyp</span>.Polyps</span>(<span class="var type1" id="S94T1U7288">z</span>, <span class="mxinfo " id="T86:U5279">:</span>)</span>==<span class="var type1" id="S77T1U7290">f</span></span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1255" id="srcline1255">1255</a></span><span class="line">                        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1256" id="srcline1256">1256</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1257" id="srcline1257">1257</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1258" id="srcline1258">1258</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1259" id="srcline1259">1259</a></span><span class="line"><span class="comment">%                 catch Exception</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1260" id="srcline1260">1260</a></span><span class="line"><span class="comment">%                     rethrow(Exception)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1261" id="srcline1261">1261</a></span><span class="line"><span class="comment">%                 end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1262" id="srcline1262">1262</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,1263" id="srcline1263">1263</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1264" id="srcline1264">1264</a></span><span class="line">                <span class="comment">%    summarizing cancer             %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1265" id="srcline1265">1265</a></span><span class="line">                <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1266" id="srcline1266">1266</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1267" id="srcline1267">1267</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T28:U5281">~<span class="mxinfo " id="T28:U5282">isempty(<span class="mxinfo " id="T83:U5283">find(<span class="mxinfo " id="T73:U5284"><span class="mxinfo " id="T47:U5285"><span class="var type1" id="S71T48U7300">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U7302">z</span>, <span class="mxinfo " id="T76:U5288">:</span>)</span>, 1)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1268" id="srcline1268">1268</a></span><span class="line">            <span class="mxinfo " id="T1:U5289"><span class="mxinfo " id="T1:U5290"><span class="var type1" id="S22T8U7308">MaxCancer</span>(<span class="var type1" id="S2T1U7309">y</span>, <span class="var type1" id="S94T1U7310">z</span>)</span> = <span class="mxinfo " id="T1:U5294">max(<span class="mxinfo " id="T73:U5295"><span class="mxinfo " id="T47:U5296"><span class="var type1" id="S71T48U7315">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U7317">z</span>, <span class="mxinfo " id="T76:U5299">:</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1269" id="srcline1269">1269</a></span><span class="line">            <span class="mxinfo " id="T1:U5300"><span class="mxinfo " id="T1:U5301"><span class="var type1" id="S21T8U7322">NumCancer</span>(<span class="var type1" id="S2T1U7323">y</span>, <span class="var type1" id="S94T1U7324">z</span>)</span> = <span class="mxinfo " id="T87:U5305">length(<span class="mxinfo " id="T87:U5306">find(<span class="mxinfo " id="T73:U5307"><span class="mxinfo " id="T47:U5308"><span class="var type1" id="S71T48U7331">Ca</span>.Cancer</span>(<span class="var type1" id="S94T1U7333">z</span>, <span class="mxinfo " id="T76:U5311">:</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1270" id="srcline1270">1270</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1271" id="srcline1271">1271</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1272" id="srcline1272">1272</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,1273" id="srcline1273">1273</a></span><span class="line">    <span class="comment">% we summarize the whole cohort</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1274" id="srcline1274">1274</a></span><span class="line">    <span class="mxinfo " id="T44:U5312"><span class="mxinfo " id="T44:U5313"><span class="var type1" id="S29T18U7338">YearIncluded</span>(<span class="var type1" id="S2T1U7339">y</span>, <span class="mxinfo " id="T101:U5316">:</span>)</span> = <span class="var type1" id="S58T44U7341">Included</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1275" id="srcline1275">1275</a></span><span class="line">    <span class="mxinfo " id="T44:U5318"><span class="mxinfo " id="T44:U5319"><span class="var type1" id="S30T18U7345">YearAlive</span>(<span class="var type1" id="S2T1U7346">y</span>, <span class="mxinfo " id="T101:U5322">:</span>)</span>    = <span class="var type1" id="S60T44U7348">Alive</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1276" id="srcline1276">1276</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1277" id="srcline1277">1277</a></span><span class="line">    <span class="comment">%display(sprintf('calculating results for year: %d', y))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1278" id="srcline1278">1278</a></span><span class="line">    <span class="extrinsicFcn" id="F555N7:B7351">display</span>(<span class="extrinsicFcn" id="F554N9:B7353">sprintf</span>(<span class="string">'Calculating year %d'</span>, <span class="var type1" id="S2T1U7355">y</span>))</span></span>
<span class="srcline"><span class="lineno"><a href="1,1279" id="srcline1279">1279</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1280" id="srcline1280">1280</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1281" id="srcline1281">1281</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1282" id="srcline1282">1282</a></span><span class="line"><span class="comment">% Death  = zeros(1,4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1283" id="srcline1283">1283</a></span><span class="line"><span class="comment">% AliveX = zeros(1,4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1284" id="srcline1284">1284</a></span><span class="line"><span class="comment">% for f=1:n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1285" id="srcline1285">1285</a></span><span class="line"><span class="comment">%     if isequal(length(find(Detected.Cancer(f,:))), 1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1286" id="srcline1286">1286</a></span><span class="line"><span class="comment">%         Stage = Detected.Cancer(f, 1)-6;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1287" id="srcline1287">1287</a></span><span class="line"><span class="comment">%         DiagnoseTime = Detected.CancerYear(f, 1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1288" id="srcline1288">1288</a></span><span class="line"><span class="comment">%         if DeathYear(f) - DiagnoseTime &lt;= 5</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1289" id="srcline1289">1289</a></span><span class="line"><span class="comment">%             if DeathCause(f) == 2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1290" id="srcline1290">1290</a></span><span class="line"><span class="comment">%                 Death(Stage) = Death(Stage)+1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1291" id="srcline1291">1291</a></span><span class="line"><span class="comment">%             end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1292" id="srcline1292">1292</a></span><span class="line"><span class="comment">%         else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1293" id="srcline1293">1293</a></span><span class="line"><span class="comment">%             AliveX(Stage) = AliveX(Stage)+1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1294" id="srcline1294">1294</a></span><span class="line"><span class="comment">%         end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1295" id="srcline1295">1295</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1296" id="srcline1296">1296</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1297" id="srcline1297">1297</a></span><span class="line"><span class="comment">% RelMort = zeros(1,4);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1298" id="srcline1298">1298</a></span><span class="line"><span class="comment">% RelMort = Death./(AliveX+Death)*100</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1299" id="srcline1299">1299</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S77T1U7358">f</span>=<span class="mxinfo " id="T1:U5326">1</span>:25000</span></span>
<span class="srcline"><span class="lineno"><a href="1,1300" id="srcline1300">1300</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T28:U5327"><span class="var type1" id="S60T44U7365">Alive</span>(<span class="var type1" id="S77T1U7366">f</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1301" id="srcline1301">1301</a></span><span class="line">        <span class="mxinfo " id="T1:U5330"><span class="mxinfo " id="T1:U5331"><span class="var type1" id="S7T2U7370">NaturalDeathYear</span>(<span class="var type1" id="S77T1U7371">f</span>)</span> = <span class="mxinfo " id="T1:U5334">100</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,1302" id="srcline1302">1302</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1303" id="srcline1303">1303</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1304" id="srcline1304">1304</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1305" id="srcline1305">1305</a></span><span class="line"><span class="mxinfo " id="T16:U5335"><span class="mxinfo " id="T16:U5336"><span class="var type1" id="S24T15U7376">Money</span>.AllCost</span>       = <span class="mxinfo " id="T16:U5338"><span class="mxinfo " id="T16:U5339"><span class="mxinfo " id="T16:U5340"><span class="mxinfo " id="T16:U5341"><span class="var type1" id="S24T15U7382">Money</span>.Treatment</span> + <span class="mxinfo " id="T16:U5343"><span class="var type1" id="S24T15U7385">Money</span>.Screening</span></span> + <span class="mxinfo " id="T16:U5345"><span class="var type1" id="S24T15U7388">Money</span>.FollowUp</span></span> + <span class="mxinfo " id="T16:U5347"><span class="var type1" id="S24T15U7391">Money</span>.Other</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,1306" id="srcline1306">1306</a></span><span class="line"><span class="mxinfo " id="T16:U5349"><span class="mxinfo " id="T16:U5350"><span class="var type1" id="S24T15U7396">Money</span>.AllCostFuture</span> = <span class="mxinfo " id="T16:U5352"><span class="mxinfo " id="T16:U5353"><span class="mxinfo " id="T16:U5354"><span class="mxinfo " id="T16:U5355"><span class="var type1" id="S24T15U7402">Money</span>.FutureTreatment</span> + <span class="mxinfo " id="T16:U5357"><span class="var type1" id="S24T15U7405">Money</span>.Screening</span></span> + <span class="mxinfo " id="T16:U5359"><span class="var type1" id="S24T15U7408">Money</span>.FollowUp</span></span> + <span class="mxinfo " id="T16:U5361"><span class="var type1" id="S24T15U7411">Money</span>.Other</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,1307" id="srcline1307">1307</a></span><span class="line"><span class="comment">% display(sprintf('In RS-Study %d patients excluded due to Ca, %d due to Kolo, %d due to past polyps',<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1308" id="srcline1308">1308</a></span><span class="line"><span class="comment">%     AusschlussCa, AusschlussKolo, AusschlussPolyp)) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1309" id="srcline1309">1309</a></span><span class="line"><span class="comment">% display(sprintf('In RS-examinations %d times polyps, %d times cancer and %d times polyps and cancer found',<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1310" id="srcline1310">1310</a></span><span class="line"><span class="comment">%     PosCa, PosPolyp, PosPolypCa))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1311" id="srcline1311">1311</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,1312" id="srcline1312">1312</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1313" id="srcline1313">1313</a></span><span class="line"><span class="comment">%%%         COLONOSCOPY                               %%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1314" id="srcline1314">1314</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1315" id="srcline1315">1315</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,1316" id="srcline1316">1316</a></span><span class="line"></span></span>
</pre>
